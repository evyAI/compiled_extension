(()=>{var e={2935:function(e,t,n){var r;e=n.nmd(e),function(){var i,s="Expected a function",o="__lodash_hash_undefined__",a="__lodash_placeholder__",c=16,u=32,l=64,h=128,d=256,f=1/0,p=9007199254740991,m=NaN,g=4294967295,y=[["ary",h],["bind",1],["bindKey",2],["curry",8],["curryRight",c],["flip",512],["partial",u],["partialRight",l],["rearg",d]],v="[object Arguments]",_="[object Array]",w="[object Boolean]",b="[object Date]",E="[object Error]",I="[object Function]",S="[object GeneratorFunction]",T="[object Map]",k="[object Number]",A="[object Object]",x="[object Promise]",C="[object RegExp]",D="[object Set]",N="[object String]",O="[object Symbol]",R="[object WeakMap]",M="[object ArrayBuffer]",P="[object DataView]",L="[object Float32Array]",U="[object Float64Array]",F="[object Int8Array]",B="[object Int16Array]",V="[object Int32Array]",j="[object Uint8Array]",$="[object Uint8ClampedArray]",G="[object Uint16Array]",q="[object Uint32Array]",z=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,K=/(__e\(.*?\)|\b__t\)) \+\n'';/g,W=/&(?:amp|lt|gt|quot|#39);/g,Q=/[&<>"']/g,Y=RegExp(W.source),J=RegExp(Q.source),X=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,ee=/<%=([\s\S]+?)%>/g,te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/,re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ie=/[\\^$.*+?()[\]{}|]/g,se=RegExp(ie.source),oe=/^\s+/,ae=/\s/,ce=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ue=/\{\n\/\* \[wrapped with (.+)\] \*/,le=/,? & /,he=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,de=/[()=,{}\[\]\/\s]/,fe=/\\(\\)?/g,pe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,me=/\w*$/,ge=/^[-+]0x[0-9a-f]+$/i,ye=/^0b[01]+$/i,ve=/^\[object .+?Constructor\]$/,_e=/^0o[0-7]+$/i,we=/^(?:0|[1-9]\d*)$/,be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ee=/($^)/,Ie=/['\n\r\u2028\u2029\\]/g,Se="\\ud800-\\udfff",Te="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ke="\\u2700-\\u27bf",Ae="a-z\\xdf-\\xf6\\xf8-\\xff",xe="A-Z\\xc0-\\xd6\\xd8-\\xde",Ce="\\ufe0e\\ufe0f",De="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ne="['’]",Oe="["+Se+"]",Re="["+De+"]",Me="["+Te+"]",Pe="\\d+",Le="["+ke+"]",Ue="["+Ae+"]",Fe="[^"+Se+De+Pe+ke+Ae+xe+"]",Be="\\ud83c[\\udffb-\\udfff]",Ve="[^"+Se+"]",je="(?:\\ud83c[\\udde6-\\uddff]){2}",$e="[\\ud800-\\udbff][\\udc00-\\udfff]",Ge="["+xe+"]",qe="\\u200d",ze="(?:"+Ue+"|"+Fe+")",He="(?:"+Ge+"|"+Fe+")",Ke="(?:['’](?:d|ll|m|re|s|t|ve))?",We="(?:['’](?:D|LL|M|RE|S|T|VE))?",Qe="(?:"+Me+"|"+Be+")"+"?",Ye="["+Ce+"]?",Je=Ye+Qe+("(?:"+qe+"(?:"+[Ve,je,$e].join("|")+")"+Ye+Qe+")*"),Xe="(?:"+[Le,je,$e].join("|")+")"+Je,Ze="(?:"+[Ve+Me+"?",Me,je,$e,Oe].join("|")+")",et=RegExp(Ne,"g"),tt=RegExp(Me,"g"),nt=RegExp(Be+"(?="+Be+")|"+Ze+Je,"g"),rt=RegExp([Ge+"?"+Ue+"+"+Ke+"(?="+[Re,Ge,"$"].join("|")+")",He+"+"+We+"(?="+[Re,Ge+ze,"$"].join("|")+")",Ge+"?"+ze+"+"+Ke,Ge+"+"+We,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pe,Xe].join("|"),"g"),it=RegExp("["+qe+Se+Te+Ce+"]"),st=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ot=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],at=-1,ct={};ct[L]=ct[U]=ct[F]=ct[B]=ct[V]=ct[j]=ct[$]=ct[G]=ct[q]=!0,ct[v]=ct[_]=ct[M]=ct[w]=ct[P]=ct[b]=ct[E]=ct[I]=ct[T]=ct[k]=ct[A]=ct[C]=ct[D]=ct[N]=ct[R]=!1;var ut={};ut[v]=ut[_]=ut[M]=ut[P]=ut[w]=ut[b]=ut[L]=ut[U]=ut[F]=ut[B]=ut[V]=ut[T]=ut[k]=ut[A]=ut[C]=ut[D]=ut[N]=ut[O]=ut[j]=ut[$]=ut[G]=ut[q]=!0,ut[E]=ut[I]=ut[R]=!1;var lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ht=parseFloat,dt=parseInt,ft="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,pt="object"==typeof self&&self&&self.Object===Object&&self,mt=ft||pt||Function("return this")(),gt=t&&!t.nodeType&&t,yt=gt&&e&&!e.nodeType&&e,vt=yt&&yt.exports===gt,_t=vt&&ft.process,wt=function(){try{var e=yt&&yt.require&&yt.require("util").types;return e||_t&&_t.binding&&_t.binding("util")}catch(e){}}(),bt=wt&&wt.isArrayBuffer,Et=wt&&wt.isDate,It=wt&&wt.isMap,St=wt&&wt.isRegExp,Tt=wt&&wt.isSet,kt=wt&&wt.isTypedArray;function At(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function xt(e,t,n,r){for(var i=-1,s=null==e?0:e.length;++i<s;){var o=e[i];t(r,o,n(o),e)}return r}function Ct(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Dt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Nt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Ot(e,t){for(var n=-1,r=null==e?0:e.length,i=0,s=[];++n<r;){var o=e[n];t(o,n,e)&&(s[i++]=o)}return s}function Rt(e,t){return!!(null==e?0:e.length)&&Gt(e,t,0)>-1}function Mt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Pt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Lt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Ut(e,t,n,r){var i=-1,s=null==e?0:e.length;for(r&&s&&(n=e[++i]);++i<s;)n=t(n,e[i],i,e);return n}function Ft(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Bt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Vt=Kt("length");function jt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function $t(e,t,n,r){for(var i=e.length,s=n+(r?1:-1);r?s--:++s<i;)if(t(e[s],s,e))return s;return-1}function Gt(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):$t(e,zt,n)}function qt(e,t,n,r){for(var i=n-1,s=e.length;++i<s;)if(r(e[i],t))return i;return-1}function zt(e){return e!=e}function Ht(e,t){var n=null==e?0:e.length;return n?Yt(e,t)/n:m}function Kt(e){return function(t){return null==t?i:t[e]}}function Wt(e){return function(t){return null==e?i:e[t]}}function Qt(e,t,n,r,i){return i(e,(function(e,i,s){n=r?(r=!1,e):t(n,e,i,s)})),n}function Yt(e,t){for(var n,r=-1,s=e.length;++r<s;){var o=t(e[r]);o!==i&&(n=n===i?o:n+o)}return n}function Jt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Xt(e){return e?e.slice(0,gn(e)+1).replace(oe,""):e}function Zt(e){return function(t){return e(t)}}function en(e,t){return Pt(t,(function(t){return e[t]}))}function tn(e,t){return e.has(t)}function nn(e,t){for(var n=-1,r=e.length;++n<r&&Gt(t,e[n],0)>-1;);return n}function rn(e,t){for(var n=e.length;n--&&Gt(t,e[n],0)>-1;);return n}var sn=Wt({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),on=Wt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function an(e){return"\\"+lt[e]}function cn(e){return it.test(e)}function un(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function ln(e,t){return function(n){return e(t(n))}}function hn(e,t){for(var n=-1,r=e.length,i=0,s=[];++n<r;){var o=e[n];o!==t&&o!==a||(e[n]=a,s[i++]=n)}return s}function dn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function fn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function pn(e){return cn(e)?function(e){var t=nt.lastIndex=0;for(;nt.test(e);)++t;return t}(e):Vt(e)}function mn(e){return cn(e)?function(e){return e.match(nt)||[]}(e):function(e){return e.split("")}(e)}function gn(e){for(var t=e.length;t--&&ae.test(e.charAt(t)););return t}var yn=Wt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var vn=function e(t){var n,r=(t=null==t?mt:vn.defaults(mt.Object(),t,vn.pick(mt,ot))).Array,ae=t.Date,Se=t.Error,Te=t.Function,ke=t.Math,Ae=t.Object,xe=t.RegExp,Ce=t.String,De=t.TypeError,Ne=r.prototype,Oe=Te.prototype,Re=Ae.prototype,Me=t["__core-js_shared__"],Pe=Oe.toString,Le=Re.hasOwnProperty,Ue=0,Fe=(n=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Be=Re.toString,Ve=Pe.call(Ae),je=mt._,$e=xe("^"+Pe.call(Le).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ge=vt?t.Buffer:i,qe=t.Symbol,ze=t.Uint8Array,He=Ge?Ge.allocUnsafe:i,Ke=ln(Ae.getPrototypeOf,Ae),We=Ae.create,Qe=Re.propertyIsEnumerable,Ye=Ne.splice,Je=qe?qe.isConcatSpreadable:i,Xe=qe?qe.iterator:i,Ze=qe?qe.toStringTag:i,nt=function(){try{var e=ds(Ae,"defineProperty");return e({},"",{}),e}catch(e){}}(),it=t.clearTimeout!==mt.clearTimeout&&t.clearTimeout,lt=ae&&ae.now!==mt.Date.now&&ae.now,ft=t.setTimeout!==mt.setTimeout&&t.setTimeout,pt=ke.ceil,gt=ke.floor,yt=Ae.getOwnPropertySymbols,_t=Ge?Ge.isBuffer:i,wt=t.isFinite,Vt=Ne.join,Wt=ln(Ae.keys,Ae),_n=ke.max,wn=ke.min,bn=ae.now,En=t.parseInt,In=ke.random,Sn=Ne.reverse,Tn=ds(t,"DataView"),kn=ds(t,"Map"),An=ds(t,"Promise"),xn=ds(t,"Set"),Cn=ds(t,"WeakMap"),Dn=ds(Ae,"create"),Nn=Cn&&new Cn,On={},Rn=Fs(Tn),Mn=Fs(kn),Pn=Fs(An),Ln=Fs(xn),Un=Fs(Cn),Fn=qe?qe.prototype:i,Bn=Fn?Fn.valueOf:i,Vn=Fn?Fn.toString:i;function jn(e){if(na(e)&&!zo(e)&&!(e instanceof zn)){if(e instanceof qn)return e;if(Le.call(e,"__wrapped__"))return Bs(e)}return new qn(e)}var $n=function(){function e(){}return function(t){if(!ta(t))return{};if(We)return We(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function Gn(){}function qn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function zn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=g,this.__views__=[]}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Qn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Wn;++t<n;)this.add(e[t])}function Yn(e){var t=this.__data__=new Kn(e);this.size=t.size}function Jn(e,t){var n=zo(e),r=!n&&qo(e),i=!n&&!r&&Qo(e),s=!n&&!r&&!i&&la(e),o=n||r||i||s,a=o?Jt(e.length,Ce):[],c=a.length;for(var u in e)!t&&!Le.call(e,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||_s(u,c))||a.push(u);return a}function Xn(e){var t=e.length;return t?e[Qr(0,t-1)]:i}function Zn(e,t){return Ps(Di(e),cr(t,0,e.length))}function er(e){return Ps(Di(e))}function tr(e,t,n){(n!==i&&!jo(e[t],n)||n===i&&!(t in e))&&or(e,t,n)}function nr(e,t,n){var r=e[t];Le.call(e,t)&&jo(r,n)&&(n!==i||t in e)||or(e,t,n)}function rr(e,t){for(var n=e.length;n--;)if(jo(e[n][0],t))return n;return-1}function ir(e,t,n,r){return fr(e,(function(e,i,s){t(r,e,n(e),s)})),r}function sr(e,t){return e&&Ni(t,Oa(t),e)}function or(e,t,n){"__proto__"==t&&nt?nt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ar(e,t){for(var n=-1,s=t.length,o=r(s),a=null==e;++n<s;)o[n]=a?i:Aa(e,t[n]);return o}function cr(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function ur(e,t,n,r,s,o){var a,c=1&t,u=2&t,l=4&t;if(n&&(a=s?n(e,r,s,o):n(e)),a!==i)return a;if(!ta(e))return e;var h=zo(e);if(h){if(a=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Le.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!c)return Di(e,a)}else{var d=ms(e),f=d==I||d==S;if(Qo(e))return Si(e,c);if(d==A||d==v||f&&!s){if(a=u||f?{}:ys(e),!c)return u?function(e,t){return Ni(e,ps(e),t)}(e,function(e,t){return e&&Ni(t,Ra(t),e)}(a,e)):function(e,t){return Ni(e,fs(e),t)}(e,sr(a,e))}else{if(!ut[d])return s?e:{};a=function(e,t,n){var r=e.constructor;switch(t){case M:return Ti(e);case w:case b:return new r(+e);case P:return function(e,t){var n=t?Ti(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case L:case U:case F:case B:case V:case j:case $:case G:case q:return ki(e,n);case T:return new r;case k:case N:return new r(e);case C:return function(e){var t=new e.constructor(e.source,me.exec(e));return t.lastIndex=e.lastIndex,t}(e);case D:return new r;case O:return i=e,Bn?Ae(Bn.call(i)):{}}var i}(e,d,c)}}o||(o=new Yn);var p=o.get(e);if(p)return p;o.set(e,a),aa(e)?e.forEach((function(r){a.add(ur(r,t,n,r,e,o))})):ra(e)&&e.forEach((function(r,i){a.set(i,ur(r,t,n,i,e,o))}));var m=h?i:(l?u?ss:is:u?Ra:Oa)(e);return Ct(m||e,(function(r,i){m&&(r=e[i=r]),nr(a,i,ur(r,t,n,i,e,o))})),a}function lr(e,t,n){var r=n.length;if(null==e)return!r;for(e=Ae(e);r--;){var s=n[r],o=t[s],a=e[s];if(a===i&&!(s in e)||!o(a))return!1}return!0}function hr(e,t,n){if("function"!=typeof e)throw new De(s);return Ns((function(){e.apply(i,n)}),t)}function dr(e,t,n,r){var i=-1,s=Rt,o=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=Pt(t,Zt(n))),r?(s=Mt,o=!1):t.length>=200&&(s=tn,o=!1,t=new Qn(t));e:for(;++i<a;){var l=e[i],h=null==n?l:n(l);if(l=r||0!==l?l:0,o&&h==h){for(var d=u;d--;)if(t[d]===h)continue e;c.push(l)}else s(t,h,r)||c.push(l)}return c}jn.templateSettings={escape:X,evaluate:Z,interpolate:ee,variable:"",imports:{_:jn}},jn.prototype=Gn.prototype,jn.prototype.constructor=jn,qn.prototype=$n(Gn.prototype),qn.prototype.constructor=qn,zn.prototype=$n(Gn.prototype),zn.prototype.constructor=zn,Hn.prototype.clear=function(){this.__data__=Dn?Dn(null):{},this.size=0},Hn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Hn.prototype.get=function(e){var t=this.__data__;if(Dn){var n=t[e];return n===o?i:n}return Le.call(t,e)?t[e]:i},Hn.prototype.has=function(e){var t=this.__data__;return Dn?t[e]!==i:Le.call(t,e)},Hn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Dn&&t===i?o:t,this},Kn.prototype.clear=function(){this.__data__=[],this.size=0},Kn.prototype.delete=function(e){var t=this.__data__,n=rr(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ye.call(t,n,1),--this.size,!0)},Kn.prototype.get=function(e){var t=this.__data__,n=rr(t,e);return n<0?i:t[n][1]},Kn.prototype.has=function(e){return rr(this.__data__,e)>-1},Kn.prototype.set=function(e,t){var n=this.__data__,r=rr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Wn.prototype.clear=function(){this.size=0,this.__data__={hash:new Hn,map:new(kn||Kn),string:new Hn}},Wn.prototype.delete=function(e){var t=ls(this,e).delete(e);return this.size-=t?1:0,t},Wn.prototype.get=function(e){return ls(this,e).get(e)},Wn.prototype.has=function(e){return ls(this,e).has(e)},Wn.prototype.set=function(e,t){var n=ls(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Qn.prototype.add=Qn.prototype.push=function(e){return this.__data__.set(e,o),this},Qn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.clear=function(){this.__data__=new Kn,this.size=0},Yn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Yn.prototype.get=function(e){return this.__data__.get(e)},Yn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Kn){var r=n.__data__;if(!kn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Wn(r)}return n.set(e,t),this.size=n.size,this};var fr=Mi(br),pr=Mi(Er,!0);function mr(e,t){var n=!0;return fr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function gr(e,t,n){for(var r=-1,s=e.length;++r<s;){var o=e[r],a=t(o);if(null!=a&&(c===i?a==a&&!ua(a):n(a,c)))var c=a,u=o}return u}function yr(e,t){var n=[];return fr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function vr(e,t,n,r,i){var s=-1,o=e.length;for(n||(n=vs),i||(i=[]);++s<o;){var a=e[s];t>0&&n(a)?t>1?vr(a,t-1,n,r,i):Lt(i,a):r||(i[i.length]=a)}return i}var _r=Pi(),wr=Pi(!0);function br(e,t){return e&&_r(e,t,Oa)}function Er(e,t){return e&&wr(e,t,Oa)}function Ir(e,t){return Ot(t,(function(t){return Xo(e[t])}))}function Sr(e,t){for(var n=0,r=(t=wi(t,e)).length;null!=e&&n<r;)e=e[Us(t[n++])];return n&&n==r?e:i}function Tr(e,t,n){var r=t(e);return zo(e)?r:Lt(r,n(e))}function kr(e){return null==e?e===i?"[object Undefined]":"[object Null]":Ze&&Ze in Ae(e)?function(e){var t=Le.call(e,Ze),n=e[Ze];try{e[Ze]=i;var r=!0}catch(e){}var s=Be.call(e);r&&(t?e[Ze]=n:delete e[Ze]);return s}(e):function(e){return Be.call(e)}(e)}function Ar(e,t){return e>t}function xr(e,t){return null!=e&&Le.call(e,t)}function Cr(e,t){return null!=e&&t in Ae(e)}function Dr(e,t,n){for(var s=n?Mt:Rt,o=e[0].length,a=e.length,c=a,u=r(a),l=1/0,h=[];c--;){var d=e[c];c&&t&&(d=Pt(d,Zt(t))),l=wn(d.length,l),u[c]=!n&&(t||o>=120&&d.length>=120)?new Qn(c&&d):i}d=e[0];var f=-1,p=u[0];e:for(;++f<o&&h.length<l;){var m=d[f],g=t?t(m):m;if(m=n||0!==m?m:0,!(p?tn(p,g):s(h,g,n))){for(c=a;--c;){var y=u[c];if(!(y?tn(y,g):s(e[c],g,n)))continue e}p&&p.push(g),h.push(m)}}return h}function Nr(e,t,n){var r=null==(e=xs(e,t=wi(t,e)))?e:e[Us(Ys(t))];return null==r?i:At(r,e,n)}function Or(e){return na(e)&&kr(e)==v}function Rr(e,t,n,r,s){return e===t||(null==e||null==t||!na(e)&&!na(t)?e!=e&&t!=t:function(e,t,n,r,s,o){var a=zo(e),c=zo(t),u=a?_:ms(e),l=c?_:ms(t),h=(u=u==v?A:u)==A,d=(l=l==v?A:l)==A,f=u==l;if(f&&Qo(e)){if(!Qo(t))return!1;a=!0,h=!1}if(f&&!h)return o||(o=new Yn),a||la(e)?ns(e,t,n,r,s,o):function(e,t,n,r,i,s,o){switch(n){case P:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case M:return!(e.byteLength!=t.byteLength||!s(new ze(e),new ze(t)));case w:case b:case k:return jo(+e,+t);case E:return e.name==t.name&&e.message==t.message;case C:case N:return e==t+"";case T:var a=un;case D:var c=1&r;if(a||(a=dn),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;r|=2,o.set(e,t);var l=ns(a(e),a(t),r,i,s,o);return o.delete(e),l;case O:if(Bn)return Bn.call(e)==Bn.call(t)}return!1}(e,t,u,n,r,s,o);if(!(1&n)){var p=h&&Le.call(e,"__wrapped__"),m=d&&Le.call(t,"__wrapped__");if(p||m){var g=p?e.value():e,y=m?t.value():t;return o||(o=new Yn),s(g,y,n,r,o)}}if(!f)return!1;return o||(o=new Yn),function(e,t,n,r,s,o){var a=1&n,c=is(e),u=c.length,l=is(t),h=l.length;if(u!=h&&!a)return!1;var d=u;for(;d--;){var f=c[d];if(!(a?f in t:Le.call(t,f)))return!1}var p=o.get(e),m=o.get(t);if(p&&m)return p==t&&m==e;var g=!0;o.set(e,t),o.set(t,e);var y=a;for(;++d<u;){var v=e[f=c[d]],_=t[f];if(r)var w=a?r(_,v,f,t,e,o):r(v,_,f,e,t,o);if(!(w===i?v===_||s(v,_,n,r,o):w)){g=!1;break}y||(y="constructor"==f)}if(g&&!y){var b=e.constructor,E=t.constructor;b==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof E&&E instanceof E||(g=!1)}return o.delete(e),o.delete(t),g}(e,t,n,r,s,o)}(e,t,n,r,Rr,s))}function Mr(e,t,n,r){var s=n.length,o=s,a=!r;if(null==e)return!o;for(e=Ae(e);s--;){var c=n[s];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++s<o;){var u=(c=n[s])[0],l=e[u],h=c[1];if(a&&c[2]){if(l===i&&!(u in e))return!1}else{var d=new Yn;if(r)var f=r(l,h,u,e,t,d);if(!(f===i?Rr(h,l,3,r,d):f))return!1}}return!0}function Pr(e){return!(!ta(e)||(t=e,Fe&&Fe in t))&&(Xo(e)?$e:ve).test(Fs(e));var t}function Lr(e){return"function"==typeof e?e:null==e?ic:"object"==typeof e?zo(e)?$r(e[0],e[1]):jr(e):fc(e)}function Ur(e){if(!Ss(e))return Wt(e);var t=[];for(var n in Ae(e))Le.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Fr(e){if(!ta(e))return function(e){var t=[];if(null!=e)for(var n in Ae(e))t.push(n);return t}(e);var t=Ss(e),n=[];for(var r in e)("constructor"!=r||!t&&Le.call(e,r))&&n.push(r);return n}function Br(e,t){return e<t}function Vr(e,t){var n=-1,i=Ko(e)?r(e.length):[];return fr(e,(function(e,r,s){i[++n]=t(e,r,s)})),i}function jr(e){var t=hs(e);return 1==t.length&&t[0][2]?ks(t[0][0],t[0][1]):function(n){return n===e||Mr(n,e,t)}}function $r(e,t){return bs(e)&&Ts(t)?ks(Us(e),t):function(n){var r=Aa(n,e);return r===i&&r===t?xa(n,e):Rr(t,r,3)}}function Gr(e,t,n,r,s){e!==t&&_r(t,(function(o,a){if(s||(s=new Yn),ta(o))!function(e,t,n,r,s,o,a){var c=Cs(e,n),u=Cs(t,n),l=a.get(u);if(l)return void tr(e,n,l);var h=o?o(c,u,n+"",e,t,a):i,d=h===i;if(d){var f=zo(u),p=!f&&Qo(u),m=!f&&!p&&la(u);h=u,f||p||m?zo(c)?h=c:Wo(c)?h=Di(c):p?(d=!1,h=Si(u,!0)):m?(d=!1,h=ki(u,!0)):h=[]:sa(u)||qo(u)?(h=c,qo(c)?h=va(c):ta(c)&&!Xo(c)||(h=ys(u))):d=!1}d&&(a.set(u,h),s(h,u,r,o,a),a.delete(u));tr(e,n,h)}(e,t,a,n,Gr,r,s);else{var c=r?r(Cs(e,a),o,a+"",e,t,s):i;c===i&&(c=o),tr(e,a,c)}}),Ra)}function qr(e,t){var n=e.length;if(n)return _s(t+=t<0?n:0,n)?e[t]:i}function zr(e,t,n){t=t.length?Pt(t,(function(e){return zo(e)?function(t){return Sr(t,1===e.length?e[0]:e)}:e})):[ic];var r=-1;t=Pt(t,Zt(us()));var i=Vr(e,(function(e,n,i){var s=Pt(t,(function(t){return t(e)}));return{criteria:s,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,s=t.criteria,o=i.length,a=n.length;for(;++r<o;){var c=Ai(i[r],s[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Hr(e,t,n){for(var r=-1,i=t.length,s={};++r<i;){var o=t[r],a=Sr(e,o);n(a,o)&&ei(s,wi(o,e),a)}return s}function Kr(e,t,n,r){var i=r?qt:Gt,s=-1,o=t.length,a=e;for(e===t&&(t=Di(t)),n&&(a=Pt(e,Zt(n)));++s<o;)for(var c=0,u=t[s],l=n?n(u):u;(c=i(a,l,c,r))>-1;)a!==e&&Ye.call(a,c,1),Ye.call(e,c,1);return e}function Wr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==s){var s=i;_s(i)?Ye.call(e,i,1):di(e,i)}}return e}function Qr(e,t){return e+gt(In()*(t-e+1))}function Yr(e,t){var n="";if(!e||t<1||t>p)return n;do{t%2&&(n+=e),(t=gt(t/2))&&(e+=e)}while(t);return n}function Jr(e,t){return Os(As(e,t,ic),e+"")}function Xr(e){return Xn(ja(e))}function Zr(e,t){var n=ja(e);return Ps(n,cr(t,0,n.length))}function ei(e,t,n,r){if(!ta(e))return e;for(var s=-1,o=(t=wi(t,e)).length,a=o-1,c=e;null!=c&&++s<o;){var u=Us(t[s]),l=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(s!=a){var h=c[u];(l=r?r(h,u,c):i)===i&&(l=ta(h)?h:_s(t[s+1])?[]:{})}nr(c,u,l),c=c[u]}return e}var ti=Nn?function(e,t){return Nn.set(e,t),e}:ic,ni=nt?function(e,t){return nt(e,"toString",{configurable:!0,enumerable:!1,value:tc(t),writable:!0})}:ic;function ri(e){return Ps(ja(e))}function ii(e,t,n){var i=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(n=n>s?s:n)<0&&(n+=s),s=t>n?0:n-t>>>0,t>>>=0;for(var o=r(s);++i<s;)o[i]=e[i+t];return o}function si(e,t){var n;return fr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function oi(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var s=r+i>>>1,o=e[s];null!==o&&!ua(o)&&(n?o<=t:o<t)?r=s+1:i=s}return i}return ai(e,t,ic,n)}function ai(e,t,n,r){var s=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,c=null===t,u=ua(t),l=t===i;s<o;){var h=gt((s+o)/2),d=n(e[h]),f=d!==i,p=null===d,m=d==d,g=ua(d);if(a)var y=r||m;else y=l?m&&(r||f):c?m&&f&&(r||!p):u?m&&f&&!p&&(r||!g):!p&&!g&&(r?d<=t:d<t);y?s=h+1:o=h}return wn(o,4294967294)}function ci(e,t){for(var n=-1,r=e.length,i=0,s=[];++n<r;){var o=e[n],a=t?t(o):o;if(!n||!jo(a,c)){var c=a;s[i++]=0===o?0:o}}return s}function ui(e){return"number"==typeof e?e:ua(e)?m:+e}function li(e){if("string"==typeof e)return e;if(zo(e))return Pt(e,li)+"";if(ua(e))return Vn?Vn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function hi(e,t,n){var r=-1,i=Rt,s=e.length,o=!0,a=[],c=a;if(n)o=!1,i=Mt;else if(s>=200){var u=t?null:Yi(e);if(u)return dn(u);o=!1,i=tn,c=new Qn}else c=t?[]:a;e:for(;++r<s;){var l=e[r],h=t?t(l):l;if(l=n||0!==l?l:0,o&&h==h){for(var d=c.length;d--;)if(c[d]===h)continue e;t&&c.push(h),a.push(l)}else i(c,h,n)||(c!==a&&c.push(h),a.push(l))}return a}function di(e,t){return null==(e=xs(e,t=wi(t,e)))||delete e[Us(Ys(t))]}function fi(e,t,n,r){return ei(e,t,n(Sr(e,t)),r)}function pi(e,t,n,r){for(var i=e.length,s=r?i:-1;(r?s--:++s<i)&&t(e[s],s,e););return n?ii(e,r?0:s,r?s+1:i):ii(e,r?s+1:0,r?i:s)}function mi(e,t){var n=e;return n instanceof zn&&(n=n.value()),Ut(t,(function(e,t){return t.func.apply(t.thisArg,Lt([e],t.args))}),n)}function gi(e,t,n){var i=e.length;if(i<2)return i?hi(e[0]):[];for(var s=-1,o=r(i);++s<i;)for(var a=e[s],c=-1;++c<i;)c!=s&&(o[s]=dr(o[s]||a,e[c],t,n));return hi(vr(o,1),t,n)}function yi(e,t,n){for(var r=-1,s=e.length,o=t.length,a={};++r<s;){var c=r<o?t[r]:i;n(a,e[r],c)}return a}function vi(e){return Wo(e)?e:[]}function _i(e){return"function"==typeof e?e:ic}function wi(e,t){return zo(e)?e:bs(e,t)?[e]:Ls(_a(e))}var bi=Jr;function Ei(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ii(e,t,n)}var Ii=it||function(e){return mt.clearTimeout(e)};function Si(e,t){if(t)return e.slice();var n=e.length,r=He?He(n):new e.constructor(n);return e.copy(r),r}function Ti(e){var t=new e.constructor(e.byteLength);return new ze(t).set(new ze(e)),t}function ki(e,t){var n=t?Ti(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ai(e,t){if(e!==t){var n=e!==i,r=null===e,s=e==e,o=ua(e),a=t!==i,c=null===t,u=t==t,l=ua(t);if(!c&&!l&&!o&&e>t||o&&a&&u&&!c&&!l||r&&a&&u||!n&&u||!s)return 1;if(!r&&!o&&!l&&e<t||l&&n&&s&&!r&&!o||c&&n&&s||!a&&s||!u)return-1}return 0}function xi(e,t,n,i){for(var s=-1,o=e.length,a=n.length,c=-1,u=t.length,l=_n(o-a,0),h=r(u+l),d=!i;++c<u;)h[c]=t[c];for(;++s<a;)(d||s<o)&&(h[n[s]]=e[s]);for(;l--;)h[c++]=e[s++];return h}function Ci(e,t,n,i){for(var s=-1,o=e.length,a=-1,c=n.length,u=-1,l=t.length,h=_n(o-c,0),d=r(h+l),f=!i;++s<h;)d[s]=e[s];for(var p=s;++u<l;)d[p+u]=t[u];for(;++a<c;)(f||s<o)&&(d[p+n[a]]=e[s++]);return d}function Di(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Ni(e,t,n,r){var s=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var c=t[o],u=r?r(n[c],e[c],c,n,e):i;u===i&&(u=e[c]),s?or(n,c,u):nr(n,c,u)}return n}function Oi(e,t){return function(n,r){var i=zo(n)?xt:ir,s=t?t():{};return i(n,e,us(r,2),s)}}function Ri(e){return Jr((function(t,n){var r=-1,s=n.length,o=s>1?n[s-1]:i,a=s>2?n[2]:i;for(o=e.length>3&&"function"==typeof o?(s--,o):i,a&&ws(n[0],n[1],a)&&(o=s<3?i:o,s=1),t=Ae(t);++r<s;){var c=n[r];c&&e(t,c,r,o)}return t}))}function Mi(e,t){return function(n,r){if(null==n)return n;if(!Ko(n))return e(n,r);for(var i=n.length,s=t?i:-1,o=Ae(n);(t?s--:++s<i)&&!1!==r(o[s],s,o););return n}}function Pi(e){return function(t,n,r){for(var i=-1,s=Ae(t),o=r(t),a=o.length;a--;){var c=o[e?a:++i];if(!1===n(s[c],c,s))break}return t}}function Li(e){return function(t){var n=cn(t=_a(t))?mn(t):i,r=n?n[0]:t.charAt(0),s=n?Ei(n,1).join(""):t.slice(1);return r[e]()+s}}function Ui(e){return function(t){return Ut(Xa(qa(t).replace(et,"")),e,"")}}function Fi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=$n(e.prototype),r=e.apply(n,t);return ta(r)?r:n}}function Bi(e){return function(t,n,r){var s=Ae(t);if(!Ko(t)){var o=us(n,3);t=Oa(t),n=function(e){return o(s[e],e,s)}}var a=e(t,n,r);return a>-1?s[o?t[a]:a]:i}}function Vi(e){return rs((function(t){var n=t.length,r=n,o=qn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new De(s);if(o&&!c&&"wrapper"==as(a))var c=new qn([],!0)}for(r=c?r:n;++r<n;){var u=as(a=t[r]),l="wrapper"==u?os(a):i;c=l&&Es(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?c[as(l[0])].apply(c,l[3]):1==a.length&&Es(a)?c[u]():c.thru(a)}return function(){var e=arguments,r=e[0];if(c&&1==e.length&&zo(r))return c.plant(r).value();for(var i=0,s=n?t[i].apply(this,e):r;++i<n;)s=t[i].call(this,s);return s}}))}function ji(e,t,n,s,o,a,c,u,l,d){var f=t&h,p=1&t,m=2&t,g=24&t,y=512&t,v=m?i:Fi(e);return function h(){for(var _=arguments.length,w=r(_),b=_;b--;)w[b]=arguments[b];if(g)var E=cs(h),I=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(w,E);if(s&&(w=xi(w,s,o,g)),a&&(w=Ci(w,a,c,g)),_-=I,g&&_<d){var S=hn(w,E);return Wi(e,t,ji,h.placeholder,n,w,S,u,l,d-_)}var T=p?n:this,k=m?T[e]:e;return _=w.length,u?w=function(e,t){var n=e.length,r=wn(t.length,n),s=Di(e);for(;r--;){var o=t[r];e[r]=_s(o,n)?s[o]:i}return e}(w,u):y&&_>1&&w.reverse(),f&&l<_&&(w.length=l),this&&this!==mt&&this instanceof h&&(k=v||Fi(k)),k.apply(T,w)}}function $i(e,t){return function(n,r){return function(e,t,n,r){return br(e,(function(e,i,s){t(r,n(e),i,s)})),r}(n,e,t(r),{})}}function Gi(e,t){return function(n,r){var s;if(n===i&&r===i)return t;if(n!==i&&(s=n),r!==i){if(s===i)return r;"string"==typeof n||"string"==typeof r?(n=li(n),r=li(r)):(n=ui(n),r=ui(r)),s=e(n,r)}return s}}function qi(e){return rs((function(t){return t=Pt(t,Zt(us())),Jr((function(n){var r=this;return e(t,(function(e){return At(e,r,n)}))}))}))}function zi(e,t){var n=(t=t===i?" ":li(t)).length;if(n<2)return n?Yr(t,e):t;var r=Yr(t,pt(e/pn(t)));return cn(t)?Ei(mn(r),0,e).join(""):r.slice(0,e)}function Hi(e){return function(t,n,s){return s&&"number"!=typeof s&&ws(t,n,s)&&(n=s=i),t=pa(t),n===i?(n=t,t=0):n=pa(n),function(e,t,n,i){for(var s=-1,o=_n(pt((t-e)/(n||1)),0),a=r(o);o--;)a[i?o:++s]=e,e+=n;return a}(t,n,s=s===i?t<n?1:-1:pa(s),e)}}function Ki(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ya(t),n=ya(n)),e(t,n)}}function Wi(e,t,n,r,s,o,a,c,h,d){var f=8&t;t|=f?u:l,4&(t&=~(f?l:u))||(t&=-4);var p=[e,t,s,f?o:i,f?a:i,f?i:o,f?i:a,c,h,d],m=n.apply(i,p);return Es(e)&&Ds(m,p),m.placeholder=r,Rs(m,e,t)}function Qi(e){var t=ke[e];return function(e,n){if(e=ya(e),(n=null==n?0:wn(ma(n),292))&&wt(e)){var r=(_a(e)+"e").split("e");return+((r=(_a(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Yi=xn&&1/dn(new xn([,-0]))[1]==f?function(e){return new xn(e)}:uc;function Ji(e){return function(t){var n=ms(t);return n==T?un(t):n==D?fn(t):function(e,t){return Pt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Xi(e,t,n,o,f,p,m,g){var y=2&t;if(!y&&"function"!=typeof e)throw new De(s);var v=o?o.length:0;if(v||(t&=-97,o=f=i),m=m===i?m:_n(ma(m),0),g=g===i?g:ma(g),v-=f?f.length:0,t&l){var _=o,w=f;o=f=i}var b=y?i:os(e),E=[e,t,n,o,f,_,w,p,m,g];if(b&&function(e,t){var n=e[1],r=t[1],i=n|r,s=i<131,o=r==h&&8==n||r==h&&n==d&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!s&&!o)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var c=t[3];if(c){var u=e[3];e[3]=u?xi(u,c,t[4]):c,e[4]=u?hn(e[3],a):t[4]}(c=t[5])&&(u=e[5],e[5]=u?Ci(u,c,t[6]):c,e[6]=u?hn(e[5],a):t[6]);(c=t[7])&&(e[7]=c);r&h&&(e[8]=null==e[8]?t[8]:wn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(E,b),e=E[0],t=E[1],n=E[2],o=E[3],f=E[4],!(g=E[9]=E[9]===i?y?0:e.length:_n(E[9]-v,0))&&24&t&&(t&=-25),t&&1!=t)I=8==t||t==c?function(e,t,n){var s=Fi(e);return function o(){for(var a=arguments.length,c=r(a),u=a,l=cs(o);u--;)c[u]=arguments[u];var h=a<3&&c[0]!==l&&c[a-1]!==l?[]:hn(c,l);return(a-=h.length)<n?Wi(e,t,ji,o.placeholder,i,c,h,i,i,n-a):At(this&&this!==mt&&this instanceof o?s:e,this,c)}}(e,t,g):t!=u&&33!=t||f.length?ji.apply(i,E):function(e,t,n,i){var s=1&t,o=Fi(e);return function t(){for(var a=-1,c=arguments.length,u=-1,l=i.length,h=r(l+c),d=this&&this!==mt&&this instanceof t?o:e;++u<l;)h[u]=i[u];for(;c--;)h[u++]=arguments[++a];return At(d,s?n:this,h)}}(e,t,n,o);else var I=function(e,t,n){var r=1&t,i=Fi(e);return function t(){return(this&&this!==mt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Rs((b?ti:Ds)(I,E),e,t)}function Zi(e,t,n,r){return e===i||jo(e,Re[n])&&!Le.call(r,n)?t:e}function es(e,t,n,r,s,o){return ta(e)&&ta(t)&&(o.set(t,e),Gr(e,t,i,es,o),o.delete(t)),e}function ts(e){return sa(e)?i:e}function ns(e,t,n,r,s,o){var a=1&n,c=e.length,u=t.length;if(c!=u&&!(a&&u>c))return!1;var l=o.get(e),h=o.get(t);if(l&&h)return l==t&&h==e;var d=-1,f=!0,p=2&n?new Qn:i;for(o.set(e,t),o.set(t,e);++d<c;){var m=e[d],g=t[d];if(r)var y=a?r(g,m,d,t,e,o):r(m,g,d,e,t,o);if(y!==i){if(y)continue;f=!1;break}if(p){if(!Bt(t,(function(e,t){if(!tn(p,t)&&(m===e||s(m,e,n,r,o)))return p.push(t)}))){f=!1;break}}else if(m!==g&&!s(m,g,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function rs(e){return Os(As(e,i,zs),e+"")}function is(e){return Tr(e,Oa,fs)}function ss(e){return Tr(e,Ra,ps)}var os=Nn?function(e){return Nn.get(e)}:uc;function as(e){for(var t=e.name+"",n=On[t],r=Le.call(On,t)?n.length:0;r--;){var i=n[r],s=i.func;if(null==s||s==e)return i.name}return t}function cs(e){return(Le.call(jn,"placeholder")?jn:e).placeholder}function us(){var e=jn.iteratee||sc;return e=e===sc?Lr:e,arguments.length?e(arguments[0],arguments[1]):e}function ls(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function hs(e){for(var t=Oa(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Ts(i)]}return t}function ds(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Pr(n)?n:i}var fs=yt?function(e){return null==e?[]:(e=Ae(e),Ot(yt(e),(function(t){return Qe.call(e,t)})))}:gc,ps=yt?function(e){for(var t=[];e;)Lt(t,fs(e)),e=Ke(e);return t}:gc,ms=kr;function gs(e,t,n){for(var r=-1,i=(t=wi(t,e)).length,s=!1;++r<i;){var o=Us(t[r]);if(!(s=null!=e&&n(e,o)))break;e=e[o]}return s||++r!=i?s:!!(i=null==e?0:e.length)&&ea(i)&&_s(o,i)&&(zo(e)||qo(e))}function ys(e){return"function"!=typeof e.constructor||Ss(e)?{}:$n(Ke(e))}function vs(e){return zo(e)||qo(e)||!!(Je&&e&&e[Je])}function _s(e,t){var n=typeof e;return!!(t=null==t?p:t)&&("number"==n||"symbol"!=n&&we.test(e))&&e>-1&&e%1==0&&e<t}function ws(e,t,n){if(!ta(n))return!1;var r=typeof t;return!!("number"==r?Ko(n)&&_s(t,n.length):"string"==r&&t in n)&&jo(n[t],e)}function bs(e,t){if(zo(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ua(e))||(ne.test(e)||!te.test(e)||null!=t&&e in Ae(t))}function Es(e){var t=as(e),n=jn[t];if("function"!=typeof n||!(t in zn.prototype))return!1;if(e===n)return!0;var r=os(n);return!!r&&e===r[0]}(Tn&&ms(new Tn(new ArrayBuffer(1)))!=P||kn&&ms(new kn)!=T||An&&ms(An.resolve())!=x||xn&&ms(new xn)!=D||Cn&&ms(new Cn)!=R)&&(ms=function(e){var t=kr(e),n=t==A?e.constructor:i,r=n?Fs(n):"";if(r)switch(r){case Rn:return P;case Mn:return T;case Pn:return x;case Ln:return D;case Un:return R}return t});var Is=Me?Xo:yc;function Ss(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Re)}function Ts(e){return e==e&&!ta(e)}function ks(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==i||e in Ae(n)))}}function As(e,t,n){return t=_n(t===i?e.length-1:t,0),function(){for(var i=arguments,s=-1,o=_n(i.length-t,0),a=r(o);++s<o;)a[s]=i[t+s];s=-1;for(var c=r(t+1);++s<t;)c[s]=i[s];return c[t]=n(a),At(e,this,c)}}function xs(e,t){return t.length<2?e:Sr(e,ii(t,0,-1))}function Cs(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Ds=Ms(ti),Ns=ft||function(e,t){return mt.setTimeout(e,t)},Os=Ms(ni);function Rs(e,t,n){var r=t+"";return Os(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ce,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Ct(y,(function(n){var r="_."+n[0];t&n[1]&&!Rt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ue);return t?t[1].split(le):[]}(r),n)))}function Ms(e){var t=0,n=0;return function(){var r=bn(),s=16-(r-n);if(n=r,s>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Ps(e,t){var n=-1,r=e.length,s=r-1;for(t=t===i?r:t;++n<t;){var o=Qr(n,s),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}var Ls=function(e){var t=Po(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(re,(function(e,n,r,i){t.push(r?i.replace(fe,"$1"):n||e)})),t}));function Us(e){if("string"==typeof e||ua(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Fs(e){if(null!=e){try{return Pe.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Bs(e){if(e instanceof zn)return e.clone();var t=new qn(e.__wrapped__,e.__chain__);return t.__actions__=Di(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Vs=Jr((function(e,t){return Wo(e)?dr(e,vr(t,1,Wo,!0)):[]})),js=Jr((function(e,t){var n=Ys(t);return Wo(n)&&(n=i),Wo(e)?dr(e,vr(t,1,Wo,!0),us(n,2)):[]})),$s=Jr((function(e,t){var n=Ys(t);return Wo(n)&&(n=i),Wo(e)?dr(e,vr(t,1,Wo,!0),i,n):[]}));function Gs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ma(n);return i<0&&(i=_n(r+i,0)),$t(e,us(t,3),i)}function qs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var s=r-1;return n!==i&&(s=ma(n),s=n<0?_n(r+s,0):wn(s,r-1)),$t(e,us(t,3),s,!0)}function zs(e){return(null==e?0:e.length)?vr(e,1):[]}function Hs(e){return e&&e.length?e[0]:i}var Ks=Jr((function(e){var t=Pt(e,vi);return t.length&&t[0]===e[0]?Dr(t):[]})),Ws=Jr((function(e){var t=Ys(e),n=Pt(e,vi);return t===Ys(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Dr(n,us(t,2)):[]})),Qs=Jr((function(e){var t=Ys(e),n=Pt(e,vi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?Dr(n,i,t):[]}));function Ys(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Js=Jr(Xs);function Xs(e,t){return e&&e.length&&t&&t.length?Kr(e,t):e}var Zs=rs((function(e,t){var n=null==e?0:e.length,r=ar(e,t);return Wr(e,Pt(t,(function(e){return _s(e,n)?+e:e})).sort(Ai)),r}));function eo(e){return null==e?e:Sn.call(e)}var to=Jr((function(e){return hi(vr(e,1,Wo,!0))})),no=Jr((function(e){var t=Ys(e);return Wo(t)&&(t=i),hi(vr(e,1,Wo,!0),us(t,2))})),ro=Jr((function(e){var t=Ys(e);return t="function"==typeof t?t:i,hi(vr(e,1,Wo,!0),i,t)}));function io(e){if(!e||!e.length)return[];var t=0;return e=Ot(e,(function(e){if(Wo(e))return t=_n(e.length,t),!0})),Jt(t,(function(t){return Pt(e,Kt(t))}))}function so(e,t){if(!e||!e.length)return[];var n=io(e);return null==t?n:Pt(n,(function(e){return At(t,i,e)}))}var oo=Jr((function(e,t){return Wo(e)?dr(e,t):[]})),ao=Jr((function(e){return gi(Ot(e,Wo))})),co=Jr((function(e){var t=Ys(e);return Wo(t)&&(t=i),gi(Ot(e,Wo),us(t,2))})),uo=Jr((function(e){var t=Ys(e);return t="function"==typeof t?t:i,gi(Ot(e,Wo),i,t)})),lo=Jr(io);var ho=Jr((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,so(e,n)}));function fo(e){var t=jn(e);return t.__chain__=!0,t}function po(e,t){return t(e)}var mo=rs((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,s=function(t){return ar(t,e)};return!(t>1||this.__actions__.length)&&r instanceof zn&&_s(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:po,args:[s],thisArg:i}),new qn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(s)}));var go=Oi((function(e,t,n){Le.call(e,n)?++e[n]:or(e,n,1)}));var yo=Bi(Gs),vo=Bi(qs);function _o(e,t){return(zo(e)?Ct:fr)(e,us(t,3))}function wo(e,t){return(zo(e)?Dt:pr)(e,us(t,3))}var bo=Oi((function(e,t,n){Le.call(e,n)?e[n].push(t):or(e,n,[t])}));var Eo=Jr((function(e,t,n){var i=-1,s="function"==typeof t,o=Ko(e)?r(e.length):[];return fr(e,(function(e){o[++i]=s?At(t,e,n):Nr(e,t,n)})),o})),Io=Oi((function(e,t,n){or(e,n,t)}));function So(e,t){return(zo(e)?Pt:Vr)(e,us(t,3))}var To=Oi((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var ko=Jr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&ws(e,t[0],t[1])?t=[]:n>2&&ws(t[0],t[1],t[2])&&(t=[t[0]]),zr(e,vr(t,1),[])})),Ao=lt||function(){return mt.Date.now()};function xo(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Xi(e,h,i,i,i,i,t)}function Co(e,t){var n;if("function"!=typeof t)throw new De(s);return e=ma(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Do=Jr((function(e,t,n){var r=1;if(n.length){var i=hn(n,cs(Do));r|=u}return Xi(e,r,t,n,i)})),No=Jr((function(e,t,n){var r=3;if(n.length){var i=hn(n,cs(No));r|=u}return Xi(t,r,e,n,i)}));function Oo(e,t,n){var r,o,a,c,u,l,h=0,d=!1,f=!1,p=!0;if("function"!=typeof e)throw new De(s);function m(t){var n=r,s=o;return r=o=i,h=t,c=e.apply(s,n)}function g(e){var n=e-l;return l===i||n>=t||n<0||f&&e-h>=a}function y(){var e=Ao();if(g(e))return v(e);u=Ns(y,function(e){var n=t-(e-l);return f?wn(n,a-(e-h)):n}(e))}function v(e){return u=i,p&&r?m(e):(r=o=i,c)}function _(){var e=Ao(),n=g(e);if(r=arguments,o=this,l=e,n){if(u===i)return function(e){return h=e,u=Ns(y,t),d?m(e):c}(l);if(f)return Ii(u),u=Ns(y,t),m(l)}return u===i&&(u=Ns(y,t)),c}return t=ya(t)||0,ta(n)&&(d=!!n.leading,a=(f="maxWait"in n)?_n(ya(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),_.cancel=function(){u!==i&&Ii(u),h=0,r=l=o=u=i},_.flush=function(){return u===i?c:v(Ao())},_}var Ro=Jr((function(e,t){return hr(e,1,t)})),Mo=Jr((function(e,t,n){return hr(e,ya(t)||0,n)}));function Po(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new De(s);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(Po.Cache||Wn),n}function Lo(e){if("function"!=typeof e)throw new De(s);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Po.Cache=Wn;var Uo=bi((function(e,t){var n=(t=1==t.length&&zo(t[0])?Pt(t[0],Zt(us())):Pt(vr(t,1),Zt(us()))).length;return Jr((function(r){for(var i=-1,s=wn(r.length,n);++i<s;)r[i]=t[i].call(this,r[i]);return At(e,this,r)}))})),Fo=Jr((function(e,t){var n=hn(t,cs(Fo));return Xi(e,u,i,t,n)})),Bo=Jr((function(e,t){var n=hn(t,cs(Bo));return Xi(e,l,i,t,n)})),Vo=rs((function(e,t){return Xi(e,d,i,i,i,t)}));function jo(e,t){return e===t||e!=e&&t!=t}var $o=Ki(Ar),Go=Ki((function(e,t){return e>=t})),qo=Or(function(){return arguments}())?Or:function(e){return na(e)&&Le.call(e,"callee")&&!Qe.call(e,"callee")},zo=r.isArray,Ho=bt?Zt(bt):function(e){return na(e)&&kr(e)==M};function Ko(e){return null!=e&&ea(e.length)&&!Xo(e)}function Wo(e){return na(e)&&Ko(e)}var Qo=_t||yc,Yo=Et?Zt(Et):function(e){return na(e)&&kr(e)==b};function Jo(e){if(!na(e))return!1;var t=kr(e);return t==E||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!sa(e)}function Xo(e){if(!ta(e))return!1;var t=kr(e);return t==I||t==S||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Zo(e){return"number"==typeof e&&e==ma(e)}function ea(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=p}function ta(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function na(e){return null!=e&&"object"==typeof e}var ra=It?Zt(It):function(e){return na(e)&&ms(e)==T};function ia(e){return"number"==typeof e||na(e)&&kr(e)==k}function sa(e){if(!na(e)||kr(e)!=A)return!1;var t=Ke(e);if(null===t)return!0;var n=Le.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Pe.call(n)==Ve}var oa=St?Zt(St):function(e){return na(e)&&kr(e)==C};var aa=Tt?Zt(Tt):function(e){return na(e)&&ms(e)==D};function ca(e){return"string"==typeof e||!zo(e)&&na(e)&&kr(e)==N}function ua(e){return"symbol"==typeof e||na(e)&&kr(e)==O}var la=kt?Zt(kt):function(e){return na(e)&&ea(e.length)&&!!ct[kr(e)]};var ha=Ki(Br),da=Ki((function(e,t){return e<=t}));function fa(e){if(!e)return[];if(Ko(e))return ca(e)?mn(e):Di(e);if(Xe&&e[Xe])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Xe]());var t=ms(e);return(t==T?un:t==D?dn:ja)(e)}function pa(e){return e?(e=ya(e))===f||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ma(e){var t=pa(e),n=t%1;return t==t?n?t-n:t:0}function ga(e){return e?cr(ma(e),0,g):0}function ya(e){if("number"==typeof e)return e;if(ua(e))return m;if(ta(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ta(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xt(e);var n=ye.test(e);return n||_e.test(e)?dt(e.slice(2),n?2:8):ge.test(e)?m:+e}function va(e){return Ni(e,Ra(e))}function _a(e){return null==e?"":li(e)}var wa=Ri((function(e,t){if(Ss(t)||Ko(t))Ni(t,Oa(t),e);else for(var n in t)Le.call(t,n)&&nr(e,n,t[n])})),ba=Ri((function(e,t){Ni(t,Ra(t),e)})),Ea=Ri((function(e,t,n,r){Ni(t,Ra(t),e,r)})),Ia=Ri((function(e,t,n,r){Ni(t,Oa(t),e,r)})),Sa=rs(ar);var Ta=Jr((function(e,t){e=Ae(e);var n=-1,r=t.length,s=r>2?t[2]:i;for(s&&ws(t[0],t[1],s)&&(r=1);++n<r;)for(var o=t[n],a=Ra(o),c=-1,u=a.length;++c<u;){var l=a[c],h=e[l];(h===i||jo(h,Re[l])&&!Le.call(e,l))&&(e[l]=o[l])}return e})),ka=Jr((function(e){return e.push(i,es),At(Pa,i,e)}));function Aa(e,t,n){var r=null==e?i:Sr(e,t);return r===i?n:r}function xa(e,t){return null!=e&&gs(e,t,Cr)}var Ca=$i((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Be.call(t)),e[t]=n}),tc(ic)),Da=$i((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Be.call(t)),Le.call(e,t)?e[t].push(n):e[t]=[n]}),us),Na=Jr(Nr);function Oa(e){return Ko(e)?Jn(e):Ur(e)}function Ra(e){return Ko(e)?Jn(e,!0):Fr(e)}var Ma=Ri((function(e,t,n){Gr(e,t,n)})),Pa=Ri((function(e,t,n,r){Gr(e,t,n,r)})),La=rs((function(e,t){var n={};if(null==e)return n;var r=!1;t=Pt(t,(function(t){return t=wi(t,e),r||(r=t.length>1),t})),Ni(e,ss(e),n),r&&(n=ur(n,7,ts));for(var i=t.length;i--;)di(n,t[i]);return n}));var Ua=rs((function(e,t){return null==e?{}:function(e,t){return Hr(e,t,(function(t,n){return xa(e,n)}))}(e,t)}));function Fa(e,t){if(null==e)return{};var n=Pt(ss(e),(function(e){return[e]}));return t=us(t),Hr(e,n,(function(e,n){return t(e,n[0])}))}var Ba=Ji(Oa),Va=Ji(Ra);function ja(e){return null==e?[]:en(e,Oa(e))}var $a=Ui((function(e,t,n){return t=t.toLowerCase(),e+(n?Ga(t):t)}));function Ga(e){return Ja(_a(e).toLowerCase())}function qa(e){return(e=_a(e))&&e.replace(be,sn).replace(tt,"")}var za=Ui((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Ha=Ui((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ka=Li("toLowerCase");var Wa=Ui((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Qa=Ui((function(e,t,n){return e+(n?" ":"")+Ja(t)}));var Ya=Ui((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ja=Li("toUpperCase");function Xa(e,t,n){return e=_a(e),(t=n?i:t)===i?function(e){return st.test(e)}(e)?function(e){return e.match(rt)||[]}(e):function(e){return e.match(he)||[]}(e):e.match(t)||[]}var Za=Jr((function(e,t){try{return At(e,i,t)}catch(e){return Jo(e)?e:new Se(e)}})),ec=rs((function(e,t){return Ct(t,(function(t){t=Us(t),or(e,t,Do(e[t],e))})),e}));function tc(e){return function(){return e}}var nc=Vi(),rc=Vi(!0);function ic(e){return e}function sc(e){return Lr("function"==typeof e?e:ur(e,1))}var oc=Jr((function(e,t){return function(n){return Nr(n,e,t)}})),ac=Jr((function(e,t){return function(n){return Nr(e,n,t)}}));function cc(e,t,n){var r=Oa(t),i=Ir(t,r);null!=n||ta(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Ir(t,Oa(t)));var s=!(ta(n)&&"chain"in n&&!n.chain),o=Xo(e);return Ct(i,(function(n){var r=t[n];e[n]=r,o&&(e.prototype[n]=function(){var t=this.__chain__;if(s||t){var n=e(this.__wrapped__);return(n.__actions__=Di(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Lt([this.value()],arguments))})})),e}function uc(){}var lc=qi(Pt),hc=qi(Nt),dc=qi(Bt);function fc(e){return bs(e)?Kt(Us(e)):function(e){return function(t){return Sr(t,e)}}(e)}var pc=Hi(),mc=Hi(!0);function gc(){return[]}function yc(){return!1}var vc=Gi((function(e,t){return e+t}),0),_c=Qi("ceil"),wc=Gi((function(e,t){return e/t}),1),bc=Qi("floor");var Ec,Ic=Gi((function(e,t){return e*t}),1),Sc=Qi("round"),Tc=Gi((function(e,t){return e-t}),0);return jn.after=function(e,t){if("function"!=typeof t)throw new De(s);return e=ma(e),function(){if(--e<1)return t.apply(this,arguments)}},jn.ary=xo,jn.assign=wa,jn.assignIn=ba,jn.assignInWith=Ea,jn.assignWith=Ia,jn.at=Sa,jn.before=Co,jn.bind=Do,jn.bindAll=ec,jn.bindKey=No,jn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return zo(e)?e:[e]},jn.chain=fo,jn.chunk=function(e,t,n){t=(n?ws(e,t,n):t===i)?1:_n(ma(t),0);var s=null==e?0:e.length;if(!s||t<1)return[];for(var o=0,a=0,c=r(pt(s/t));o<s;)c[a++]=ii(e,o,o+=t);return c},jn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var s=e[t];s&&(i[r++]=s)}return i},jn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Lt(zo(n)?Di(n):[n],vr(t,1))},jn.cond=function(e){var t=null==e?0:e.length,n=us();return e=t?Pt(e,(function(e){if("function"!=typeof e[1])throw new De(s);return[n(e[0]),e[1]]})):[],Jr((function(n){for(var r=-1;++r<t;){var i=e[r];if(At(i[0],this,n))return At(i[1],this,n)}}))},jn.conforms=function(e){return function(e){var t=Oa(e);return function(n){return lr(n,e,t)}}(ur(e,1))},jn.constant=tc,jn.countBy=go,jn.create=function(e,t){var n=$n(e);return null==t?n:sr(n,t)},jn.curry=function e(t,n,r){var s=Xi(t,8,i,i,i,i,i,n=r?i:n);return s.placeholder=e.placeholder,s},jn.curryRight=function e(t,n,r){var s=Xi(t,c,i,i,i,i,i,n=r?i:n);return s.placeholder=e.placeholder,s},jn.debounce=Oo,jn.defaults=Ta,jn.defaultsDeep=ka,jn.defer=Ro,jn.delay=Mo,jn.difference=Vs,jn.differenceBy=js,jn.differenceWith=$s,jn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ii(e,(t=n||t===i?1:ma(t))<0?0:t,r):[]},jn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ii(e,0,(t=r-(t=n||t===i?1:ma(t)))<0?0:t):[]},jn.dropRightWhile=function(e,t){return e&&e.length?pi(e,us(t,3),!0,!0):[]},jn.dropWhile=function(e,t){return e&&e.length?pi(e,us(t,3),!0):[]},jn.fill=function(e,t,n,r){var s=null==e?0:e.length;return s?(n&&"number"!=typeof n&&ws(e,t,n)&&(n=0,r=s),function(e,t,n,r){var s=e.length;for((n=ma(n))<0&&(n=-n>s?0:s+n),(r=r===i||r>s?s:ma(r))<0&&(r+=s),r=n>r?0:ga(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},jn.filter=function(e,t){return(zo(e)?Ot:yr)(e,us(t,3))},jn.flatMap=function(e,t){return vr(So(e,t),1)},jn.flatMapDeep=function(e,t){return vr(So(e,t),f)},jn.flatMapDepth=function(e,t,n){return n=n===i?1:ma(n),vr(So(e,t),n)},jn.flatten=zs,jn.flattenDeep=function(e){return(null==e?0:e.length)?vr(e,f):[]},jn.flattenDepth=function(e,t){return(null==e?0:e.length)?vr(e,t=t===i?1:ma(t)):[]},jn.flip=function(e){return Xi(e,512)},jn.flow=nc,jn.flowRight=rc,jn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},jn.functions=function(e){return null==e?[]:Ir(e,Oa(e))},jn.functionsIn=function(e){return null==e?[]:Ir(e,Ra(e))},jn.groupBy=bo,jn.initial=function(e){return(null==e?0:e.length)?ii(e,0,-1):[]},jn.intersection=Ks,jn.intersectionBy=Ws,jn.intersectionWith=Qs,jn.invert=Ca,jn.invertBy=Da,jn.invokeMap=Eo,jn.iteratee=sc,jn.keyBy=Io,jn.keys=Oa,jn.keysIn=Ra,jn.map=So,jn.mapKeys=function(e,t){var n={};return t=us(t,3),br(e,(function(e,r,i){or(n,t(e,r,i),e)})),n},jn.mapValues=function(e,t){var n={};return t=us(t,3),br(e,(function(e,r,i){or(n,r,t(e,r,i))})),n},jn.matches=function(e){return jr(ur(e,1))},jn.matchesProperty=function(e,t){return $r(e,ur(t,1))},jn.memoize=Po,jn.merge=Ma,jn.mergeWith=Pa,jn.method=oc,jn.methodOf=ac,jn.mixin=cc,jn.negate=Lo,jn.nthArg=function(e){return e=ma(e),Jr((function(t){return qr(t,e)}))},jn.omit=La,jn.omitBy=function(e,t){return Fa(e,Lo(us(t)))},jn.once=function(e){return Co(2,e)},jn.orderBy=function(e,t,n,r){return null==e?[]:(zo(t)||(t=null==t?[]:[t]),zo(n=r?i:n)||(n=null==n?[]:[n]),zr(e,t,n))},jn.over=lc,jn.overArgs=Uo,jn.overEvery=hc,jn.overSome=dc,jn.partial=Fo,jn.partialRight=Bo,jn.partition=To,jn.pick=Ua,jn.pickBy=Fa,jn.property=fc,jn.propertyOf=function(e){return function(t){return null==e?i:Sr(e,t)}},jn.pull=Js,jn.pullAll=Xs,jn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,us(n,2)):e},jn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,i,n):e},jn.pullAt=Zs,jn.range=pc,jn.rangeRight=mc,jn.rearg=Vo,jn.reject=function(e,t){return(zo(e)?Ot:yr)(e,Lo(us(t,3)))},jn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],s=e.length;for(t=us(t,3);++r<s;){var o=e[r];t(o,r,e)&&(n.push(o),i.push(r))}return Wr(e,i),n},jn.rest=function(e,t){if("function"!=typeof e)throw new De(s);return Jr(e,t=t===i?t:ma(t))},jn.reverse=eo,jn.sampleSize=function(e,t,n){return t=(n?ws(e,t,n):t===i)?1:ma(t),(zo(e)?Zn:Zr)(e,t)},jn.set=function(e,t,n){return null==e?e:ei(e,t,n)},jn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:ei(e,t,n,r)},jn.shuffle=function(e){return(zo(e)?er:ri)(e)},jn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&ws(e,t,n)?(t=0,n=r):(t=null==t?0:ma(t),n=n===i?r:ma(n)),ii(e,t,n)):[]},jn.sortBy=ko,jn.sortedUniq=function(e){return e&&e.length?ci(e):[]},jn.sortedUniqBy=function(e,t){return e&&e.length?ci(e,us(t,2)):[]},jn.split=function(e,t,n){return n&&"number"!=typeof n&&ws(e,t,n)&&(t=n=i),(n=n===i?g:n>>>0)?(e=_a(e))&&("string"==typeof t||null!=t&&!oa(t))&&!(t=li(t))&&cn(e)?Ei(mn(e),0,n):e.split(t,n):[]},jn.spread=function(e,t){if("function"!=typeof e)throw new De(s);return t=null==t?0:_n(ma(t),0),Jr((function(n){var r=n[t],i=Ei(n,0,t);return r&&Lt(i,r),At(e,this,i)}))},jn.tail=function(e){var t=null==e?0:e.length;return t?ii(e,1,t):[]},jn.take=function(e,t,n){return e&&e.length?ii(e,0,(t=n||t===i?1:ma(t))<0?0:t):[]},jn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ii(e,(t=r-(t=n||t===i?1:ma(t)))<0?0:t,r):[]},jn.takeRightWhile=function(e,t){return e&&e.length?pi(e,us(t,3),!1,!0):[]},jn.takeWhile=function(e,t){return e&&e.length?pi(e,us(t,3)):[]},jn.tap=function(e,t){return t(e),e},jn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new De(s);return ta(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Oo(e,t,{leading:r,maxWait:t,trailing:i})},jn.thru=po,jn.toArray=fa,jn.toPairs=Ba,jn.toPairsIn=Va,jn.toPath=function(e){return zo(e)?Pt(e,Us):ua(e)?[e]:Di(Ls(_a(e)))},jn.toPlainObject=va,jn.transform=function(e,t,n){var r=zo(e),i=r||Qo(e)||la(e);if(t=us(t,4),null==n){var s=e&&e.constructor;n=i?r?new s:[]:ta(e)&&Xo(s)?$n(Ke(e)):{}}return(i?Ct:br)(e,(function(e,r,i){return t(n,e,r,i)})),n},jn.unary=function(e){return xo(e,1)},jn.union=to,jn.unionBy=no,jn.unionWith=ro,jn.uniq=function(e){return e&&e.length?hi(e):[]},jn.uniqBy=function(e,t){return e&&e.length?hi(e,us(t,2)):[]},jn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?hi(e,i,t):[]},jn.unset=function(e,t){return null==e||di(e,t)},jn.unzip=io,jn.unzipWith=so,jn.update=function(e,t,n){return null==e?e:fi(e,t,_i(n))},jn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:fi(e,t,_i(n),r)},jn.values=ja,jn.valuesIn=function(e){return null==e?[]:en(e,Ra(e))},jn.without=oo,jn.words=Xa,jn.wrap=function(e,t){return Fo(_i(t),e)},jn.xor=ao,jn.xorBy=co,jn.xorWith=uo,jn.zip=lo,jn.zipObject=function(e,t){return yi(e||[],t||[],nr)},jn.zipObjectDeep=function(e,t){return yi(e||[],t||[],ei)},jn.zipWith=ho,jn.entries=Ba,jn.entriesIn=Va,jn.extend=ba,jn.extendWith=Ea,cc(jn,jn),jn.add=vc,jn.attempt=Za,jn.camelCase=$a,jn.capitalize=Ga,jn.ceil=_c,jn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=ya(n))==n?n:0),t!==i&&(t=(t=ya(t))==t?t:0),cr(ya(e),t,n)},jn.clone=function(e){return ur(e,4)},jn.cloneDeep=function(e){return ur(e,5)},jn.cloneDeepWith=function(e,t){return ur(e,5,t="function"==typeof t?t:i)},jn.cloneWith=function(e,t){return ur(e,4,t="function"==typeof t?t:i)},jn.conformsTo=function(e,t){return null==t||lr(e,t,Oa(t))},jn.deburr=qa,jn.defaultTo=function(e,t){return null==e||e!=e?t:e},jn.divide=wc,jn.endsWith=function(e,t,n){e=_a(e),t=li(t);var r=e.length,s=n=n===i?r:cr(ma(n),0,r);return(n-=t.length)>=0&&e.slice(n,s)==t},jn.eq=jo,jn.escape=function(e){return(e=_a(e))&&J.test(e)?e.replace(Q,on):e},jn.escapeRegExp=function(e){return(e=_a(e))&&se.test(e)?e.replace(ie,"\\$&"):e},jn.every=function(e,t,n){var r=zo(e)?Nt:mr;return n&&ws(e,t,n)&&(t=i),r(e,us(t,3))},jn.find=yo,jn.findIndex=Gs,jn.findKey=function(e,t){return jt(e,us(t,3),br)},jn.findLast=vo,jn.findLastIndex=qs,jn.findLastKey=function(e,t){return jt(e,us(t,3),Er)},jn.floor=bc,jn.forEach=_o,jn.forEachRight=wo,jn.forIn=function(e,t){return null==e?e:_r(e,us(t,3),Ra)},jn.forInRight=function(e,t){return null==e?e:wr(e,us(t,3),Ra)},jn.forOwn=function(e,t){return e&&br(e,us(t,3))},jn.forOwnRight=function(e,t){return e&&Er(e,us(t,3))},jn.get=Aa,jn.gt=$o,jn.gte=Go,jn.has=function(e,t){return null!=e&&gs(e,t,xr)},jn.hasIn=xa,jn.head=Hs,jn.identity=ic,jn.includes=function(e,t,n,r){e=Ko(e)?e:ja(e),n=n&&!r?ma(n):0;var i=e.length;return n<0&&(n=_n(i+n,0)),ca(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Gt(e,t,n)>-1},jn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ma(n);return i<0&&(i=_n(r+i,0)),Gt(e,t,i)},jn.inRange=function(e,t,n){return t=pa(t),n===i?(n=t,t=0):n=pa(n),function(e,t,n){return e>=wn(t,n)&&e<_n(t,n)}(e=ya(e),t,n)},jn.invoke=Na,jn.isArguments=qo,jn.isArray=zo,jn.isArrayBuffer=Ho,jn.isArrayLike=Ko,jn.isArrayLikeObject=Wo,jn.isBoolean=function(e){return!0===e||!1===e||na(e)&&kr(e)==w},jn.isBuffer=Qo,jn.isDate=Yo,jn.isElement=function(e){return na(e)&&1===e.nodeType&&!sa(e)},jn.isEmpty=function(e){if(null==e)return!0;if(Ko(e)&&(zo(e)||"string"==typeof e||"function"==typeof e.splice||Qo(e)||la(e)||qo(e)))return!e.length;var t=ms(e);if(t==T||t==D)return!e.size;if(Ss(e))return!Ur(e).length;for(var n in e)if(Le.call(e,n))return!1;return!0},jn.isEqual=function(e,t){return Rr(e,t)},jn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Rr(e,t,i,n):!!r},jn.isError=Jo,jn.isFinite=function(e){return"number"==typeof e&&wt(e)},jn.isFunction=Xo,jn.isInteger=Zo,jn.isLength=ea,jn.isMap=ra,jn.isMatch=function(e,t){return e===t||Mr(e,t,hs(t))},jn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Mr(e,t,hs(t),n)},jn.isNaN=function(e){return ia(e)&&e!=+e},jn.isNative=function(e){if(Is(e))throw new Se("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Pr(e)},jn.isNil=function(e){return null==e},jn.isNull=function(e){return null===e},jn.isNumber=ia,jn.isObject=ta,jn.isObjectLike=na,jn.isPlainObject=sa,jn.isRegExp=oa,jn.isSafeInteger=function(e){return Zo(e)&&e>=-9007199254740991&&e<=p},jn.isSet=aa,jn.isString=ca,jn.isSymbol=ua,jn.isTypedArray=la,jn.isUndefined=function(e){return e===i},jn.isWeakMap=function(e){return na(e)&&ms(e)==R},jn.isWeakSet=function(e){return na(e)&&"[object WeakSet]"==kr(e)},jn.join=function(e,t){return null==e?"":Vt.call(e,t)},jn.kebabCase=za,jn.last=Ys,jn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var s=r;return n!==i&&(s=(s=ma(n))<0?_n(r+s,0):wn(s,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,s):$t(e,zt,s,!0)},jn.lowerCase=Ha,jn.lowerFirst=Ka,jn.lt=ha,jn.lte=da,jn.max=function(e){return e&&e.length?gr(e,ic,Ar):i},jn.maxBy=function(e,t){return e&&e.length?gr(e,us(t,2),Ar):i},jn.mean=function(e){return Ht(e,ic)},jn.meanBy=function(e,t){return Ht(e,us(t,2))},jn.min=function(e){return e&&e.length?gr(e,ic,Br):i},jn.minBy=function(e,t){return e&&e.length?gr(e,us(t,2),Br):i},jn.stubArray=gc,jn.stubFalse=yc,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=Ic,jn.nth=function(e,t){return e&&e.length?qr(e,ma(t)):i},jn.noConflict=function(){return mt._===this&&(mt._=je),this},jn.noop=uc,jn.now=Ao,jn.pad=function(e,t,n){e=_a(e);var r=(t=ma(t))?pn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return zi(gt(i),n)+e+zi(pt(i),n)},jn.padEnd=function(e,t,n){e=_a(e);var r=(t=ma(t))?pn(e):0;return t&&r<t?e+zi(t-r,n):e},jn.padStart=function(e,t,n){e=_a(e);var r=(t=ma(t))?pn(e):0;return t&&r<t?zi(t-r,n)+e:e},jn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),En(_a(e).replace(oe,""),t||0)},jn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&ws(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=pa(e),t===i?(t=e,e=0):t=pa(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var s=In();return wn(e+s*(t-e+ht("1e-"+((s+"").length-1))),t)}return Qr(e,t)},jn.reduce=function(e,t,n){var r=zo(e)?Ut:Qt,i=arguments.length<3;return r(e,us(t,4),n,i,fr)},jn.reduceRight=function(e,t,n){var r=zo(e)?Ft:Qt,i=arguments.length<3;return r(e,us(t,4),n,i,pr)},jn.repeat=function(e,t,n){return t=(n?ws(e,t,n):t===i)?1:ma(t),Yr(_a(e),t)},jn.replace=function(){var e=arguments,t=_a(e[0]);return e.length<3?t:t.replace(e[1],e[2])},jn.result=function(e,t,n){var r=-1,s=(t=wi(t,e)).length;for(s||(s=1,e=i);++r<s;){var o=null==e?i:e[Us(t[r])];o===i&&(r=s,o=n),e=Xo(o)?o.call(e):o}return e},jn.round=Sc,jn.runInContext=e,jn.sample=function(e){return(zo(e)?Xn:Xr)(e)},jn.size=function(e){if(null==e)return 0;if(Ko(e))return ca(e)?pn(e):e.length;var t=ms(e);return t==T||t==D?e.size:Ur(e).length},jn.snakeCase=Wa,jn.some=function(e,t,n){var r=zo(e)?Bt:si;return n&&ws(e,t,n)&&(t=i),r(e,us(t,3))},jn.sortedIndex=function(e,t){return oi(e,t)},jn.sortedIndexBy=function(e,t,n){return ai(e,t,us(n,2))},jn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=oi(e,t);if(r<n&&jo(e[r],t))return r}return-1},jn.sortedLastIndex=function(e,t){return oi(e,t,!0)},jn.sortedLastIndexBy=function(e,t,n){return ai(e,t,us(n,2),!0)},jn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=oi(e,t,!0)-1;if(jo(e[n],t))return n}return-1},jn.startCase=Qa,jn.startsWith=function(e,t,n){return e=_a(e),n=null==n?0:cr(ma(n),0,e.length),t=li(t),e.slice(n,n+t.length)==t},jn.subtract=Tc,jn.sum=function(e){return e&&e.length?Yt(e,ic):0},jn.sumBy=function(e,t){return e&&e.length?Yt(e,us(t,2)):0},jn.template=function(e,t,n){var r=jn.templateSettings;n&&ws(e,t,n)&&(t=i),e=_a(e),t=Ea({},t,r,Zi);var s,o,a=Ea({},t.imports,r.imports,Zi),c=Oa(a),u=en(a,c),l=0,h=t.interpolate||Ee,d="__p += '",f=xe((t.escape||Ee).source+"|"+h.source+"|"+(h===ee?pe:Ee).source+"|"+(t.evaluate||Ee).source+"|$","g"),p="//# sourceURL="+(Le.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++at+"]")+"\n";e.replace(f,(function(t,n,r,i,a,c){return r||(r=i),d+=e.slice(l,c).replace(Ie,an),n&&(s=!0,d+="' +\n__e("+n+") +\n'"),a&&(o=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+t.length,t})),d+="';\n";var m=Le.call(t,"variable")&&t.variable;if(m){if(de.test(m))throw new Se("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(z,""):d).replace(H,"$1").replace(K,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Za((function(){return Te(c,p+"return "+d).apply(i,u)}));if(g.source=d,Jo(g))throw g;return g},jn.times=function(e,t){if((e=ma(e))<1||e>p)return[];var n=g,r=wn(e,g);t=us(t),e-=g;for(var i=Jt(r,t);++n<e;)t(n);return i},jn.toFinite=pa,jn.toInteger=ma,jn.toLength=ga,jn.toLower=function(e){return _a(e).toLowerCase()},jn.toNumber=ya,jn.toSafeInteger=function(e){return e?cr(ma(e),-9007199254740991,p):0===e?e:0},jn.toString=_a,jn.toUpper=function(e){return _a(e).toUpperCase()},jn.trim=function(e,t,n){if((e=_a(e))&&(n||t===i))return Xt(e);if(!e||!(t=li(t)))return e;var r=mn(e),s=mn(t);return Ei(r,nn(r,s),rn(r,s)+1).join("")},jn.trimEnd=function(e,t,n){if((e=_a(e))&&(n||t===i))return e.slice(0,gn(e)+1);if(!e||!(t=li(t)))return e;var r=mn(e);return Ei(r,0,rn(r,mn(t))+1).join("")},jn.trimStart=function(e,t,n){if((e=_a(e))&&(n||t===i))return e.replace(oe,"");if(!e||!(t=li(t)))return e;var r=mn(e);return Ei(r,nn(r,mn(t))).join("")},jn.truncate=function(e,t){var n=30,r="...";if(ta(t)){var s="separator"in t?t.separator:s;n="length"in t?ma(t.length):n,r="omission"in t?li(t.omission):r}var o=(e=_a(e)).length;if(cn(e)){var a=mn(e);o=a.length}if(n>=o)return e;var c=n-pn(r);if(c<1)return r;var u=a?Ei(a,0,c).join(""):e.slice(0,c);if(s===i)return u+r;if(a&&(c+=u.length-c),oa(s)){if(e.slice(c).search(s)){var l,h=u;for(s.global||(s=xe(s.source,_a(me.exec(s))+"g")),s.lastIndex=0;l=s.exec(h);)var d=l.index;u=u.slice(0,d===i?c:d)}}else if(e.indexOf(li(s),c)!=c){var f=u.lastIndexOf(s);f>-1&&(u=u.slice(0,f))}return u+r},jn.unescape=function(e){return(e=_a(e))&&Y.test(e)?e.replace(W,yn):e},jn.uniqueId=function(e){var t=++Ue;return _a(e)+t},jn.upperCase=Ya,jn.upperFirst=Ja,jn.each=_o,jn.eachRight=wo,jn.first=Hs,cc(jn,(Ec={},br(jn,(function(e,t){Le.call(jn.prototype,t)||(Ec[t]=e)})),Ec),{chain:!1}),jn.VERSION="4.17.21",Ct(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){jn[e].placeholder=jn})),Ct(["drop","take"],(function(e,t){zn.prototype[e]=function(n){n=n===i?1:_n(ma(n),0);var r=this.__filtered__&&!t?new zn(this):this.clone();return r.__filtered__?r.__takeCount__=wn(n,r.__takeCount__):r.__views__.push({size:wn(n,g),type:e+(r.__dir__<0?"Right":"")}),r},zn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Ct(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;zn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:us(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),Ct(["head","last"],(function(e,t){var n="take"+(t?"Right":"");zn.prototype[e]=function(){return this[n](1).value()[0]}})),Ct(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");zn.prototype[e]=function(){return this.__filtered__?new zn(this):this[n](1)}})),zn.prototype.compact=function(){return this.filter(ic)},zn.prototype.find=function(e){return this.filter(e).head()},zn.prototype.findLast=function(e){return this.reverse().find(e)},zn.prototype.invokeMap=Jr((function(e,t){return"function"==typeof e?new zn(this):this.map((function(n){return Nr(n,e,t)}))})),zn.prototype.reject=function(e){return this.filter(Lo(us(e)))},zn.prototype.slice=function(e,t){e=ma(e);var n=this;return n.__filtered__&&(e>0||t<0)?new zn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=ma(t))<0?n.dropRight(-t):n.take(t-e)),n)},zn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},zn.prototype.toArray=function(){return this.take(g)},br(zn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),s=jn[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);s&&(jn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,c=t instanceof zn,u=a[0],l=c||zo(t),h=function(e){var t=s.apply(jn,Lt([e],a));return r&&d?t[0]:t};l&&n&&"function"==typeof u&&1!=u.length&&(c=l=!1);var d=this.__chain__,f=!!this.__actions__.length,p=o&&!d,m=c&&!f;if(!o&&l){t=m?t:new zn(this);var g=e.apply(t,a);return g.__actions__.push({func:po,args:[h],thisArg:i}),new qn(g,d)}return p&&m?e.apply(this,a):(g=this.thru(h),p?r?g.value()[0]:g.value():g)})})),Ct(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ne[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);jn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(zo(i)?i:[],e)}return this[n]((function(n){return t.apply(zo(n)?n:[],e)}))}})),br(zn.prototype,(function(e,t){var n=jn[t];if(n){var r=n.name+"";Le.call(On,r)||(On[r]=[]),On[r].push({name:t,func:n})}})),On[ji(i,2).name]=[{name:"wrapper",func:i}],zn.prototype.clone=function(){var e=new zn(this.__wrapped__);return e.__actions__=Di(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Di(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Di(this.__views__),e},zn.prototype.reverse=function(){if(this.__filtered__){var e=new zn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},zn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=zo(e),r=t<0,i=n?e.length:0,s=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var s=n[r],o=s.size;switch(s.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=wn(t,e+o);break;case"takeRight":e=_n(e,t-o)}}return{start:e,end:t}}(0,i,this.__views__),o=s.start,a=s.end,c=a-o,u=r?a:o-1,l=this.__iteratees__,h=l.length,d=0,f=wn(c,this.__takeCount__);if(!n||!r&&i==c&&f==c)return mi(e,this.__actions__);var p=[];e:for(;c--&&d<f;){for(var m=-1,g=e[u+=t];++m<h;){var y=l[m],v=y.iteratee,_=y.type,w=v(g);if(2==_)g=w;else if(!w){if(1==_)continue e;break e}}p[d++]=g}return p},jn.prototype.at=mo,jn.prototype.chain=function(){return fo(this)},jn.prototype.commit=function(){return new qn(this.value(),this.__chain__)},jn.prototype.next=function(){this.__values__===i&&(this.__values__=fa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},jn.prototype.plant=function(e){for(var t,n=this;n instanceof Gn;){var r=Bs(n);r.__index__=0,r.__values__=i,t?s.__wrapped__=r:t=r;var s=r;n=n.__wrapped__}return s.__wrapped__=e,t},jn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof zn){var t=e;return this.__actions__.length&&(t=new zn(this)),(t=t.reverse()).__actions__.push({func:po,args:[eo],thisArg:i}),new qn(t,this.__chain__)}return this.thru(eo)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return mi(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,Xe&&(jn.prototype[Xe]=function(){return this}),jn}();mt._=vn,(r=function(){return vn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},3773:function(e,t){var n,r,i;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=[e],n=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const i=e=>e&&"object"==typeof e&&"function"==typeof e.then,s=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},o=e=>1==e?"argument":"arguments",a=(e,t)=>function(n,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((i,o)=>{if(t.fallbackToNoCallback)try{n[e](...r,s({resolve:i,reject:o},t))}catch(s){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,s),n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,i()}else t.noCallback?(n[e](...r),i()):n[e](...r,s({resolve:i,reject:o},t))}))},c=(e,t,n)=>new Proxy(t,{apply:(t,r,i)=>n.call(r,e,...i)});let u=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},n={})=>{let r=Object.create(null),i={has:(t,n)=>n in e||n in r,get(i,s,o){if(s in r)return r[s];if(!(s in e))return;let h=e[s];if("function"==typeof h)if("function"==typeof t[s])h=c(e,e[s],t[s]);else if(u(n,s)){let t=a(s,n[s]);h=c(e,e[s],t)}else h=h.bind(e);else if("object"==typeof h&&null!==h&&(u(t,s)||u(n,s)))h=l(h,t[s],n[s]);else{if(!u(n,"*"))return Object.defineProperty(r,s,{configurable:!0,enumerable:!0,get:()=>e[s],set(t){e[s]=t}}),h;h=l(h,t[s],n["*"])}return r[s]=h,h},set:(t,n,i,s)=>(n in r?r[n]=i:e[n]=i,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},s=Object.create(e);return new Proxy(s,i)},h=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),d=new r((e=>"function"!=typeof e?e:function(t){const n=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)})),f=new r((e=>"function"!=typeof e?e:function(t,n,r){let s,o,a=!1,c=new Promise((e=>{s=function(t){a=!0,e(t)}}));try{o=e(t,n,s)}catch(e){o=Promise.reject(e)}const u=!0!==o&&i(o);if(!0!==o&&!u&&!a)return!1;const l=e=>{e.then((e=>{r(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))};return l(u?o:c),!0})),p=({reject:n,resolve:r},i)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():n(new Error(e.runtime.lastError.message)):i&&i.__mozWebExtensionPolyfillReject__?n(new Error(i.message)):r(i)},m=(e,t,n,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const i=p.bind(null,{resolve:e,reject:t});r.push(i),n.sendMessage(...r)}))},g={devtools:{network:{onRequestFinished:h(d)}},runtime:{onMessage:h(f),onMessageExternal:h(f),sendMessage:m.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:m.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},y={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":y},services:{"*":y},websites:{"*":y}},l(e,g,n)};e.exports=n(chrome)}else e.exports=globalThis.browser},void 0===(i="function"==typeof n?n.apply(t,r):n)||(e.exports=i)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e=n(3773),t=n.n(e);const r="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,i="8.30.0",s=globalThis;function o(e,t,n){const r=n||s,o=r.__SENTRY__=r.__SENTRY__||{},a=o[i]=o[i]||{};return a[e]||(a[e]=t())}const a=["debug","info","warn","error","log","assert","trace"],c={};function u(e){if(!("console"in s))return e();const t=s.console,n={},r=Object.keys(c);r.forEach((e=>{const r=c[e];n[e]=t[e],t[e]=r}));try{return e()}finally{r.forEach((e=>{t[e]=n[e]}))}}const l=o("logger",(function(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return r?a.forEach((n=>{t[n]=(...t)=>{e&&u((()=>{s.console[n](`Sentry Logger [${n}]:`,...t)}))}})):a.forEach((e=>{t[e]=()=>{}})),t})),h=Object.prototype.toString;function d(e){switch(h.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return E(e,Error)}}function f(e,t){return h.call(e)===`[object ${t}]`}function p(e){return f(e,"ErrorEvent")}function m(e){return f(e,"DOMError")}function g(e){return f(e,"String")}function y(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function v(e){return null===e||y(e)||"object"!=typeof e&&"function"!=typeof e}function _(e){return f(e,"Object")}function w(e){return"undefined"!=typeof Event&&E(e,Event)}function b(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function E(e,t){try{return e instanceof t}catch(e){return!1}}function I(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}const S=s;function T(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,i=[];let s=0,o=0;const a=" > ",c=a.length;let u;const l=Array.isArray(t)?t:t.keyAttrs,h=!Array.isArray(t)&&t.maxStringLength||80;for(;n&&s++<r&&(u=k(n,l),!("html"===u||s>1&&o+i.length*c+u.length>=h));)i.push(u),o+=u.length,n=n.parentNode;return i.reverse().join(a)}catch(e){return"<unknown>"}}function k(e,t){const n=e,r=[];if(!n||!n.tagName)return"";if(S.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const i=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(i&&i.length)i.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else{n.id&&r.push(`#${n.id}`);const e=n.className;if(e&&g(e)){const t=e.split(/\s+/);for(const e of t)r.push(`.${e}`)}}const s=["aria-label","type","name","title","alt"];for(const e of s){const t=n.getAttribute(e);t&&r.push(`[${e}="${t}"]`)}return r.join("")}function A(){try{return S.document.location.href}catch(e){return""}}function x(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function C(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const r=e[t];try{I(r)?n.push("[VueViewModel]"):n.push(String(r))}catch(e){n.push("[value cannot be serialized]")}}return n.join(t)}function D(e,t,n=!1){return!!g(e)&&(f(t,"RegExp")?t.test(e):!!g(t)&&(n?e===t:e.includes(t)))}function N(e,t=[],n=!1){return t.some((t=>D(e,t,n)))}function O(e,t,n){if(!(t in e))return;const r=e[t],i=n(r);"function"==typeof i&&M(i,r),e[t]=i}function R(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch(n){r&&l.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function M(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,R(e,"__sentry_original__",t)}catch(e){}}function P(e){return e.__sentry_original__}function L(e){if(d(e))return{message:e.message,name:e.name,stack:e.stack,...F(e)};if(w(e)){const t={type:e.type,target:U(e.target),currentTarget:U(e.currentTarget),...F(e)};return"undefined"!=typeof CustomEvent&&E(e,CustomEvent)&&(t.detail=e.detail),t}return e}function U(e){try{return t=e,"undefined"!=typeof Element&&E(t,Element)?T(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}var t}function F(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function B(e){return V(e,new Map)}function V(e,t){if(function(e){if(!_(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||"Object"===t}catch(e){return!0}}(e)){const n=t.get(e);if(void 0!==n)return n;const r={};t.set(e,r);for(const n of Object.keys(e))void 0!==e[n]&&(r[n]=V(e[n],t));return r}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const r=[];return t.set(e,r),e.forEach((e=>{r.push(V(e,t))})),r}return e}function j(){const e=s,t=e.crypto||e.msCrypto;let n=()=>16*Math.random();try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{const e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(e){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function $(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function G(e){const{message:t,event_id:n}=e;if(t)return t;const r=$(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function q(e,t,n){const r=e.exception=e.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=t||""),s.type||(s.type=n||"Error")}function z(e,t){const n=$(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r&&r.data,...t.data};n.mechanism.data=e}}function H(e){if(e&&e.__sentry_captured__)return!0;try{R(e,"__sentry_captured__",!0)}catch(e){}return!1}const K="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,W=[];function Q(e,t){for(const n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function Y(e,t,n){if(n[t.name])K&&l.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===W.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),W.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,r)=>n(t,r,e)))}if("function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign(((t,r)=>n(t,r,e)),{id:t.name});e.addEventProcessor(r)}K&&l.log(`Integration installed: ${t.name}`)}}const J=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler"],X=(e={})=>({name:"InboundFilters",processEvent(t,n,r){const i=r.getOptions(),s=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:J],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(e,i);return function(e,t){if(t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e))return K&&l.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${G(e)}`),!0;if(function(e,t){if(e.type||!t||!t.length)return!1;return function(e){const t=[];e.message&&t.push(e.message);let n;try{n=e.exception.values[e.exception.values.length-1]}catch(e){}n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`));return t}(e).some((e=>N(e,t)))}(e,t.ignoreErrors))return K&&l.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${G(e)}`),!0;if(function(e){if(e.type)return!1;if(!e.exception||!e.exception.values||0===e.exception.values.length)return!1;return!e.message&&!e.exception.values.some((e=>e.stacktrace||e.type&&"Error"!==e.type||e.value))}(e))return K&&l.warn(`Event dropped due to not having an error message, error type or stacktrace.\nEvent: ${G(e)}`),!0;if(function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&N(n,t)}(e,t.ignoreTransactions))return K&&l.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${G(e)}`),!0;if(function(e,t){if(!t||!t.length)return!1;const n=Z(e);return!!n&&N(n,t)}(e,t.denyUrls))return K&&l.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${G(e)}.\nUrl: ${Z(e)}`),!0;if(!function(e,t){if(!t||!t.length)return!0;const n=Z(e);return!n||N(n,t)}(e,t.allowUrls))return K&&l.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${G(e)}.\nUrl: ${Z(e)}`),!0;return!1}(t,s)?null:t}});function Z(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(t){return K&&l.error(`Cannot extract url for event ${G(e)}`),null}}function ee(){return te(s),s}function te(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||i,t[i]=t[i]||{}}function ne(){return{traceId:j(),spanId:j().substring(16)}}function re(){return Date.now()/1e3}const ie=function(){const{performance:e}=s;if(!e||!e.now)return re;const t=Date.now()-e.now(),n=null==e.timeOrigin?t:e.timeOrigin;return()=>(n+e.now())/1e3}();let se;const oe=(()=>{const{performance:e}=s;if(!e||!e.now)return void(se="none");const t=36e5,n=e.now(),r=Date.now(),i=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,o=i<t,a=e.timing&&e.timing.navigationStart,c="number"==typeof a?Math.abs(a+n-r):t;return o||c<t?i<=c?(se="timeOrigin",e.timeOrigin):(se="navigationStart",a):(se="dateNow",r)})();function ae(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||ie(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:j()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}const ce="_sentrySpan";function ue(e,t){t?R(e,ce,t):delete e[ce]}function le(e){return e[ce]}class he{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=ne()}clone(){const e=new he;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,ue(e,le(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&ae(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e,[n,r]=t instanceof de?[t.getScopeData(),t.getRequestSession()]:_(t)?[e,e.requestSession]:[],{tags:i,extra:s,user:o,contexts:a,level:c,fingerprint:u=[],propagationContext:l}=n||{};return this._tags={...this._tags,...i},this._extra={...this._extra,...s},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),r&&(this._requestSession=r),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,ue(this,void 0),this._attachments=[],this._propagationContext=ne(),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:re(),...e},i=this._breadcrumbs;return i.push(r),this._breadcrumbs=i.length>n?i.slice(-n):i,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:le(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t&&t.event_id?t.event_id:j();if(!this._client)return l.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=n&&n.event_id?n.event_id:j();if(!this._client)return l.warn("No client configured on scope - will not capture message!"),r;const i=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:i,...n,event_id:r},this),r}captureEvent(e,t){const n=t&&t.event_id?t.event_id:j();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(l.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}const de=he;class fe{constructor(e,t){let n,r;n=e||new de,r=t||new de,this._stack=[{scope:n}],this._isolationScope=r}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(e){throw this._popScope(),e}return b(n)?n.then((e=>(this._popScope(),e)),(e=>{throw this._popScope(),e})):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function pe(){const e=te(ee());return e.stack=e.stack||new fe(o("defaultCurrentScope",(()=>new de)),o("defaultIsolationScope",(()=>new de)))}function me(e){return pe().withScope(e)}function ge(e,t){const n=pe();return n.withScope((()=>(n.getStackTop().scope=e,t(e))))}function ye(e){return pe().withScope((()=>e(pe().getIsolationScope())))}function ve(e){const t=te(e);return t.acs?t.acs:{withIsolationScope:ye,withScope:me,withSetScope:ge,withSetIsolationScope:(e,t)=>ye(t),getCurrentScope:()=>pe().getScope(),getIsolationScope:()=>pe().getIsolationScope()}}function _e(){return ve(ee()).getCurrentScope()}function we(){return ve(ee()).getIsolationScope()}function be(){return _e().getClient()}let Ee;const Ie=new WeakMap,Se=()=>({name:"FunctionToString",setupOnce(){Ee=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=P(this),n=Ie.has(be())&&void 0!==t?t:this;return Ee.apply(n,e)}}catch(e){}},setup(e){Ie.set(e,!0)}}),Te="?",ke=/\(error: (.*)\)/,Ae=/captureMessage|captureException/;function xe(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0,r=0)=>{const i=[],s=e.split("\n");for(let e=n;e<s.length;e++){const n=s[e];if(n.length>1024)continue;const o=ke.test(n)?n.replace(ke,"$1"):n;if(!o.match(/\S*Error: /)){for(const e of t){const t=e(o);if(t){i.push(t);break}}if(i.length>=50+r)break}}return function(e){if(!e.length)return[];const t=Array.from(e);/sentryWrapped/.test(Ce(t).function||"")&&t.pop();t.reverse(),Ae.test(Ce(t).function||"")&&(t.pop(),Ae.test(Ce(t).function||"")&&t.pop());return t.slice(0,50).map((e=>({...e,filename:e.filename||Ce(t).filename,function:e.function||Te})))}(i.slice(r))}}function Ce(e){return e[e.length-1]||{}}const De="<anonymous>";function Ne(e){try{return e&&"function"==typeof e&&e.name||De}catch(e){return De}}function Oe(e){const t=e.exception;if(t){const e=[];try{return t.values.forEach((t=>{t.stacktrace.frames&&e.push(...t.stacktrace.frames)})),e}catch(e){return}}}const Re=()=>{let e;return{name:"Dedupe",processEvent(t){if(t.type)return t;try{if(function(e,t){if(!t)return!1;if(function(e,t){const n=e.message,r=t.message;if(!n&&!r)return!1;if(n&&!r||!n&&r)return!1;if(n!==r)return!1;if(!Pe(e,t))return!1;if(!Me(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){const n=Le(t),r=Le(e);if(!n||!r)return!1;if(n.type!==r.type||n.value!==r.value)return!1;if(!Pe(e,t))return!1;if(!Me(e,t))return!1;return!0}(e,t))return!0;return!1}(t,e))return K&&l.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){}return e=t}}};function Me(e,t){let n=Oe(e),r=Oe(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],i=n[e];if(t.filename!==i.filename||t.lineno!==i.lineno||t.colno!==i.colno||t.function!==i.function)return!1}return!0}function Pe(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(e){return!1}}function Le(e){return e.exception&&e.exception.values&&e.exception.values[0]}const Ue={},Fe={};function Be(e,t){Ue[e]=Ue[e]||[],Ue[e].push(t)}function Ve(e,t){Fe[e]||(t(),Fe[e]=!0)}function je(e,t){const n=e&&Ue[e];if(n)for(const i of n)try{i(t)}catch(t){r&&l.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Ne(i)}\nError:`,t)}}const $e=s;let Ge,qe,ze;function He(e){Be("dom",e),Ve("dom",Ke)}function Ke(){if(!$e.document)return;const e=je.bind(null,"dom"),t=We(e,!0);$e.document.addEventListener("click",t,!1),$e.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach((t=>{const n=$e[t]&&$e[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(O(n,"addEventListener",(function(t){return function(n,r,i){if("click"===n||"keypress"==n)try{const r=this,s=r.__sentry_instrumentation_handlers__=r.__sentry_instrumentation_handlers__||{},o=s[n]=s[n]||{refCount:0};if(!o.handler){const r=We(e);o.handler=r,t.call(this,n,r,i)}o.refCount++}catch(e){}return t.call(this,n,r,i)}})),O(n,"removeEventListener",(function(e){return function(t,n,r){if("click"===t||"keypress"==t)try{const n=this,i=n.__sentry_instrumentation_handlers__||{},s=i[t];s&&(s.refCount--,s.refCount<=0&&(e.call(this,t,s.handler,r),s.handler=void 0,delete i[t]),0===Object.keys(i).length&&delete n.__sentry_instrumentation_handlers__)}catch(e){}return e.call(this,t,n,r)}})))}))}function We(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(e){try{return e.target}catch(e){return null}}(n);if(function(e,t){return"keypress"===e&&(!t||!t.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(n.type,r))return;R(n,"_sentryCaptured",!0),r&&!r._sentryId&&R(r,"_sentryId",j());const i="keypress"===n.type?"input":n.type;if(!function(e){if(e.type!==qe)return!1;try{if(!e.target||e.target._sentryId!==ze)return!1}catch(e){}return!0}(n)){e({event:n,name:i,global:t}),qe=n.type,ze=r?r._sentryId:void 0}clearTimeout(Ge),Ge=$e.setTimeout((()=>{ze=void 0,qe=void 0}),1e3)}}const Qe="__sentry_xhr_v3__";function Ye(){if(!$e.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(e,t,n){const r=1e3*ie(),i=g(n[0])?n[0].toUpperCase():void 0,s=function(e){if(g(e))return e;try{return e.toString()}catch(e){}return}(n[1]);if(!i||!s)return e.apply(t,n);t[Qe]={method:i,url:s,request_headers:{}},"POST"===i&&s.match(/sentry_key/)&&(t.__sentry_own_request__=!0);const o=()=>{const e=t[Qe];if(e&&4===t.readyState){try{e.status_code=t.status}catch(e){}je("xhr",{endTimestamp:1e3*ie(),startTimestamp:r,xhr:t})}};return"onreadystatechange"in t&&"function"==typeof t.onreadystatechange?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply:(e,t,n)=>(o(),e.apply(t,n))}):t.addEventListener("readystatechange",o),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(e,t,n){const[r,i]=n,s=t[Qe];return s&&g(r)&&g(i)&&(s.request_headers[r.toLowerCase()]=i),e.apply(t,n)}}),e.apply(t,n)}}),e.send=new Proxy(e.send,{apply(e,t,n){const r=t[Qe];if(!r)return e.apply(t,n);void 0!==n[0]&&(r.body=n[0]);return je("xhr",{startTimestamp:1e3*ie(),xhr:t}),e.apply(t,n)}})}const Je=s;let Xe;function Ze(e){const t="history";Be(t,e),Ve(t,et)}function et(){if(!function(){const e=Je.chrome,t=e&&e.app&&e.app.runtime,n="history"in Je&&!!Je.history.pushState&&!!Je.history.replaceState;return!t&&n}())return;const e=$e.onpopstate;function t(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const e=Xe,t=String(n);Xe=t;je("history",{from:e,to:t})}return e.apply(this,t)}}$e.onpopstate=function(...t){const n=$e.location.href,r=Xe;Xe=n;if(je("history",{from:r,to:n}),e)try{return e.apply(this,t)}catch(e){}},O($e.history,"pushState",t),O($e.history,"replaceState",t)}const tt=100;function nt(e,t){const n=be(),r=we();if(!n)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:s=tt}=n.getOptions();if(s<=0)return;const o={timestamp:re(),...e},a=i?u((()=>i(o,t))):o;null!==a&&(n.emit&&n.emit("beforeAddBreadcrumb",a,t),r.addBreadcrumb(a,s))}function rt(){"console"in s&&a.forEach((function(e){e in s.console&&O(s.console,e,(function(t){return c[e]=t,function(...t){je("console",{args:t,level:e});const n=c[e];n&&n.apply(s.console,t)}}))}))}const it=s;function st(){if(!("fetch"in it))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function ot(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function at(e,t=!1){t&&!function(){if("string"==typeof EdgeRuntime)return!0;if(!st())return!1;if(ot(it.fetch))return!0;let e=!1;const t=it.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=ot(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){r&&l.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e}()||O(s,"fetch",(function(t){return function(...n){const{method:r,url:i}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:ut(t),method:ct(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:ut(t),method:ct(t,"method")?String(t.method).toUpperCase():"GET"}}(n),o={args:n,fetchData:{method:r,url:i},startTimestamp:1e3*ie()};e||je("fetch",{...o});const a=(new Error).stack;return t.apply(s,n).then((async t=>(e?e(t):je("fetch",{...o,endTimestamp:1e3*ie(),response:t}),t)),(e=>{throw je("fetch",{...o,endTimestamp:1e3*ie(),error:e}),d(e)&&void 0===e.stack&&(e.stack=a,R(e,"framesToPop",1)),e}))}}))}function ct(e,t){return!!e&&"object"==typeof e&&!!e[t]}function ut(e){return"string"==typeof e?e:e?ct(e,"url")?e.url:e.toString?e.toString():"":""}const lt=["fatal","error","warning","log","info","debug"];function ht(e){return"warn"===e?"warning":lt.includes(e)?e:"log"}function dt(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}const ft="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function pt(e,t=100,n=1/0){try{return gt("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function mt(e,t=3,n=102400){const r=pt(e,t);return i=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(i))>n?mt(e,t-1,n):r;var i}function gt(e,t,n=1/0,r=1/0,i=function(){const e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){const[s,o]=i;if(null==t||["number","boolean","string"].includes(typeof t)&&!Number.isNaN(t))return t;const a=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(I(t))return"[VueViewModel]";if(_(n=t)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof t&&t!=t)return"[NaN]";if("function"==typeof t)return`[Function: ${Ne(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return a.replace("object ","");if(s(t))return"[Circular ~]";const u=t;if(u&&"function"==typeof u.toJSON)try{return gt("",u.toJSON(),c-1,r,i)}catch(e){}const l=Array.isArray(t)?[]:{};let h=0;const d=L(t);for(const e in d){if(!Object.prototype.hasOwnProperty.call(d,e))continue;if(h>=r){l[e]="[MaxProperties ~]";break}const t=d[e];l[e]=gt(e,t,c-1,r,i),h++}return o(t),l}const yt="production";var vt;function _t(e){return new bt((t=>{t(e)}))}function wt(e){return new bt(((t,n)=>{n(e)}))}!function(e){e[e.PENDING=0]="PENDING";e[e.RESOLVED=1]="RESOLVED";e[e.REJECTED=2]="REJECTED"}(vt||(vt={}));class bt{constructor(e){bt.prototype.__init.call(this),bt.prototype.__init2.call(this),bt.prototype.__init3.call(this),bt.prototype.__init4.call(this),this._state=vt.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new bt(((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new bt(((t,n)=>{let r,i;return this.then((t=>{i=!1,r=t,e&&e()}),(t=>{i=!0,r=t,e&&e()})).then((()=>{i?n(r):t(r)}))}))}__init(){this._resolve=e=>{this._setResult(vt.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(vt.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===vt.PENDING&&(b(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===vt.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===vt.RESOLVED&&e[1](this._value),this._state===vt.REJECTED&&e[2](this._value),e[0]=!0)}))}}}function Et(e,t,n,r=0){return new bt(((i,s)=>{const o=e[r];if(null===t||"function"!=typeof o)i(t);else{const a=o({...t},n);K&&o.id&&null===a&&l.log(`Event processor "${o.id}" dropped event`),b(a)?a.then((t=>Et(e,t,n,r+1).then(i))).then(null,s):Et(e,a,n,r+1).then(i).then(null,s)}}))}const It=/^sentry-/;function St(e){const t=function(e){if(!e||!g(e)&&!Array.isArray(e))return;if(Array.isArray(e))return e.reduce(((e,t)=>{const n=Tt(t);return Object.entries(n).forEach((([t,n])=>{e[t]=n})),e}),{});return Tt(e)}(e);if(!t)return;const n=Object.entries(t).reduce(((e,[t,n])=>{if(t.match(It)){e[t.slice(7)]=n}return e}),{});return Object.keys(n).length>0?n:void 0}function Tt(e){return e.split(",").map((e=>e.split("=").map((e=>decodeURIComponent(e.trim()))))).reduce(((e,[t,n])=>(t&&n&&(e[t]=n),e)),{})}const kt="sentry.source",At="_sentryMetrics";function xt(e){const t=e[At];if(!t)return;const n={};for(const[,[e,r]]of t){(n[e]||(n[e]=[])).push(B(r))}return n}function Ct(e){const{spanId:t,traceId:n}=e.spanContext(),{parent_span_id:r}=Ot(e);return B({parent_span_id:r,span_id:t,trace_id:n})}function Dt(e){return"number"==typeof e?Nt(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?Nt(e.getTime()):ie()}function Nt(e){return e>9999999999?e/1e3:e}function Ot(e){if(function(e){return"function"==typeof e.getSpanJSON}(e))return e.getSpanJSON();try{const{spanId:t,traceId:n}=e.spanContext();if(function(e){const t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}(e)){const{attributes:r,startTime:i,name:s,endTime:o,parentSpanId:a,status:c}=e;return B({span_id:t,trace_id:n,data:r,description:s,parent_span_id:a,start_timestamp:Dt(i),timestamp:Dt(o)||void 0,status:Mt(c),op:r["sentry.op"],origin:r["sentry.origin"],_metrics_summary:xt(e)})}return{span_id:t,trace_id:n}}catch(e){return{}}}function Rt(e){const{traceFlags:t}=e.spanContext();return 1===t}function Mt(e){if(e&&0!==e.code)return 1===e.code?"ok":e.message||"unknown_error"}const Pt="_sentryRootSpan";function Lt(e){return e[Pt]||e}function Ut(){const e=ve(ee());return e.getActiveSpan?e.getActiveSpan():le(_e())}const Ft="_frozenDsc";function Bt(e,t){const n=t.getOptions(),{publicKey:r}=t.getDsn()||{},i=B({environment:n.environment||yt,release:n.release,public_key:r,trace_id:e});return t.emit("createDsc",i),i}function Vt(e){const t=be();if(!t)return{};const n=Bt(Ot(e).trace_id||"",t),r=Lt(e),i=r[Ft];if(i)return i;const s=r.spanContext().traceState,o=s&&s.get("sentry.dsc"),a=o&&St(o);if(a)return a;const c=Ot(r),u=c.data||{},l=u["sentry.sample_rate"];null!=l&&(n.sample_rate=`${l}`);const h=u[kt],d=c.description;return"url"!==h&&d&&(n.transaction=d),n.sampled=String(Rt(r)),t.emit("createDsc",n,r),n}function jt(e,t){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:s}=t;!function(e,t){const{extra:n,tags:r,user:i,contexts:s,level:o,transactionName:a}=t,c=B(n);c&&Object.keys(c).length&&(e.extra={...c,...e.extra});const u=B(r);u&&Object.keys(u).length&&(e.tags={...u,...e.tags});const l=B(i);l&&Object.keys(l).length&&(e.user={...l,...e.user});const h=B(s);h&&Object.keys(h).length&&(e.contexts={...h,...e.contexts});o&&(e.level=o);a&&"transaction"!==e.type&&(e.transaction=a)}(e,t),r&&function(e,t){e.contexts={trace:Ct(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:Vt(t),...e.sdkProcessingMetadata};const n=Lt(t),r=Ot(n).description;r&&!e.transaction&&"transaction"===e.type&&(e.transaction=r)}(e,r),function(e,t){e.fingerprint=e.fingerprint?function(e){return Array.isArray(e)?e:[e]}(e.fingerprint):[],t&&(e.fingerprint=e.fingerprint.concat(t));e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,i),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,s)}function $t(e,t){const{extra:n,tags:r,user:i,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:h,propagationContext:d,transactionName:f,span:p}=t;Gt(e,"extra",n),Gt(e,"tags",r),Gt(e,"user",i),Gt(e,"contexts",s),Gt(e,"sdkProcessingMetadata",a),o&&(e.level=o),f&&(e.transactionName=f),p&&(e.span=p),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),l.length&&(e.eventProcessors=[...e.eventProcessors,...l]),h.length&&(e.attachments=[...e.attachments,...h]),e.propagationContext={...e.propagationContext,...d}}function Gt(e,t,n){if(n&&Object.keys(n).length){e[t]={...e[t]};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[t][r]=n[r])}}function qt(e,t,n,r,i,a){const{normalizeDepth:c=3,normalizeMaxBreadth:u=1e3}=e,l={...t,event_id:t.event_id||n.event_id||j(),timestamp:t.timestamp||re()},h=n.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:r,dist:i,maxValueLength:s=250}=t;"environment"in e||(e.environment="environment"in t?n:yt);void 0===e.release&&void 0!==r&&(e.release=r);void 0===e.dist&&void 0!==i&&(e.dist=i);e.message&&(e.message=x(e.message,s));const o=e.exception&&e.exception.values&&e.exception.values[0];o&&o.value&&(o.value=x(o.value,s));const a=e.request;a&&a.url&&(a.url=x(a.url,s))}(l,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(l,h),i&&i.emit("applyFrameMetadata",t),void 0===t.type&&function(e,t){const n=s._sentryDebugIds;if(!n)return;let r;const i=zt.get(t);i?r=i:(r=new Map,zt.set(t,r));const o=Object.entries(n).reduce(((e,[n,i])=>{let s;const o=r.get(n);o?s=o:(s=t(n),r.set(n,s));for(let t=s.length-1;t>=0;t--){const n=s[t];if(n.filename){e[n.filename]=i;break}}return e}),{});try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.filename&&(e.debug_id=o[e.filename])}))}))}catch(e){}}(l,e.stackParser);const d=function(e,t){if(!t)return e;const n=e?e.clone():new de;return n.update(t),n}(r,n.captureContext);n.mechanism&&z(l,n.mechanism);const f=i?i.getEventProcessors():[],p=o("globalScope",(()=>new de)).getScopeData();if(a){$t(p,a.getScopeData())}if(d){$t(p,d.getScopeData())}const m=[...n.attachments||[],...p.attachments];m.length&&(n.attachments=m),jt(l,p);return Et([...f,...p.eventProcessors],l,n).then((e=>(e&&function(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach((([e,t])=>{n.push({type:"sourcemap",code_file:e,debug_id:t})}))}(e),"number"==typeof c&&c>0?function(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:pt(e.data,t,n)}})))},...e.user&&{user:pt(e.user,t,n)},...e.contexts&&{contexts:pt(e.contexts,t,n)},...e.extra&&{extra:pt(e.extra,t,n)}};e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=pt(e.contexts.trace.data,t,n)));e.spans&&(r.spans=e.spans.map((e=>({...e,...e.data&&{data:pt(e.data,t,n)}}))));return r}(e,c,u):e)))}const zt=new WeakMap;function Ht(e){if(e)return function(e){return e instanceof de||"function"==typeof e}(e)||function(e){return Object.keys(e).some((e=>Kt.includes(e)))}(e)?{captureContext:e}:e}const Kt=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function Wt(e,t){return _e().captureException(e,Ht(t))}function Qt(e,t){return _e().captureEvent(e,t)}const Yt=s;let Jt=0;function Xt(){return Jt>0}function Zt(e,t={},n){if("function"!=typeof e)return e;try{const t=e.__sentry_wrapped__;if(t)return t;if(P(e))return e}catch(t){return e}const r=function(){const r=Array.prototype.slice.call(arguments);try{n&&"function"==typeof n&&n.apply(this,arguments);const i=r.map((e=>Zt(e,t)));return e.apply(this,i)}catch(e){throw Jt++,setTimeout((()=>{Jt--})),function(...e){const t=ve(ee());if(2===e.length){const[n,r]=e;return n?t.withSetScope(n,r):t.withScope(r)}t.withScope(e[0])}((n=>{n.addEventProcessor((e=>(t.mechanism&&(q(e,void 0,void 0),z(e,t.mechanism)),e.extra={...e.extra,arguments:r},e))),Wt(e)})),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}catch(e){}M(r,e),R(e,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:()=>e.name})}catch(e){}return r}const en=1024,tn=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:"Breadcrumbs",setup(e){var n;t.console&&function(e){const t="console";Be(t,e),Ve(t,rt)}(function(e){return function(t){if(be()!==e)return;const n={category:"console",data:{arguments:t.args,logger:"console"},level:ht(t.level),message:C(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;n.message=`Assertion failed: ${C(t.args.slice(1)," ")||"console.assert"}`,n.data.arguments=t.args.slice(1)}nt(n,{input:t.args,level:t.level})}}(e)),t.dom&&He(function(e,t){return function(n){if(be()!==e)return;let r,i,s="object"==typeof t?t.serializeAttribute:void 0,o="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;o&&o>en&&(ft&&l.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${o} was configured. Sentry will use 1024 instead.`),o=en),"string"==typeof s&&(s=[s]);try{const e=n.event,t=function(e){return!!e&&!!e.target}(e)?e.target:e;r=T(t,{keyAttrs:s,maxStringLength:o}),i=function(e){if(!S.HTMLElement)return null;let t=e;for(let e=0;e<5;e++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}(t)}catch(e){r="<unknown>"}if(0===r.length)return;const a={category:`ui.${n.name}`,message:r};i&&(a.data={"ui.component_name":i}),nt(a,{event:n.event,name:n.name,global:n.global})}}(e,t.dom)),t.xhr&&(n=function(e){return function(t){if(be()!==e)return;const{startTimestamp:n,endTimestamp:r}=t,i=t.xhr[Qe];if(!n||!r||!i)return;const{method:s,url:o,status_code:a,body:c}=i;nt({category:"xhr",data:{method:s,url:o,status_code:a},type:"http"},{xhr:t.xhr,input:c,startTimestamp:n,endTimestamp:r})}}(e),Be("xhr",n),Ve("xhr",Ye)),t.fetch&&function(e,t){const n="fetch";Be(n,e),Ve(n,(()=>at(void 0,t)))}(function(e){return function(t){if(be()!==e)return;const{startTimestamp:n,endTimestamp:r}=t;if(r&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.error){nt({category:"fetch",data:t.fetchData,level:"error",type:"http"},{data:t.error,input:t.args,startTimestamp:n,endTimestamp:r})}else{const e=t.response;nt({category:"fetch",data:{...t.fetchData,status_code:e&&e.status},type:"http"},{input:t.args,response:e,startTimestamp:n,endTimestamp:r})}}}(e)),t.history&&Ze(function(e){return function(t){if(be()!==e)return;let n=t.from,r=t.to;const i=dt(Yt.location.href);let s=n?dt(n):void 0;const o=dt(r);s&&s.path||(s=i),i.protocol===o.protocol&&i.host===o.host&&(r=o.relative),i.protocol===s.protocol&&i.host===s.host&&(n=s.relative),nt({category:"navigation",data:{from:n,to:r}})}}(e)),t.sentry&&e.on("beforeSendEvent",function(e){return function(t){be()===e&&nt({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:G(t)},{event:t})}}(e))}}};const nn=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],rn=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:"BrowserApiErrors",setupOnce(){t.setTimeout&&O(Yt,"setTimeout",sn),t.setInterval&&O(Yt,"setInterval",sn),t.requestAnimationFrame&&O(Yt,"requestAnimationFrame",on),t.XMLHttpRequest&&"XMLHttpRequest"in Yt&&O(XMLHttpRequest.prototype,"send",an);const e=t.eventTarget;if(e){(Array.isArray(e)?e:nn).forEach(cn)}}}};function sn(e){return function(...t){const n=t[0];return t[0]=Zt(n,{mechanism:{data:{function:Ne(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function on(e){return function(t){return e.apply(this,[Zt(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Ne(e)},handled:!1,type:"instrument"}})])}}function an(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((e=>{e in n&&"function"==typeof n[e]&&O(n,e,(function(t){const n={mechanism:{data:{function:e,handler:Ne(t)},handled:!1,type:"instrument"}},r=P(t);return r&&(n.mechanism.data.handler=Ne(r)),Zt(t,n)}))})),e.apply(this,t)}}function cn(e){const t=Yt,n=t[e]&&t[e].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(O(n,"addEventListener",(function(t){return function(n,r,i){try{"function"==typeof r.handleEvent&&(r.handleEvent=Zt(r.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Ne(r),target:e},handled:!1,type:"instrument"}}))}catch(e){}return t.apply(this,[n,Zt(r,{mechanism:{data:{function:"addEventListener",handler:Ne(r),target:e},handled:!1,type:"instrument"}}),i])}})),O(n,"removeEventListener",(function(e){return function(t,n,r){const i=n;try{const n=i&&i.__sentry_wrapped__;n&&e.call(this,t,n,r)}catch(e){}return e.call(this,t,i,r)}})))}let un=null;function ln(){un=s.onerror,s.onerror=function(e,t,n,r,i){return je("error",{column:r,error:i,line:n,msg:e,url:t}),!(!un||un.__SENTRY_LOADER__)&&un.apply(this,arguments)},s.onerror.__SENTRY_INSTRUMENTED__=!0}let hn=null;function dn(){hn=s.onunhandledrejection,s.onunhandledrejection=function(e){return je("unhandledrejection",e),!(hn&&!hn.__SENTRY_LOADER__)||hn.apply(this,arguments)},s.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function fn(e,t){const n=gn(e,t),r={type:t&&t.name,value:vn(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function pn(e,t,n,r){const i=be(),s=i&&i.getOptions().normalizeDepth,o=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}return}(t),a={__serialized__:mt(t,s)};if(o)return{exception:{values:[fn(e,o)]},extra:a};const c={exception:{values:[{type:w(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:bn(t,{isUnhandledRejection:r})}]},extra:a};if(n){const t=gn(e,n);t.length&&(c.exception.values[0].stacktrace={frames:t})}return c}function mn(e,t){return{exception:{values:[fn(e,t)]}}}function gn(e,t){const n=t.stacktrace||t.stack||"",r=function(e){if(e&&yn.test(e.message))return 1;return 0}(t),i=function(e){if("number"==typeof e.framesToPop)return e.framesToPop;return 0}(t);try{return e(n,r,i)}catch(e){}return[]}const yn=/Minified React error #\d+;/i;function vn(e){const t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function _n(e,t,n,r,i){let s;if(p(t)&&t.error){return mn(e,t.error)}if(m(t)||f(t,"DOMException")){const i=t;if("stack"in t)s=mn(e,t);else{const t=i.name||(m(i)?"DOMError":"DOMException"),o=i.message?`${t}: ${i.message}`:t;s=wn(e,o,n,r),q(s,o)}return"code"in i&&(s.tags={...s.tags,"DOMException.code":`${i.code}`}),s}if(d(t))return mn(e,t);if(_(t)||w(t)){return s=pn(e,t,n,i),z(s,{synthetic:!0}),s}return s=wn(e,t,n,r),q(s,`${t}`,void 0),z(s,{synthetic:!0}),s}function wn(e,t,n,r){const i={};if(r&&n){const r=gn(e,n);r.length&&(i.exception={values:[{value:t,stacktrace:{frames:r}}]})}if(y(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return i.logentry={message:e,params:n},i}return i.message=t,i}function bn(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(L(e));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=t)return x(r,t);for(let e=n.length;e>0;e--){const r=n.slice(0,e).join(", ");if(!(r.length>t))return e===n.length?r:x(r,t)}return""}(e),r=t?"promise rejection":"exception";if(p(e))return`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``;if(w(e)){return`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(e){}}(e)}\` (type=${e.type}) captured as ${r}`}return`Object captured as ${r} with keys: ${n}`}const En=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(e){t.onerror&&(!function(e){!function(e){const t="error";Be(t,e),Ve(t,ln)}((t=>{const{stackParser:n,attachStacktrace:r}=Sn();if(be()!==e||Xt())return;const{msg:i,url:s,line:o,column:a,error:c}=t,u=function(e,t,n,r){const i=e.exception=e.exception||{},s=i.values=i.values||[],o=s[0]=s[0]||{},a=o.stacktrace=o.stacktrace||{},c=a.frames=a.frames||[],u=isNaN(parseInt(r,10))?void 0:r,l=isNaN(parseInt(n,10))?void 0:n,h=g(t)&&t.length>0?t:A();0===c.length&&c.push({colno:u,filename:h,function:Te,in_app:!0,lineno:l});return e}(_n(n,c||i,void 0,r,!1),s,o,a);u.level="error",Qt(u,{originalException:c,mechanism:{handled:!1,type:"onerror"}})}))}(e),In("onerror")),t.onunhandledrejection&&(!function(e){!function(e){const t="unhandledrejection";Be(t,e),Ve(t,dn)}((t=>{const{stackParser:n,attachStacktrace:r}=Sn();if(be()!==e||Xt())return;const i=function(e){if(v(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch(e){}return e}(t),s=v(i)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(i)}`}]}}:_n(n,i,void 0,r,!0);s.level="error",Qt(s,{originalException:i,mechanism:{handled:!1,type:"onunhandledrejection"}})}))}(e),In("onunhandledrejection"))}}};function In(e){ft&&l.log(`Global Handler attached: ${e}`)}function Sn(){const e=be();return e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Tn=()=>({name:"HttpContext",preprocessEvent(e){if(!Yt.navigator&&!Yt.location&&!Yt.document)return;const t=e.request&&e.request.url||Yt.location&&Yt.location.href,{referrer:n}=Yt.document||{},{userAgent:r}=Yt.navigator||{},i={...e.request&&e.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...e.request,...t&&{url:t},headers:i};e.request=s}});function kn(e,t,n=250,r,i,s,o){if(!(s.exception&&s.exception.values&&o&&E(o.originalException,Error)))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;var c,u;a&&(s.exception.values=(c=An(e,t,i,o.originalException,r,s.exception.values,a,0),u=n,c.map((e=>(e.value&&(e.value=x(e.value,u)),e)))))}function An(e,t,n,r,i,s,o,a){if(s.length>=n+1)return s;let c=[...s];if(E(r[i],Error)){xn(o,a);const s=e(t,r[i]),u=c.length;Cn(s,i,u,a),c=An(e,t,n,r[i],i,[s,...c],s,u)}return Array.isArray(r.errors)&&r.errors.forEach(((r,s)=>{if(E(r,Error)){xn(o,a);const u=e(t,r),l=c.length;Cn(u,`errors[${s}]`,l,a),c=An(e,t,n,r,i,[u,...c],u,l)}})),c}function xn(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function Cn(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}const Dn=(e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:"LinkedErrors",preprocessEvent(e,r,i){const s=i.getOptions();kn(fn,s.stackParser,s.maxValueLength,n,t,e,r)}}};function Nn(e){return[X(),Se(),rn(),tn(),En(),Dn(),Re(),Tn()]}const On=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Rn(e,t=!1){const{host:n,path:r,pass:i,port:s,projectId:o,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r?`${r}/`:r}${o}`}function Mn(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function Pn(e){const t="string"==typeof e?function(e){const t=On.exec(e);if(!t)return void u((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,r,i="",s="",o="",a=""]=t.slice(1);let c="",l=a;const h=l.split("/");if(h.length>1&&(c=h.slice(0,-1).join("/"),l=h.pop()),l){const e=l.match(/^\d+/);e&&(l=e[0])}return Mn({host:s,pass:i,path:c,projectId:l,port:o,protocol:n,publicKey:r})}(e):Mn(e);if(t&&function(e){if(!r)return!0;const{port:t,projectId:n,protocol:i}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(l.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(i)?t&&isNaN(parseInt(t,10))&&(l.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(l.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),1):(l.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}function Ln(e,t=[]){return[e,t]}function Un(e,t){const[n,r]=e;return[n,[...r,t]]}function Fn(e,t){const n=e[1];for(const e of n){if(t(e,e[0].type))return!0}return!1}function Bn(e){return s.__SENTRY__&&s.__SENTRY__.encodePolyfill?s.__SENTRY__.encodePolyfill(e):(new TextEncoder).encode(e)}function Vn(e){const[t,n]=e;let r=JSON.stringify(t);function i(e){"string"==typeof r?r="string"==typeof e?r+e:[Bn(r),e]:r.push("string"==typeof e?Bn(e):e)}for(const e of n){const[t,n]=e;if(i(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)i(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify(pt(n))}i(e)}}return"string"==typeof r?r:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(r)}function jn(e){const t="string"==typeof e.data?Bn(e.data):e.data;return[B({type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),t]}const $n={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function Gn(e){return $n[e]}function qn(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function zn(e,t,n,r){const i=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:Rn(r)},...i&&{trace:B({...i})}}}class Hn extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}function Kn(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function Wn(e,t){return n={sentry_key:e.publicKey,sentry_version:"7",...t&&{sentry_client:`${t.name}/${t.version}`}},Object.keys(n).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(n[e])}`)).join("&");var n}function Qn(e,t,n){return t||`${function(e){return`${Kn(e)}${e.projectId}/envelope/`}(e)}?${Wn(e,n)}`}function Yn(e){if("boolean"==typeof e)return Number(e);const t="string"==typeof e?parseFloat(e):e;if(!("number"!=typeof t||isNaN(t)||t<0||t>1))return t;K&&l.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`)}const Jn="Not capturing exception because it's already been captured.";class Xn{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Pn(e.dsn):K&&l.warn("No DSN provided, client will not send events."),this._dsn){const t=Qn(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){const r=j();if(H(e))return K&&l.log(Jn),r;const i={event_id:r,...t};return this._process(this.eventFromException(e,i).then((e=>this._captureEvent(e,i,n)))),i.event_id}captureMessage(e,t,n,r){const i={event_id:j(),...n},s=y(e)?e:String(e),o=v(e)?this.eventFromMessage(s,t,i):this.eventFromException(e,i);return this._process(o.then((e=>this._captureEvent(e,i,r)))),i.event_id}captureEvent(e,t,n){const r=j();if(t&&t.originalException&&H(t.originalException))return K&&l.log(Jn),r;const i={event_id:r,...t},s=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,i,s||n)),i.event_id}captureSession(e){"string"!=typeof e.release?K&&l.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),ae(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e))))):_t(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,this.emit("close"),e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some((({name:e})=>e.startsWith("Spotlight"))))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];Y(this,e,this._integrations),t||Q(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=function(e,t,n,r){const i=qn(n),s=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n&&n.sdk);const o=zn(e,i,r,t);return delete e.sdkProcessingMetadata,Ln(o,[[{type:s},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=Un(n,jn(e));const r=this.sendEnvelope(n);r&&r.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const t=function(e,t,n,r){const i=qn(n);return Ln({sent_at:(new Date).toISOString(),...i&&{sdk:i},...!!r&&t&&{dsn:Rn(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const r="number"==typeof n?n:1,i=`${e}:${t}`;K&&l.log(`Recording outcome: "${i}"${r>1?` (${r} times)`:""}`),this._outcomes[i]=(this._outcomes[i]||0)+r}}on(e,t){const n=this._hooks[e]=this._hooks[e]||[];return n.push(t),()=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)}}emit(e,...t){const n=this._hooks[e];n&&n.forEach((e=>e(...t)))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,(e=>(K&&l.error("Error while sending event:",e),e))):(K&&l.error("Transport disabled"),_t({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach((t=>{t&&Y(e,t,n)})),n}(this,e),Q(this,e)}_updateSessionFromEvent(e,t){let n=!1,r=!1;const i=t.exception&&t.exception.values;if(i){r=!0;for(const e of i){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const s="ok"===e.status;(s&&0===e.errors||s&&n)&&(ae(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new bt((t=>{let n=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,r=we()){const i=this.getOptions(),s=Object.keys(this._integrations);return!t.integrations&&s.length>0&&(t.integrations=s),this.emit("preprocessEvent",e,t),e.type||r.setLastEventId(e.event_id||t.event_id),qt(i,e,t,n,this,r).then((e=>{if(null===e)return e;const t={...r.getPropagationContext(),...n?n.getPropagationContext():void 0};if(!(e.contexts&&e.contexts.trace)&&t){const{traceId:n,spanId:r,parentSpanId:i,dsc:s}=t;e.contexts={trace:B({trace_id:n,span_id:r,parent_span_id:i}),...e.contexts};const o=s||Bt(n,this);e.sdkProcessingMetadata={dynamicSamplingContext:o,...e.sdkProcessingMetadata}}return e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{if(K){const t=e;"log"===t.logLevel?l.log(t.message):l.warn(t)}}))}_processEvent(e,t,n){const r=this.getOptions(),{sampleRate:i}=r,s=er(e),o=Zn(e),a=e.type||"error",c=`before send for type \`${a}\``,u=void 0===i?void 0:Yn(i);if(o&&"number"==typeof u&&Math.random()>u)return this.recordDroppedEvent("sample_rate","error",e),wt(new Hn(`Discarding event because it's not included in the random sample (sampling rate = ${i})`,"log"));const l="replay_event"===a?"replay":a,h=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,h).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",l,e),new Hn("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;const i=function(e,t,n,r){const{beforeSend:i,beforeSendTransaction:s,beforeSendSpan:o}=t;if(Zn(n)&&i)return i(n,r);if(er(n)){if(n.spans&&o){const t=[];for(const r of n.spans){const n=o(r);n?t.push(n):e.recordDroppedEvent("before_send","span")}n.spans=t}if(s){if(n.spans){const e=n.spans.length;n.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:e}}return s(n,r)}}return n}(this,r,n,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(b(e))return e.then((e=>{if(!_(e)&&null!==e)throw new Hn(n);return e}),(e=>{throw new Hn(`${t} rejected with ${e}`)}));if(!_(e)&&null!==e)throw new Hn(n);return e}(i,c)})).then((r=>{if(null===r){if(this.recordDroppedEvent("before_send",l,e),s){const t=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",t)}throw new Hn(`${c} returned \`null\`, will not send event.`,"log")}const i=n&&n.getSession();if(!s&&i&&this._updateSessionFromEvent(i,r),s){const e=(r.sdkProcessingMetadata&&r.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(r.spans?r.spans.length:0);e>0&&this.recordDroppedEvent("before_send","span",e)}const o=r.transaction_info;if(s&&o&&r.transaction!==e.transaction){const e="custom";r.transaction_info={...o,source:e}}return this.sendEvent(r,t),r})).then(null,(e=>{if(e instanceof Hn)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new Hn(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map((([e,t])=>{const[n,r]=e.split(":");return{reason:n,category:r,quantity:t}}))}_flushOutcomes(){K&&l.log("Flushing outcomes...");const e=this._clearOutcomes();if(0===e.length)return void(K&&l.log("No outcomes to send"));if(!this._dsn)return void(K&&l.log("No dsn provided, will not send outcomes"));K&&l.log("Sending outcomes:",e);const t=(n=e,Ln((r=this._options.tunnel&&Rn(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:i||re(),discarded_events:n}]]));var n,r,i;this.sendEnvelope(t)}}function Zn(e){return void 0===e.type}function er(e){return"transaction"===e.type}const tr="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,nr={};function rr(e){const t=nr[e];if(t)return t;let n=$e[e];if(ot(n))return nr[e]=n.bind($e);const r=$e.document;if(r&&"function"==typeof r.createElement)try{const t=r.createElement("iframe");t.hidden=!0,r.head.appendChild(t);const i=t.contentWindow;i&&i[e]&&(n=i[e]),r.head.removeChild(t)}catch(t){tr&&l.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,t)}return n?nr[e]=n.bind($e):n}function ir(e){nr[e]=void 0}function sr(...e){return rr("setTimeout")(...e)}function or(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]||Promise.resolve(void 0)}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return wt(new Hn("Not adding Promise because buffer limit was reached."));const i=r();return-1===t.indexOf(i)&&t.push(i),i.then((()=>n(i))).then(null,(()=>n(i).then(null,(()=>{})))),i},drain:function(e){return new bt(((n,r)=>{let i=t.length;if(!i)return n(!0);const s=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{_t(e).then((()=>{--i||(clearTimeout(s),n(!0))}),r)}))}))}}}function ar(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}function cr(e,{statusCode:t,headers:n},r=Date.now()){const i={...e},s=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(s)for(const e of s.trim().split(",")){const[t,n,,,s]=e.split(":",5),o=parseInt(t,10),a=1e3*(isNaN(o)?60:o);if(n)for(const e of n.split(";"))"metric_bucket"===e&&s&&!s.split(";").includes("custom")||(i[e]=r+a);else i.all=r+a}else o?i.all=r+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?6e4:r-t}(o,r):429===t&&(i.all=r+6e4);return i}function ur(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}function lr(e,t,n,r){const i={filename:e,function:"<anonymous>"===t?Te:t,in_app:!0};return void 0!==n&&(i.lineno=n),void 0!==r&&(i.colno=r),i}const hr=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,dr=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,fr=/\((\S*)(?::(\d+))(?::(\d+))\)/,pr=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,mr=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,gr=xe(...[[30,e=>{const t=hr.exec(e);if(t){const[,e,n,r]=t;return lr(e,Te,+n,+r)}const n=dr.exec(e);if(n){if(n[2]&&0===n[2].indexOf("eval")){const e=fr.exec(n[2]);e&&(n[2]=e[1],n[3]=e[2],n[4]=e[3])}const[e,t]=yr(n[1]||Te,n[2]);return lr(t,e,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}}],[50,e=>{const t=pr.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=mr.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||Te;return[n,e]=yr(n,e),lr(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]]),yr=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:Te,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};function vr(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(t=n,n=s(n)):"call"!==i&&"optionalCall"!==i||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}function _r(e,t){const n=t&&t.getDsn(),r=t&&t.getOptions().tunnel;return function(e,t){return!!t&&e.includes(t.host)}(e,n)||function(e,t){if(!t)return!1;return wr(e)===wr(t)}(e,r)}function wr(e){return"/"===e[e.length-1]?e.slice(0,-1):e}function br(){return!("undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&__SENTRY_BROWSER_BUNDLE__)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function Er(){return"undefined"!=typeof window&&(!br()||void 0!==s.process&&"renderer"===s.process.type)}const Ir=(e,t,n,r)=>{let i,s;return o=>{t.value>=0&&(o||r)&&(s=t.value-(i||0),(s||void 0===i)&&(i=t.value,t.delta=s,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,n),e(t)))}},Sr=()=>$e.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],Tr=()=>{const e=Sr();return e&&e.activationStart||0},kr=(e,t)=>{const n=Sr();let r="navigate";n&&($e.document&&$e.document.prerendering||Tr()>0?r="prerender":$e.document&&$e.document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-")));return{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:`v3-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},Ar=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver((e=>{Promise.resolve().then((()=>{t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},xr=e=>{const t=t=>{("pagehide"===t.type||$e.document&&"hidden"===$e.document.visibilityState)&&e(t)};$e.document&&(addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0))},Cr=e=>{let t=!1;return n=>{t||(e(n),t=!0)}};let Dr=-1;const Nr=e=>{"hidden"===$e.document.visibilityState&&Dr>-1&&(Dr="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("visibilitychange",Nr,!0),removeEventListener("prerenderingchange",Nr,!0))},Or=()=>($e.document&&Dr<0&&(Dr="hidden"!==$e.document.visibilityState||$e.document.prerendering?1/0:0,addEventListener("visibilitychange",Nr,!0),addEventListener("prerenderingchange",Nr,!0)),{get firstHiddenTime(){return Dr}}),Rr=e=>{$e.document&&$e.document.prerendering?addEventListener("prerenderingchange",(()=>e()),!0):e()},Mr=[1800,3e3],Pr=[.1,.25],Lr=(e,t={})=>{((e,t={})=>{Rr((()=>{const n=Or(),r=kr("FCP");let i;const s=Ar("paint",(e=>{e.forEach((e=>{"first-contentful-paint"===e.name&&(s.disconnect(),e.startTime<n.firstHiddenTime&&(r.value=Math.max(e.startTime-Tr(),0),r.entries.push(e),i(!0)))}))}));s&&(i=Ir(e,r,Mr,t.reportAllChanges))}))})(Cr((()=>{const n=kr("CLS",0);let r,i=0,s=[];const o=e=>{e.forEach((e=>{if(!e.hadRecentInput){const t=s[0],n=s[s.length-1];i&&t&&n&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,s.push(e)):(i=e.value,s=[e])}})),i>n.value&&(n.value=i,n.entries=s,r())},a=Ar("layout-shift",o);a&&(r=Ir(e,n,Pr,t.reportAllChanges),xr((()=>{o(a.takeRecords()),r(!0)})),setTimeout(r,0))})))},Ur=[100,300];let Fr=0,Br=1/0,Vr=0;const jr=e=>{e.forEach((e=>{e.interactionId&&(Br=Math.min(Br,e.interactionId),Vr=Math.max(Vr,e.interactionId),Fr=Vr?(Vr-Br)/7+1:0)}))};let $r;const Gr=()=>{"interactionCount"in performance||$r||($r=Ar("event",jr,{type:"event",buffered:!0,durationThreshold:0}))},qr=[200,500],zr=()=>($r?Fr:performance.interactionCount||0)-0,Hr=[],Kr={},Wr=e=>{const t=Hr[Hr.length-1],n=Kr[e.interactionId];if(n||Hr.length<10||t&&e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{const t={id:e.interactionId,latency:e.duration,entries:[e]};Kr[t.id]=t,Hr.push(t)}Hr.sort(((e,t)=>t.latency-e.latency)),Hr.splice(10).forEach((e=>{delete Kr[e.id]}))}},Qr=(e,t={})=>{Rr((()=>{Gr();const n=kr("INP");let r;const i=e=>{e.forEach((e=>{if(e.interactionId&&Wr(e),"first-input"===e.entryType){!Hr.some((t=>t.entries.some((t=>e.duration===t.duration&&e.startTime===t.startTime))))&&Wr(e)}}));const t=(()=>{const e=Math.min(Hr.length-1,Math.floor(zr()/50));return Hr[e]})();t&&t.latency!==n.value&&(n.value=t.latency,n.entries=t.entries,r())},s=Ar("event",i,{durationThreshold:null!=t.durationThreshold?t.durationThreshold:40});r=Ir(e,n,qr,t.reportAllChanges),s&&("PerformanceEventTiming"in $e&&"interactionId"in PerformanceEventTiming.prototype&&s.observe({type:"first-input",buffered:!0}),xr((()=>{i(s.takeRecords()),n.value<0&&zr()>0&&(n.value=0,n.entries=[]),r(!0)})))}))},Yr=[2500,4e3],Jr={},Xr={},Zr={};let ei,ti,ni,ri;function ii(e,t){return hi(e,t),Zr[e]||(!function(e){const t={};"event"===e&&(t.durationThreshold=0);Ar(e,(t=>{si(e,{entries:t})}),t)}(e),Zr[e]=!0),di(e,t)}function si(e,t){const n=Xr[e];if(n&&n.length)for(const r of n)try{r(t)}catch(t){tr&&l.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Ne(r)}\nError:`,t)}}function oi(){return Lr((e=>{si("cls",{metric:e}),ei=e}),{reportAllChanges:!0})}function ai(){return((e,t={})=>{Rr((()=>{const n=Or(),r=kr("FID");let i;const s=e=>{e.startTime<n.firstHiddenTime&&(r.value=e.processingStart-e.startTime,r.entries.push(e),i(!0))},o=e=>{e.forEach(s)},a=Ar("first-input",o);i=Ir(e,r,Ur,t.reportAllChanges),a&&xr(Cr((()=>{o(a.takeRecords()),a.disconnect()})))}))})((e=>{si("fid",{metric:e}),ti=e}))}function ci(){return((e,t={})=>{Rr((()=>{const n=Or(),r=kr("LCP");let i;const s=e=>{const t=e[e.length-1];t&&t.startTime<n.firstHiddenTime&&(r.value=Math.max(t.startTime-Tr(),0),r.entries=[t],i())},o=Ar("largest-contentful-paint",s);if(o){i=Ir(e,r,Yr,t.reportAllChanges);const n=Cr((()=>{Jr[r.id]||(s(o.takeRecords()),o.disconnect(),Jr[r.id]=!0,i(!0))}));["keydown","click"].forEach((e=>{$e.document&&addEventListener(e,(()=>setTimeout(n,0)),!0)})),xr(n)}}))})((e=>{si("lcp",{metric:e}),ni=e}),{reportAllChanges:!0})}function ui(){return Qr((e=>{si("inp",{metric:e}),ri=e}))}function li(e,t,n,r,i=!1){let s;return hi(e,t),Zr[e]||(s=n(),Zr[e]=!0),r&&t({metric:r}),di(e,t,i?s:void 0)}function hi(e,t){Xr[e]=Xr[e]||[],Xr[e].push(t)}function di(e,t,n){return()=>{n&&n();const r=Xr[e];if(!r)return;const i=r.indexOf(t);-1!==i&&r.splice(i,1)}}const fi=s,pi="sentryReplaySession",mi="Unable to send Replay",gi=15e4,yi=5e3,vi=2e7,_i=36e5;function wi(e,t){return null!=e?e:t()}function bi(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(t=n,n=s(n)):"call"!==i&&"optionalCall"!==i||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}var Ei;function Ii(e){const t=bi([e,"optionalAccess",e=>e.host]);return Boolean(bi([t,"optionalAccess",e=>e.shadowRoot])===e)}function Si(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function Ti(e){try{const n=e.rules||e.cssRules;return n?((t=Array.from(n,ki).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t):null}catch(e){return null}var t}function ki(e){let t;if(function(e){return"styleSheet"in e}(e))try{t=Ti(e.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(e){}else if(function(e){return"selectorText"in e}(e)&&e.selectorText.includes(":"))return function(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}(e.cssText);return t||e.cssText}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(Ei||(Ei={}));class Ai{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){if(!e)return-1;return wi(bi([this,"access",e=>e.getMeta,"call",t=>t(e),"optionalAccess",e=>e.id]),(()=>-1))}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e)))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function xi({maskInputOptions:e,tagName:t,type:n}){return"OPTION"===t&&(t="SELECT"),Boolean(e[t.toLowerCase()]||n&&e[n]||"password"===n||"INPUT"===t&&!n&&e.text)}function Ci({isMasked:e,element:t,value:n,maskInputFn:r}){let i=n||"";return e?(r&&(i=r(i,t)),"*".repeat(i.length)):i}function Di(e){return e.toLowerCase()}function Ni(e){return e.toUpperCase()}const Oi="__rrweb_original__";function Ri(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?Di(t):null}function Mi(e,t,n){return"INPUT"!==t||"radio"!==n&&"checkbox"!==n?e.value:e.getAttribute("value")||""}function Pi(e,t){let n;try{n=new URL(e,wi(t,(()=>window.location.href)))}catch(e){return null}return wi(bi([n.pathname.match(/\.([0-9a-z]+)(?:$)/i),"optionalAccess",e=>e[1]]),(()=>null))}const Li={};function Ui(e){const t=Li[e];if(t)return t;const n=window.document;let r=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const i=t.contentWindow;i&&i[e]&&(r=i[e]),n.head.removeChild(t)}catch(e){}return Li[e]=r.bind(window)}function Fi(...e){return Ui("setTimeout")(...e)}function Bi(...e){return Ui("clearTimeout")(...e)}let Vi=1;const ji=new RegExp("[^a-z0-9-_:]");function $i(){return Vi++}let Gi,qi;const zi=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Hi=/^(?:[a-z+]+:)?\/\//i,Ki=/^www\..*/i,Wi=/^(data:)([^,]*),(.*)/i;function Qi(e,t){return(e||"").replace(zi,((e,n,r,i,s,o)=>{const a=r||s||o,c=n||i||"";if(!a)return e;if(Hi.test(a)||Ki.test(a))return`url(${c}${a}${c})`;if(Wi.test(a))return`url(${c}${a}${c})`;if("/"===a[0])return`url(${c}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+a}${c})`;const u=t.split("/"),l=a.split("/");u.pop();for(const e of l)"."!==e&&(".."===e?u.pop():u.push(e));return`url(${c}${u.join("/")}${c})`}))}const Yi=/^[^ \t\n\r\u000c]+/,Ji=/^[, \t\n\r\u000c]+/;function Xi(e,t){if(!t||""===t.trim())return t;const n=e.createElement("a");return n.href=t,n.href}function Zi(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function es(){const e=document.createElement("a");return e.href="",e.href}function ts(e,t,n,r,i,s){return r?"src"===n||"href"===n&&("use"!==t||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?Xi(e,r):"background"!==n||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n?function(e,t){if(""===t.trim())return t;let n=0;function r(e){let r;const i=e.exec(t.substring(n));return i?(r=i[0],n+=r.length,r):""}const i=[];for(;r(Ji),!(n>=t.length);){let s=r(Yi);if(","===s.slice(-1))s=Xi(e,s.substring(0,s.length-1)),i.push(s);else{let r="";s=Xi(e,s);let o=!1;for(;;){const e=t.charAt(n);if(""===e){i.push((s+r).trim());break}if(o)")"===e&&(o=!1);else{if(","===e){n+=1,i.push((s+r).trim());break}"("===e&&(o=!0)}r+=e,n+=1}}}return i.join(", ")}(e,r):"style"===n?Qi(r,es()):"object"===t&&"data"===n?Xi(e,r):"function"==typeof s?s(n,r,i):r:Xi(e,r):r}function ns(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function rs(e,t,n=1/0,r=0){return e?e.nodeType!==e.ELEMENT_NODE||r>n?-1:t(e)?r:rs(e.parentNode,t,n,r+1):-1}function is(e,t){return n=>{const r=n;if(null===r)return!1;try{if(e)if("string"==typeof e){if(r.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!1}(r,e))return!0;return!(!t||!r.matches(t))}catch(e){return!1}}}function ss(e,t,n,r,i,s){try{const o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===o)return!1;if("INPUT"===o.tagName){const e=o.getAttribute("autocomplete");if(["current-password","new-password","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc"].includes(e))return!0}let a=-1,c=-1;if(s){if(c=rs(o,is(r,i)),c<0)return!0;a=rs(o,is(t,n),c>=0?c:1/0)}else{if(a=rs(o,is(t,n)),a<0)return!1;c=rs(o,is(r,i),a>=0?a:1/0)}return a>=0?!(c>=0)||a<=c:!(c>=0)&&!!s}catch(e){}return!!s}function os(e,t){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskAttributeFn:c,maskTextClass:u,unmaskTextClass:l,maskTextSelector:h,unmaskTextSelector:d,inlineStylesheet:f,maskInputOptions:p={},maskTextFn:m,maskInputFn:g,dataURLOptions:y={},inlineImages:v,recordCanvas:_,keepIframeSrcFn:w,newlyAddedElement:b=!1}=t,E=function(e,t){if(!t.hasNode(e))return;const n=t.getId(e);return 1===n?void 0:n}(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:Ei.Document,childNodes:[],compatMode:e.compatMode}:{type:Ei.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:Ei.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:E};case e.ELEMENT_NODE:return function(e,t){const{doc:n,blockClass:r,blockSelector:i,unblockSelector:s,inlineStylesheet:o,maskInputOptions:a={},maskAttributeFn:c,maskInputFn:u,dataURLOptions:l={},inlineImages:h,recordCanvas:d,keepIframeSrcFn:f,newlyAddedElement:p=!1,rootId:m,maskAllText:g,maskTextClass:y,unmaskTextClass:v,maskTextSelector:_,unmaskTextSelector:w}=t,b=function(e,t,n,r){try{if(r&&e.matches(r))return!1;if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}if(n)return e.matches(n)}catch(e){}return!1}(e,r,i,s),E=function(e){if(e instanceof HTMLFormElement)return"form";const t=Di(e.tagName);return ji.test(t)?"div":t}(e);let I={};const S=e.attributes.length;for(let t=0;t<S;t++){const r=e.attributes[t];r.name&&!ns(E,r.name,r.value)&&(I[r.name]=ts(n,E,Di(r.name),r.value,e,c))}if("link"===E&&o){const t=Array.from(n.styleSheets).find((t=>t.href===e.href));let r=null;t&&(r=Ti(t)),r&&(delete I.rel,delete I.href,I._cssText=Qi(r,t.href))}if("style"===E&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const t=Ti(e.sheet);t&&(I._cssText=Qi(t,es()))}if("input"===E||"textarea"===E||"select"===E||"option"===E){const t=e,n=Ri(t),r=Mi(t,Ni(E),n),i=t.checked;if("submit"!==n&&"button"!==n&&r){const e=ss(t,y,_,v,w,xi({type:n,tagName:Ni(E),maskInputOptions:a}));I.value=Ci({isMasked:e,element:t,value:r,maskInputFn:u})}i&&(I.checked=i)}"option"===E&&(e.selected&&!a.select?I.selected=!0:delete I.selected);if("canvas"===E&&d)if("2d"===e.__context)(function(e){const t=e.getContext("2d");if(!t)return!0;for(let n=0;n<e.width;n+=50)for(let r=0;r<e.height;r+=50){const i=t.getImageData,s=Oi in i?i[Oi]:i;if(new Uint32Array(s.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some((e=>0!==e)))return!1}return!0})(e)||(I.rr_dataURL=e.toDataURL(l.type,l.quality));else if(!("__context"in e)){const t=e.toDataURL(l.type,l.quality),n=document.createElement("canvas");n.width=e.width,n.height=e.height;t!==n.toDataURL(l.type,l.quality)&&(I.rr_dataURL=t)}if("img"===E&&h){Gi||(Gi=n.createElement("canvas"),qi=Gi.getContext("2d"));const t=e,r=t.crossOrigin;t.crossOrigin="anonymous";const i=()=>{t.removeEventListener("load",i);try{Gi.width=t.naturalWidth,Gi.height=t.naturalHeight,qi.drawImage(t,0,0),I.rr_dataURL=Gi.toDataURL(l.type,l.quality)}catch(e){console.warn(`Cannot inline img src=${t.currentSrc}! Error: ${e}`)}r?I.crossOrigin=r:t.removeAttribute("crossorigin")};t.complete&&0!==t.naturalWidth?i():t.addEventListener("load",i)}"audio"!==E&&"video"!==E||(I.rr_mediaState=e.paused?"paused":"played",I.rr_mediaCurrentTime=e.currentTime);p||(e.scrollLeft&&(I.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(I.rr_scrollTop=e.scrollTop));if(b){const{width:t,height:n}=e.getBoundingClientRect();I={class:I.class,rr_width:`${t}px`,rr_height:`${n}px`}}"iframe"!==E||f(I.src)||(b||e.contentDocument||(I.rr_src=I.src),delete I.src);let T;try{customElements.get(E)&&(T=!0)}catch(e){}return{type:Ei.Element,tagName:E,attributes:I,childNodes:[],isSVG:Zi(e)||void 0,needBlock:b,rootId:m,isCustom:T}}(e,{doc:n,blockClass:i,blockSelector:s,unblockSelector:o,inlineStylesheet:f,maskAttributeFn:c,maskInputOptions:p,maskInputFn:g,dataURLOptions:y,inlineImages:v,recordCanvas:_,keepIframeSrcFn:w,newlyAddedElement:b,rootId:E,maskAllText:a,maskTextClass:u,unmaskTextClass:l,maskTextSelector:h,unmaskTextSelector:d});case e.TEXT_NODE:return function(e,t){const{maskAllText:n,maskTextClass:r,unmaskTextClass:i,maskTextSelector:s,unmaskTextSelector:o,maskTextFn:a,maskInputOptions:c,maskInputFn:u,rootId:l}=t,h=e.parentNode&&e.parentNode.tagName;let d=e.textContent;const f="STYLE"===h||void 0,p="SCRIPT"===h||void 0,m="TEXTAREA"===h||void 0;if(f&&d){try{e.nextSibling||e.previousSibling||bi([e,"access",e=>e.parentNode,"access",e=>e.sheet,"optionalAccess",e=>e.cssRules])&&(d=Ti(e.parentNode.sheet))}catch(t){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${t}`,e)}d=Qi(d,es())}p&&(d="SCRIPT_PLACEHOLDER");const g=ss(e,r,s,i,o,n);f||p||m||!d||!g||(d=a?a(d,e.parentElement):d.replace(/[\S]/g,"*"));m&&d&&(c.textarea||g)&&(d=u?u(d,e.parentNode):d.replace(/[\S]/g,"*"));if("OPTION"===h&&d){d=Ci({isMasked:ss(e,r,s,i,o,xi({type:null,tagName:h,maskInputOptions:c})),element:e,value:d,maskInputFn:u})}return{type:Ei.Text,textContent:d||"",isStyle:f,rootId:l}}(e,{maskAllText:a,maskTextClass:u,unmaskTextClass:l,maskTextSelector:h,unmaskTextSelector:d,maskTextFn:m,maskInputOptions:p,maskInputFn:g,rootId:E});case e.CDATA_SECTION_NODE:return{type:Ei.CDATA,textContent:"",rootId:E};case e.COMMENT_NODE:return{type:Ei.Comment,textContent:e.textContent||"",rootId:E};default:return!1}}function as(e){return null==e?"":e.toLowerCase()}function cs(e,t){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:h,skipChild:d=!1,inlineStylesheet:f=!0,maskInputOptions:p={},maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:v,dataURLOptions:_={},inlineImages:w=!1,recordCanvas:b=!1,onSerialize:E,onIframeLoad:I,iframeLoadTimeout:S=5e3,onStylesheetLoad:T,stylesheetLoadTimeout:k=5e3,keepIframeSrcFn:A=()=>!1,newlyAddedElement:x=!1}=t;let{preserveWhiteSpace:C=!0}=t;const D=os(e,{doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:h,inlineStylesheet:f,maskInputOptions:p,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,dataURLOptions:_,inlineImages:w,recordCanvas:b,keepIframeSrcFn:A,newlyAddedElement:x});if(!D)return console.warn(e,"not serialized"),null;let N;N=r.hasNode(e)?r.getId(e):!function(e,t){if(t.comment&&e.type===Ei.Comment)return!0;if(e.type===Ei.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&"js"===Pi(e.attributes.href)))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(as(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===as(e.attributes.name)||"icon"===as(e.attributes.rel)||"apple-touch-icon"===as(e.attributes.rel)||"shortcut icon"===as(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&as(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(as(e.attributes.property).match(/^(og|twitter|fb):/)||as(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===as(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===as(e.attributes.name)||"googlebot"===as(e.attributes.name)||"bingbot"===as(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===as(e.attributes.name)||"generator"===as(e.attributes.name)||"framework"===as(e.attributes.name)||"publisher"===as(e.attributes.name)||"progid"===as(e.attributes.name)||as(e.attributes.property).match(/^article:/)||as(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===as(e.attributes.name)||"yandex-verification"===as(e.attributes.name)||"csrf-token"===as(e.attributes.name)||"p:domain_verify"===as(e.attributes.name)||"verify-v1"===as(e.attributes.name)||"verification"===as(e.attributes.name)||"shopify-checkout-api-token"===as(e.attributes.name)))return!0}}return!1}(D,v)&&(C||D.type!==Ei.Text||D.isStyle||D.textContent.replace(/^\s+|\s+$/gm,"").length)?$i():-2;const O=Object.assign(D,{id:N});if(r.add(e,O),-2===N)return null;E&&E(e);let R=!d;if(O.type===Ei.Element){R=R&&!O.needBlock,delete O.needBlock;const t=e.shadowRoot;t&&Si(t)&&(O.isShadowHost=!0)}if((O.type===Ei.Document||O.type===Ei.Element)&&R){v.headWhitespace&&O.type===Ei.Element&&"head"===O.tagName&&(C=!1);const t={doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:h,skipChild:d,inlineStylesheet:f,maskInputOptions:p,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:v,dataURLOptions:_,inlineImages:w,recordCanvas:b,preserveWhiteSpace:C,onSerialize:E,onIframeLoad:I,iframeLoadTimeout:S,onStylesheetLoad:T,stylesheetLoadTimeout:k,keepIframeSrcFn:A};for(const n of Array.from(e.childNodes)){const e=cs(n,t);e&&O.childNodes.push(e)}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(const n of Array.from(e.shadowRoot.childNodes)){const r=cs(n,t);r&&(Si(e.shadowRoot)&&(r.isShadow=!0),O.childNodes.push(r))}}return e.parentNode&&Ii(e.parentNode)&&Si(e.parentNode)&&(O.isShadow=!0),O.type===Ei.Element&&"iframe"===O.tagName&&function(e,t,n){const r=e.contentWindow;if(!r)return;let i,s=!1;try{i=r.document.readyState}catch(e){return}if("complete"!==i){const r=Fi((()=>{s||(t(),s=!0)}),n);return void e.addEventListener("load",(()=>{Bi(r),s=!0,t()}))}const o="about:blank";if(r.location.href!==o||e.src===o||""===e.src)return Fi(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,(()=>{const t=e.contentDocument;if(t&&I){const n=cs(t,{doc:t,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:h,skipChild:!1,inlineStylesheet:f,maskInputOptions:p,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:v,dataURLOptions:_,inlineImages:w,recordCanvas:b,preserveWhiteSpace:C,onSerialize:E,onIframeLoad:I,iframeLoadTimeout:S,onStylesheetLoad:T,stylesheetLoadTimeout:k,keepIframeSrcFn:A});n&&I(e,n)}}),S),O.type===Ei.Element&&"link"===O.tagName&&"string"==typeof O.attributes.rel&&("stylesheet"===O.attributes.rel||"preload"===O.attributes.rel&&"string"==typeof O.attributes.href&&"css"===Pi(O.attributes.href))&&function(e,t,n){let r,i=!1;try{r=e.sheet}catch(e){return}if(r)return;const s=Fi((()=>{i||(t(),i=!0)}),n);e.addEventListener("load",(()=>{Bi(s),i=!0,t()}))}(e,(()=>{if(T){const t=cs(e,{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:h,skipChild:!1,inlineStylesheet:f,maskInputOptions:p,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:v,dataURLOptions:_,inlineImages:w,recordCanvas:b,preserveWhiteSpace:C,onSerialize:E,onIframeLoad:I,iframeLoadTimeout:S,onStylesheetLoad:T,stylesheetLoadTimeout:k,keepIframeSrcFn:A});t&&T(e,t)}}),k),O}function us(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(t=n,n=s(n)):"call"!==i&&"optionalCall"!==i||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}function ls(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const hs="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let ds={map:{},getId:()=>(console.error(hs),-1),getNode:()=>(console.error(hs),null),removeNodeFromMap(){console.error(hs)},has:()=>(console.error(hs),!1),reset(){console.error(hs)}};function fs(e,t,n={}){let r=null,i=0;return function(...s){const o=Date.now();i||!1!==n.leading||(i=o);const a=t-(o-i),c=this;a<=0||a>t?(r&&(!function(...e){Rs("clearTimeout")(...e)}(r),r=null),i=o,e.apply(c,s)):r||!1===n.trailing||(r=Ms((()=>{i=!1===n.leading?0:Date.now(),r=null,e.apply(c,s)}),a))}}function ps(e,t,n,r,i=window){const s=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,r?n:{set(e){Ms((()=>{n.set.call(this,e)}),0),s&&s.set&&s.set.call(this,e)}}),()=>ps(e,t,s||{},!0)}function ms(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],i=n(r);return"function"==typeof i&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=i,()=>{e[t]=r}}catch(e){return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(ds=new Proxy(ds,{get:(e,t,n)=>("map"===t&&console.error(hs),Reflect.get(e,t,n))}));let gs=Date.now;function ys(e){const t=e.document;return{left:t.scrollingElement?t.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:us([t,"optionalAccess",e=>e.documentElement,"access",e=>e.scrollLeft])||us([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.parentElement,"optionalAccess",e=>e.scrollLeft])||us([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.scrollLeft])||0,top:t.scrollingElement?t.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:us([t,"optionalAccess",e=>e.documentElement,"access",e=>e.scrollTop])||us([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.parentElement,"optionalAccess",e=>e.scrollTop])||us([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.scrollTop])||0}}function vs(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function _s(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function ws(e){if(!e)return null;return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}function bs(e,t,n,r,i){if(!e)return!1;const s=ws(e);if(!s)return!1;const o=is(t,n);if(!i){const e=r&&s.matches(r);return o(s)&&!e}const a=rs(s,o);let c=-1;return!(a<0)&&(r&&(c=rs(s,is(null,r))),a>-1&&c<0||a<c)}function Es(e,t){return-2===t.getId(e)}function Is(e,t){if(Ii(e))return!1;const n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||Is(e.parentNode,t))}function Ss(e){return Boolean(e.changedTouches)}function Ts(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function ks(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function As(e){return Boolean(us([e,"optionalAccess",e=>e.shadowRoot]))}/[1-9][0-9]{12}/.test(Date.now().toString())||(gs=()=>(new Date).getTime());class xs{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){return t=this.styleIDMap.get(e),n=()=>-1,null!=t?t:n();var t,n}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function Cs(e){let t=null;return us([e,"access",e=>e.getRootNode,"optionalCall",e=>e(),"optionalAccess",e=>e.nodeType])===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(t=e.getRootNode().host),t}function Ds(e){const t=e.ownerDocument;if(!t)return!1;const n=function(e){let t,n=e;for(;t=Cs(n);)n=t;return n}(e);return t.contains(n)}function Ns(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||Ds(e))}const Os={};function Rs(e){const t=Os[e];if(t)return t;const n=window.document;let r=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const i=t.contentWindow;i&&i[e]&&(r=i[e]),n.head.removeChild(t)}catch(e){}return Os[e]=r.bind(window)}function Ms(...e){return Rs("setTimeout")(...e)}var Ps=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(Ps||{}),Ls=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(Ls||{}),Us=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(Us||{}),Fs=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(Fs||{});function Bs(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(t=n,n=s(n)):"call"!==i&&"optionalCall"!==i||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}function Vs(e){return"__ln"in e}class js{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=Bs([t,"optionalAccess",e=>e.next])||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&Vs(e.previousSibling)){const n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&Vs(e.nextSibling)&&e.nextSibling.__ln.previous){const n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const $s=(e,t)=>`${e}@${t}`;class Gs{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new Set,n=new js,r=e=>{let t=e,n=-2;for(;-2===n;)t=t&&t.nextSibling,n=t&&this.mirror.getId(t);return n},i=i=>{if(!i.parentNode||!Ns(i))return;const s=Ii(i.parentNode)?this.mirror.getId(Cs(i)):this.mirror.getId(i.parentNode),o=r(i);if(-1===s||-1===o)return n.addNode(i);const a=cs(i,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{Ts(e,this.mirror)&&!bs(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)&&this.iframeManager.addIframe(e),ks(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),As(i)&&this.shadowDomManager.addShadowRoot(i.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{bs(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(this.iframeManager.attachIframe(e,t),e.contentWindow&&this.canvasManager.addWindow(e.contentWindow),this.shadowDomManager.observeAttachShadow(e))},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});a&&(e.push({parentId:s,nextId:o,node:a}),t.add(a.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const e of this.movedSet)zs(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||i(e);for(const e of this.addedSet)Ks(this.droppedSet,e)||zs(this.removes,e,this.mirror)?Ks(this.movedSet,e)?i(e):this.droppedSet.add(e):i(e);let s=null;for(;n.length;){let e=null;if(s){const t=this.mirror.getId(s.value.parentNode),n=r(s.value);-1!==t&&-1!==n&&(e=s)}if(!e){let t=n.tail;for(;t;){const n=t;if(t=t.previous,n){const t=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==t){e=n;break}{const t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=t.parentNode.host;if(-1!==this.mirror.getId(r)){e=n;break}}}}}}if(!e){for(;n.head;)n.removeNode(n.head.value);break}s=e.previous,n.removeNode(e.value),i(e.value)}const o={texts:this.texts.map((e=>({id:this.mirror.getId(e.node),value:e.value}))).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),attributes:this.attributes.map((e=>{const{attributes:t}=e;if("string"==typeof t.style){const n=JSON.stringify(e.styleDiff),r=JSON.stringify(e._unchangedStyles);n.length<t.style.length&&(n+r).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}})).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),removes:this.removes,adds:e};(o.texts.length||o.attributes.length||o.removes.length||o.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(o))},this.processMutation=e=>{if(!Es(e.target,this.mirror))switch(e.type){case"characterData":{const t=e.target.textContent;bs(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||t===e.oldValue||this.texts.push({value:ss(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&t?this.maskTextFn?this.maskTextFn(t,ws(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let n=e.attributeName,r=e.target.getAttribute(n);if("value"===n){const n=Ri(t),i=t.tagName;r=Mi(t,i,n);const s=xi({maskInputOptions:this.maskInputOptions,tagName:i,type:n});r=Ci({isMasked:ss(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,s),element:t,value:r,maskInputFn:this.maskInputFn})}if(bs(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||r===e.oldValue)return;let i=this.attributeMap.get(e.target);if("IFRAME"===t.tagName&&"src"===n&&!this.keepIframeSrcFn(r)){if(t.contentDocument)return;n="rr_src"}if(i||(i={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(i),this.attributeMap.set(e.target,i)),"type"===n&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!ns(t.tagName,n)&&(i.attributes[n]=ts(this.doc,Di(t.tagName),Di(n),r,t,this.maskAttributeFn),"style"===n)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(e){this.unattachedDoc=this.doc}const n=this.unattachedDoc.createElement("span");e.oldValue&&n.setAttribute("style",e.oldValue);for(const e of Array.from(t.style)){const r=t.style.getPropertyValue(e),s=t.style.getPropertyPriority(e);r!==n.style.getPropertyValue(e)||s!==n.style.getPropertyPriority(e)?i.styleDiff[e]=""===s?r:[r,s]:i._unchangedStyles[e]=[r,s]}for(const e of Array.from(n.style))""===t.style.getPropertyValue(e)&&(i.styleDiff[e]=!1)}break}case"childList":if(bs(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach((t=>this.genAdds(t,e.target))),e.removedNodes.forEach((t=>{const n=this.mirror.getId(t),r=Ii(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);bs(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||Es(t,this.mirror)||!function(e,t){return-1!==t.getId(e)}(t,this.mirror)||(this.addedSet.has(t)?(qs(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||Is(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[$s(n,r)]?qs(this.movedSet,t):this.removes.push({parentId:r,id:n,isShadow:!(!Ii(e.target)||!Si(e.target))||void 0})),this.mapRemoves.push(t))}))}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!this.addedSet.has(e)&&!this.movedSet.has(e)){if(this.mirror.hasNode(e)){if(Es(e,this.mirror))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[$s(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);bs(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes.forEach((e=>this.genAdds(e))),As(e)&&e.shadowRoot.childNodes.forEach((t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)})))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((t=>{this[t]=e[t]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function qs(e,t){e.delete(t),t.childNodes.forEach((t=>qs(e,t)))}function zs(e,t,n){return 0!==e.length&&Hs(e,t,n)}function Hs(e,t,n){const{parentNode:r}=t;if(!r)return!1;const i=n.getId(r);return!!e.some((e=>e.id===i))||Hs(e,r,n)}function Ks(e,t){return 0!==e.size&&Ws(e,t)}function Ws(e,t){const{parentNode:n}=t;return!!n&&(!!e.has(n)||Ws(e,n))}let Qs;function Ys(e){Qs=e}function Js(){Qs=void 0}const Xs=e=>{if(!Qs)return e;return(...t)=>{try{return e(...t)}catch(e){if(Qs&&!0===Qs(e))return()=>{};throw e}}};function Zs(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(t=n,n=s(n)):"call"!==i&&"optionalCall"!==i||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}const eo=[];function to(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch(e){}return e&&e.target}function no(e,t){const n=new Gs;eo.push(n),n.init(e);let r=window.MutationObserver||window.__rrMutationObserver;const i=Zs([window,"optionalAccess",e=>e.Zone,"optionalAccess",e=>e.__symbol__,"optionalCall",e=>e("MutationObserver")]);i&&window[i]&&(r=window[i]);const s=new r(Xs((t=>{e.onMutation&&!1===e.onMutation(t)||n.processMutations.bind(n)(t)})));return s.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function ro({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){if(!1===o.mouseInteraction)return()=>{};const a=!0===o.mouseInteraction||void 0===o.mouseInteraction?{}:o.mouseInteraction,c=[];let u=null;return Object.keys(Us).filter((e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==a[e])).forEach((o=>{let a=Di(o);const l=(t=>o=>{const a=to(o);if(bs(a,r,i,s,!0))return;let c=null,l=t;if("pointerType"in o){switch(o.pointerType){case"mouse":c=Fs.Mouse;break;case"touch":c=Fs.Touch;break;case"pen":c=Fs.Pen}c===Fs.Touch?Us[t]===Us.MouseDown?l="TouchStart":Us[t]===Us.MouseUp&&(l="TouchEnd"):Fs.Pen}else Ss(o)&&(c=Fs.Touch);null!==c?(u=c,(l.startsWith("Touch")&&c===Fs.Touch||l.startsWith("Mouse")&&c===Fs.Mouse)&&(c=null)):Us[t]===Us.Click&&(c=u,u=null);const h=Ss(o)?o.changedTouches[0]:o;if(!h)return;const d=n.getId(a),{clientX:f,clientY:p}=h;Xs(e)({type:Us[l],id:d,x:f,y:p,...null!==c&&{pointerType:c}})})(o);if(window.PointerEvent)switch(Us[o]){case Us.MouseDown:case Us.MouseUp:a=a.replace("mouse","pointer");break;case Us.TouchStart:case Us.TouchEnd:return}c.push(ls(a,l,t))})),Xs((()=>{c.forEach((e=>e()))}))}function io({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){const a=Xs(fs(Xs((o=>{const a=to(o);if(!a||bs(a,r,i,s,!0))return;const c=n.getId(a);if(a===t&&t.defaultView){const n=ys(t.defaultView);e({id:c,x:n.left,y:n.top})}else e({id:c,x:a.scrollLeft,y:a.scrollTop})})),o.scroll||100));return ls("scroll",a,t)}const so=["INPUT","TEXTAREA","SELECT"],oo=new WeakMap;function ao({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,ignoreClass:o,ignoreSelector:a,maskInputOptions:c,maskInputFn:u,sampling:l,userTriggeredOnInput:h,maskTextClass:d,unmaskTextClass:f,maskTextSelector:p,unmaskTextSelector:m}){function g(e){let n=to(e);const l=e.isTrusted,g=n&&Ni(n.tagName);if("OPTION"===g&&(n=n.parentElement),!n||!g||so.indexOf(g)<0||bs(n,r,i,s,!0))return;const v=n;if(v.classList.contains(o)||a&&v.matches(a))return;const _=Ri(n);let w=Mi(v,g,_),b=!1;const E=xi({maskInputOptions:c,tagName:g,type:_}),I=ss(n,d,p,f,m,E);"radio"!==_&&"checkbox"!==_||(b=n.checked),w=Ci({isMasked:I,element:n,value:w,maskInputFn:u}),y(n,h?{text:w,isChecked:b,userTriggered:l}:{text:w,isChecked:b});const S=n.name;"radio"===_&&S&&b&&t.querySelectorAll(`input[type="radio"][name="${S}"]`).forEach((e=>{if(e!==n){const t=Ci({isMasked:I,element:e,value:Mi(e,g,_),maskInputFn:u});y(e,h?{text:t,isChecked:!b,userTriggered:!1}:{text:t,isChecked:!b})}}))}function y(t,r){const i=oo.get(t);if(!i||i.text!==r.text||i.isChecked!==r.isChecked){oo.set(t,r);const i=n.getId(t);Xs(e)({...r,id:i})}}const v=("last"===l.input?["change"]:["input","change"]).map((e=>ls(e,Xs(g),t))),_=t.defaultView;if(!_)return()=>{v.forEach((e=>e()))};const w=_.Object.getOwnPropertyDescriptor(_.HTMLInputElement.prototype,"value"),b=[[_.HTMLInputElement.prototype,"value"],[_.HTMLInputElement.prototype,"checked"],[_.HTMLSelectElement.prototype,"value"],[_.HTMLTextAreaElement.prototype,"value"],[_.HTMLSelectElement.prototype,"selectedIndex"],[_.HTMLOptionElement.prototype,"selected"]];return w&&w.set&&v.push(...b.map((e=>ps(e[0],e[1],{set(){Xs(g)({target:this,isTrusted:!1})}},!1,_)))),Xs((()=>{v.forEach((e=>e()))}))}function co(e){return function(e,t){if(fo("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||fo("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||fo("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||fo("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){const n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){const n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function uo(e,t,n){let r,i;return e?(e.ownerNode?r=t.getId(e.ownerNode):i=n.getId(e),{styleId:i,id:r}):{}}function lo({mirror:e,stylesheetManager:t},n){let r=null;r="#document"===n.nodeName?e.getId(n):e.getId(n.host);const i="#document"===n.nodeName?Zs([n,"access",e=>e.defaultView,"optionalAccess",e=>e.Document]):Zs([n,"access",e=>e.ownerDocument,"optionalAccess",e=>e.defaultView,"optionalAccess",e=>e.ShadowRoot]),s=Zs([i,"optionalAccess",e=>e.prototype])?Object.getOwnPropertyDescriptor(Zs([i,"optionalAccess",e=>e.prototype]),"adoptedStyleSheets"):void 0;return null!==r&&-1!==r&&i&&s?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get(){return Zs([s,"access",e=>e.get,"optionalAccess",e=>e.call,"call",e=>e(this)])},set(e){const n=Zs([s,"access",e=>e.set,"optionalAccess",e=>e.call,"call",t=>t(this,e)]);if(null!==r&&-1!==r)try{t.adoptStyleSheets(e,r)}catch(e){}return n}}),Xs((()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get:s.get,set:s.set})}))):()=>{}}function ho(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};let r;e.recordDOM&&(r=no(e,e.doc));const i=function({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(!1===t.mousemove)return()=>{};const i="number"==typeof t.mousemove?t.mousemove:50,s="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let o,a=[];const c=fs(Xs((t=>{const n=Date.now()-o;e(a.map((e=>(e.timeOffset-=n,e))),t),a=[],o=null})),s),u=Xs(fs(Xs((e=>{const t=to(e),{clientX:n,clientY:i}=Ss(e)?e.changedTouches[0]:e;o||(o=gs()),a.push({x:n,y:i,id:r.getId(t),timeOffset:gs()-o}),c("undefined"!=typeof DragEvent&&e instanceof DragEvent?Ls.Drag:e instanceof MouseEvent?Ls.MouseMove:Ls.TouchMove)})),i,{trailing:!1})),l=[ls("mousemove",u,n),ls("touchmove",u,n),ls("drag",u,n)];return Xs((()=>{l.forEach((e=>e()))}))}(e),s=ro(e),o=io(e),a=function({viewportResizeCb:e},{win:t}){let n=-1,r=-1;return ls("resize",Xs(fs(Xs((()=>{const t=vs(),i=_s();n===t&&r===i||(e({width:Number(i),height:Number(t)}),n=t,r=i)})),200)),t)}(e,{win:n}),c=ao(e),u=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,unblockSelector:r,mirror:i,sampling:s,doc:o}){const a=Xs((o=>fs(Xs((s=>{const a=to(s);if(!a||bs(a,t,n,r,!0))return;const{currentTime:c,volume:u,muted:l,playbackRate:h}=a;e({type:o,id:i.getId(a),currentTime:c,volume:u,muted:l,playbackRate:h})})),s.media||500))),c=[ls("play",a(0),o),ls("pause",a(1),o),ls("seeked",a(2),o),ls("volumechange",a(3),o),ls("ratechange",a(4),o)];return Xs((()=>{c.forEach((e=>e()))}))}(e);let l=()=>{},h=()=>{},d=()=>{},f=()=>{};e.recordDOM&&(l=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const i=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:Xs(((r,i,s)=>{const[o,a]=s,{id:c,styleId:u}=uo(i,t,n.styleMirror);return(c&&-1!==c||u&&-1!==u)&&e({id:c,styleId:u,adds:[{rule:o,index:a}]}),r.apply(i,s)}))});const s=r.CSSStyleSheet.prototype.deleteRule;let o,a;r.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:Xs(((r,i,s)=>{const[o]=s,{id:a,styleId:c}=uo(i,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:o}]}),r.apply(i,s)}))}),r.CSSStyleSheet.prototype.replace&&(o=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(o,{apply:Xs(((r,i,s)=>{const[o]=s,{id:a,styleId:c}=uo(i,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replace:o}),r.apply(i,s)}))})),r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:Xs(((r,i,s)=>{const[o]=s,{id:a,styleId:c}=uo(i,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replaceSync:o}),r.apply(i,s)}))}));const c={};po("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(po("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),po("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),po("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const u={};return Object.entries(c).forEach((([r,i])=>{u[r]={insertRule:i.prototype.insertRule,deleteRule:i.prototype.deleteRule},i.prototype.insertRule=new Proxy(u[r].insertRule,{apply:Xs(((r,i,s)=>{const[o,a]=s,{id:c,styleId:u}=uo(i.parentStyleSheet,t,n.styleMirror);return(c&&-1!==c||u&&-1!==u)&&e({id:c,styleId:u,adds:[{rule:o,index:[...co(i),a||0]}]}),r.apply(i,s)}))}),i.prototype.deleteRule=new Proxy(u[r].deleteRule,{apply:Xs(((r,i,s)=>{const[o]=s,{id:a,styleId:c}=uo(i.parentStyleSheet,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:[...co(i),o]}]}),r.apply(i,s)}))})})),Xs((()=>{r.CSSStyleSheet.prototype.insertRule=i,r.CSSStyleSheet.prototype.deleteRule=s,o&&(r.CSSStyleSheet.prototype.replace=o),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach((([e,t])=>{t.prototype.insertRule=u[e].insertRule,t.prototype.deleteRule=u[e].deleteRule}))}))}(e,{win:n}),h=lo(e,e.doc),d=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:i}){const s=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:Xs(((i,o,a)=>{const[c,u,l]=a;if(n.has(c))return s.apply(o,[c,u,l]);const{id:h,styleId:d}=uo(Zs([o,"access",e=>e.parentRule,"optionalAccess",e=>e.parentStyleSheet]),t,r.styleMirror);return(h&&-1!==h||d&&-1!==d)&&e({id:h,styleId:d,set:{property:c,value:u,priority:l},index:co(o.parentRule)}),i.apply(o,a)}))});const o=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:Xs(((i,s,a)=>{const[c]=a;if(n.has(c))return o.apply(s,[c]);const{id:u,styleId:l}=uo(Zs([s,"access",e=>e.parentRule,"optionalAccess",e=>e.parentStyleSheet]),t,r.styleMirror);return(u&&-1!==u||l&&-1!==l)&&e({id:u,styleId:l,remove:{property:c},index:co(s.parentRule)}),i.apply(s,a)}))}),Xs((()=>{i.CSSStyleDeclaration.prototype.setProperty=s,i.CSSStyleDeclaration.prototype.removeProperty=o}))}(e,{win:n}),e.collectFonts&&(f=function({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],i=new WeakMap,s=n.FontFace;n.FontFace=function(e,t,n){const r=new s(e,t,n);return i.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};const o=ms(t.fonts,"add",(function(t){return function(n){return Ms(Xs((()=>{const t=i.get(n);t&&(e(t),i.delete(n))})),0),t.apply(this,[n])}}));return r.push((()=>{n.FontFace=s})),r.push(o),Xs((()=>{r.forEach((e=>e()))}))}(e)));const p=function(e){const{doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,selectionCb:o}=e;let a=!0;const c=Xs((()=>{const e=t.getSelection();if(!e||a&&Zs([e,"optionalAccess",e=>e.isCollapsed]))return;a=e.isCollapsed||!1;const c=[],u=e.rangeCount||0;for(let t=0;t<u;t++){const o=e.getRangeAt(t),{startContainer:a,startOffset:u,endContainer:l,endOffset:h}=o;bs(a,r,i,s,!0)||bs(l,r,i,s,!0)||c.push({start:n.getId(a),startOffset:u,end:n.getId(l),endOffset:h})}o({ranges:c})}));return c(),ls("selectionchange",c)}(e),m=function({doc:e,customElementCb:t}){const n=e.defaultView;return n&&n.customElements?ms(n.customElements,"define",(function(e){return function(n,r,i){try{t({define:{name:n}})}catch(e){}return e.apply(this,[n,r,i])}})):()=>{}}(e),g=[];for(const t of e.plugins)g.push(t.observer(t.callback,n,t.options));return Xs((()=>{eo.forEach((e=>e.reset())),Zs([r,"optionalAccess",e=>e.disconnect,"call",e=>e()]),i(),s(),o(),a(),c(),u(),l(),h(),d(),f(),p(),m(),g.forEach((e=>e()))}))}function fo(e){return void 0!==window[e]}function po(e){return Boolean(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class mo{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,n,r){const i=n||this.getIdToRemoteIdMap(e),s=r||this.getRemoteIdToIdMap(e);let o=i.get(t);return o||(o=this.generateIdFn(),i.set(t,o),s.set(o,t)),o}getIds(e,t){const n=this.getIdToRemoteIdMap(e),r=this.getRemoteIdToIdMap(e);return t.map((t=>this.getId(e,t,n,r)))}getRemoteId(e,t,n){const r=n||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;const i=r.get(t);return i||-1}getRemoteIds(e,t){const n=this.getRemoteIdToIdMap(e);return t.map((t=>this.getRemoteId(e,t,n)))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}function go(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(t=n,n=s(n)):"call"!==i&&"optionalCall"!==i||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}class yo{constructor(){this.crossOriginIframeMirror=new mo($i),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class vo{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new mo($i),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new mo(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),go([this,"access",e=>e.loadListener,"optionalCall",t=>t(e)]),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const n=this.crossOriginIframeMap.get(e.source);if(!n)return;const r=this.transformCrossOriginEvent(n,t.data.event);r&&this.wrappedEmit(r,t.data.isCheckout)}transformCrossOriginEvent(e,t){switch(t.type){case Ps.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const n=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(t.data.node,n),{timestamp:t.timestamp,type:Ps.IncrementalSnapshot,data:{source:Ls.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case Ps.Meta:case Ps.Load:case Ps.DomContentLoaded:return!1;case Ps.Plugin:return t;case Ps.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case Ps.IncrementalSnapshot:switch(t.data.source){case Ls.Mutation:return t.data.adds.forEach((t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const n=this.crossOriginIframeRootIdMap.get(e);n&&this.patchRootIdOnNode(t.node,n)})),t.data.removes.forEach((t=>{this.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((t=>{this.replaceIds(t,e,["id"])})),t.data.texts.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case Ls.Drag:case Ls.TouchMove:case Ls.MouseMove:return t.data.positions.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case Ls.ViewportResize:return!1;case Ls.MediaInteraction:case Ls.MouseInteraction:case Ls.Scroll:case Ls.CanvasMutation:case Ls.Input:return this.replaceIds(t.data,e,["id"]),t;case Ls.StyleSheetRule:case Ls.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case Ls.Font:return t;case Ls.Selection:return t.data.ranges.forEach((t=>{this.replaceIds(t,e,["start","end"])})),t;case Ls.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),go([t,"access",e=>e.data,"access",e=>e.styles,"optionalAccess",e=>e.forEach,"call",t=>t((t=>{this.replaceStyleIds(t,e,["styleId"])}))]),t}}return!1}replace(e,t,n,r){for(const i of r)(Array.isArray(t[i])||"number"==typeof t[i])&&(Array.isArray(t[i])?t[i]=e.getIds(n,t[i]):t[i]=e.getId(n,t[i]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach((e=>{this.replaceIdOnNode(e,t)}))}patchRootIdOnNode(e,t){e.type===Ei.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach((e=>{this.patchRootIdOnNode(e,t)}))}}class _o{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class wo{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!Si(e))return;if(this.shadowDoms.has(e))return;this.shadowDoms.add(e),this.bypassOptions.canvasManager.addShadowRoot(e);const n=no({...this.bypassOptions,doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},e);this.restoreHandlers.push((()=>n.disconnect())),this.restoreHandlers.push(io({...this.bypassOptions,scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),Ms((()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(lo({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))}),0)}observeAttachShadow(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){const n=this;this.restoreHandlers.push(ms(e.prototype,"attachShadow",(function(e){return function(r){const i=e.call(this,r);return this.shadowRoot&&Ns(this)&&n.addShadowRoot(this.shadowRoot,t),i}})))}reset(){this.restoreHandlers.forEach((e=>{try{e()}catch(e){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet,this.bypassOptions.canvasManager.resetShadowRoots()}}class bo{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}snapshot(){}addWindow(){}addShadowRoot(){}resetShadowRoots(){}}class Eo{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new xs,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const n={id:t,styleIds:[]},r=[];for(const t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),r.push({styleId:e,rules:Array.from(t.rules||CSSRule,((e,t)=>({rule:ki(e),index:t})))})),n.styleIds.push(e)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class Io{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){!function(...e){Rs("requestAnimationFrame")(...e)}((()=>{this.clear(),this.loop&&this.periodicallyClear()}))}inOtherBuffer(e,t){const n=this.nodeMap.get(e);return n&&Array.from(n).some((e=>e!==t))}add(e,t){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}let So,To;try{if(2!==Array.from([1],(e=>2*e))[0]){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=vr([e,"access",e=>e.contentWindow,"optionalAccess",e=>e.Array,"access",e=>e.from])||Array.from,document.body.removeChild(e)}}catch(e){console.debug("Unable to override Array.from",e)}const ko=new Ai;function Ao(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:i="rr-block",blockSelector:s=null,unblockSelector:o=null,ignoreClass:a="rr-ignore",ignoreSelector:c=null,maskAllText:u=!1,maskTextClass:l="rr-mask",unmaskTextClass:h=null,maskTextSelector:d=null,unmaskTextSelector:f=null,inlineStylesheet:p=!0,maskAllInputs:m,maskInputOptions:g,slimDOMOptions:y,maskAttributeFn:v,maskInputFn:_,maskTextFn:w,maxCanvasSize:b=null,packFn:E,sampling:I={},dataURLOptions:S={},mousemoveWait:T,recordDOM:k=!0,recordCanvas:A=!1,recordCrossOriginIframes:x=!1,recordAfter:C=("DOMContentLoaded"===e.recordAfter?e.recordAfter:"load"),userTriggeredOnInput:D=!1,collectFonts:N=!1,inlineImages:O=!1,plugins:R,keepIframeSrcFn:M=()=>!1,ignoreCSSAttributes:P=new Set([]),errorHandler:L,onMutation:U,getCanvasManager:F}=e;Ys(L);const B=!x||window.parent===window;let V=!1;if(!B)try{window.parent.document&&(V=!1)}catch(e){V=!0}if(B&&!t)throw new Error("emit function is required");void 0!==T&&void 0===I.mousemove&&(I.mousemove=T),ko.reset();const j=!0===m?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:void 0!==g?g:{},$=!0===y||"all"===y?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===y,headMetaDescKeywords:"all"===y}:y||{};let G;!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let q=0;const z=e=>{for(const t of R||[])t.eventProcessor&&(e=t.eventProcessor(e));return E&&!V&&(e=E(e)),e};So=(e,i)=>{const s=e;if(s.timestamp=gs(),!vr([eo,"access",e=>e[0],"optionalAccess",e=>e.isFrozen,"call",e=>e()])||s.type===Ps.FullSnapshot||s.type===Ps.IncrementalSnapshot&&s.data.source===Ls.Mutation||eo.forEach((e=>e.unfreeze())),B)vr([t,"optionalCall",e=>e(z(s),i)]);else if(V){const e={type:"rrweb",event:z(s),origin:window.location.origin,isCheckout:i};window.parent.postMessage(e,"*")}if(s.type===Ps.FullSnapshot)G=s,q=0;else if(s.type===Ps.IncrementalSnapshot){if(s.data.source===Ls.Mutation&&s.data.isAttachIframe)return;q++;const e=r&&q>=r,t=n&&G&&s.timestamp-G.timestamp>n;(e||t)&&ee(!0)}};const H=e=>{So({type:Ps.IncrementalSnapshot,data:{source:Ls.Mutation,...e}})},K=e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.Scroll,...e}}),W=e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.CanvasMutation,...e}}),Q=new Eo({mutationCb:H,adoptedStyleSheetCb:e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.AdoptedStyleSheet,...e}})}),Y="boolean"==typeof __RRWEB_EXCLUDE_IFRAME__&&__RRWEB_EXCLUDE_IFRAME__?new yo:new vo({mirror:ko,mutationCb:H,stylesheetManager:Q,recordCrossOriginIframes:x,wrappedEmit:So});for(const e of R||[])e.getMirror&&e.getMirror({nodeMirror:ko,crossOriginIframeMirror:Y.crossOriginIframeMirror,crossOriginIframeStyleMirror:Y.crossOriginIframeStyleMirror});const J=new Io,X=function(e,t){try{return e?e(t):new bo}catch(e){return console.warn("Unable to initialize CanvasManager"),new bo}}(F,{mirror:ko,win:window,mutationCb:e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.CanvasMutation,...e}}),recordCanvas:A,blockClass:i,blockSelector:s,unblockSelector:o,maxCanvasSize:b,sampling:I.canvas,dataURLOptions:S,errorHandler:L}),Z="boolean"==typeof __RRWEB_EXCLUDE_SHADOW_DOM__&&__RRWEB_EXCLUDE_SHADOW_DOM__?new _o:new wo({mutationCb:H,scrollCb:K,bypassOptions:{onMutation:U,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:u,maskTextClass:l,unmaskTextClass:h,maskTextSelector:d,unmaskTextSelector:f,inlineStylesheet:p,maskInputOptions:j,dataURLOptions:S,maskAttributeFn:v,maskTextFn:w,maskInputFn:_,recordCanvas:A,inlineImages:O,sampling:I,slimDOMOptions:$,iframeManager:Y,stylesheetManager:Q,canvasManager:X,keepIframeSrcFn:M,processedNodeManager:J},mirror:ko}),ee=(e=!1)=>{if(!k)return;So({type:Ps.Meta,data:{href:window.location.href,width:_s(),height:vs()}},e),Q.reset(),Z.init(),eo.forEach((e=>e.lock()));const t=function(e,t){const{mirror:n=new Ai,blockClass:r="rr-block",blockSelector:i=null,unblockSelector:s=null,maskAllText:o=!1,maskTextClass:a="rr-mask",unmaskTextClass:c=null,maskTextSelector:u=null,unmaskTextSelector:l=null,inlineStylesheet:h=!0,inlineImages:d=!1,recordCanvas:f=!1,maskAllInputs:p=!1,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOM:v=!1,dataURLOptions:_,preserveWhiteSpace:w,onSerialize:b,onIframeLoad:E,iframeLoadTimeout:I,onStylesheetLoad:S,stylesheetLoadTimeout:T,keepIframeSrcFn:k=()=>!1}=t||{};return cs(e,{doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,maskAllText:o,maskTextClass:a,unmaskTextClass:c,maskTextSelector:u,unmaskTextSelector:l,skipChild:!1,inlineStylesheet:h,maskInputOptions:!0===p?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:!1===p?{}:p,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:!0===v||"all"===v?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===v,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===v?{}:v,dataURLOptions:_,inlineImages:d,recordCanvas:f,preserveWhiteSpace:w,onSerialize:b,onIframeLoad:E,iframeLoadTimeout:I,onStylesheetLoad:S,stylesheetLoadTimeout:T,keepIframeSrcFn:k,newlyAddedElement:!1})}(document,{mirror:ko,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:u,maskTextClass:l,unmaskTextClass:h,maskTextSelector:d,unmaskTextSelector:f,inlineStylesheet:p,maskAllInputs:j,maskAttributeFn:v,maskInputFn:_,maskTextFn:w,slimDOM:$,dataURLOptions:S,recordCanvas:A,inlineImages:O,onSerialize:e=>{Ts(e,ko)&&Y.addIframe(e),ks(e,ko)&&Q.trackLinkElement(e),As(e)&&Z.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{Y.attachIframe(e,t),e.contentWindow&&X.addWindow(e.contentWindow),Z.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{Q.attachLinkElement(e,t)},keepIframeSrcFn:M});if(!t)return console.warn("Failed to snapshot the document");So({type:Ps.FullSnapshot,data:{node:t,initialOffset:ys(window)}}),eo.forEach((e=>e.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&Q.adoptStyleSheets(document.adoptedStyleSheets,ko.getId(document))};To=ee;try{const e=[],t=e=>Xs(ho)({onMutation:U,mutationCb:H,mousemoveCb:(e,t)=>So({type:Ps.IncrementalSnapshot,data:{source:t,positions:e}}),mouseInteractionCb:e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.MouseInteraction,...e}}),scrollCb:K,viewportResizeCb:e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.ViewportResize,...e}}),inputCb:e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.Input,...e}}),mediaInteractionCb:e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.MediaInteraction,...e}}),styleSheetRuleCb:e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.StyleSheetRule,...e}}),styleDeclarationCb:e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.StyleDeclaration,...e}}),canvasMutationCb:W,fontCb:e=>So({type:Ps.IncrementalSnapshot,data:{source:Ls.Font,...e}}),selectionCb:e=>{So({type:Ps.IncrementalSnapshot,data:{source:Ls.Selection,...e}})},customElementCb:e=>{So({type:Ps.IncrementalSnapshot,data:{source:Ls.CustomElement,...e}})},blockClass:i,ignoreClass:a,ignoreSelector:c,maskAllText:u,maskTextClass:l,unmaskTextClass:h,maskTextSelector:d,unmaskTextSelector:f,maskInputOptions:j,inlineStylesheet:p,sampling:I,recordDOM:k,recordCanvas:A,inlineImages:O,userTriggeredOnInput:D,collectFonts:N,doc:e,maskAttributeFn:v,maskInputFn:_,maskTextFn:w,keepIframeSrcFn:M,blockSelector:s,unblockSelector:o,slimDOMOptions:$,dataURLOptions:S,mirror:ko,iframeManager:Y,stylesheetManager:Q,shadowDomManager:Z,processedNodeManager:J,canvasManager:X,ignoreCSSAttributes:P,plugins:vr([R,"optionalAccess",e=>e.filter,"call",e=>e((e=>e.observer)),"optionalAccess",e=>e.map,"call",e=>e((e=>({observer:e.observer,options:e.options,callback:t=>So({type:Ps.Plugin,data:{plugin:e.name,payload:t}})})))])||[]},{});Y.addLoadListener((n=>{try{e.push(t(n.contentDocument))}catch(e){console.warn(e)}}));const n=()=>{ee(),e.push(t(document))};return"interactive"===document.readyState||"complete"===document.readyState?n():(e.push(ls("DOMContentLoaded",(()=>{So({type:Ps.DomContentLoaded,data:{}}),"DOMContentLoaded"===C&&n()}))),e.push(ls("load",(()=>{So({type:Ps.Load,data:{}}),"load"===C&&n()}),window))),()=>{e.forEach((e=>e())),J.destroy(),To=void 0,Js()}}catch(e){console.warn(e)}}Ao.mirror=ko,Ao.takeFullSnapshot=function(e){if(!To)throw new Error("please take full snapshot after start recording");To(e)};const xo="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Co=["info","warn","error","log"],Do="[Replay] ";function No(e,t="info"){nt({category:"console",data:{logger:"replay"},level:t,message:`${Do}${e}`},{level:t})}const Oo=function(){let e=!1,t=!1;const n={exception:()=>{},infoTick:()=>{},setConfig:n=>{e=n.captureExceptions,t=n.traceInternals}};return xo?(Co.forEach((e=>{n[e]=(...n)=>{l[e](Do,...n),t&&No(n[0])}})),n.exception=(r,...i)=>{n.error&&n.error(...i),l.error(Do,r),e?Wt(r):t&&No(r)},n.infoTick=(...e)=>{l.info(Do,...e),t&&setTimeout((()=>No(e[0])),0)}):Co.forEach((e=>{n[e]=()=>{}})),n}();function Ro(e){return e>9999999999?e:1e3*e}function Mo(e){return e>9999999999?e/1e3:e}function Po(e,t){"sentry.transaction"!==t.category&&(["ui.click","ui.input"].includes(t.category)?e.triggerUserActivity():e.checkAndHandleExpiredSession(),e.addUpdate((()=>(e.throttledAddEvent({type:Ps.Custom,timestamp:1e3*(t.timestamp||0),data:{tag:"breadcrumb",payload:pt(t,10,1e3)}}),"console"===t.category))))}function Lo(e){return e.closest("button,a")||e}function Uo(e){const t=Fo(e);return t&&t instanceof Element?Lo(t):t}function Fo(e){return function(e){return"object"==typeof e&&!!e&&"target"in e}(e)?e.target:e}let Bo;function Vo(e){return Bo||(Bo=[],O(fi,"open",(function(e){return function(...t){if(Bo)try{Bo.forEach((e=>e()))}catch(e){}return e.apply(fi,t)}}))),Bo.push(e),()=>{const t=Bo?Bo.indexOf(e):-1;t>-1&&Bo.splice(t,1)}}const jo=new Set([Ls.Mutation,Ls.StyleSheetRule,Ls.StyleDeclaration,Ls.AdoptedStyleSheet,Ls.CanvasMutation,Ls.Selection,Ls.MediaInteraction]);class $o{constructor(e,t,n=Po){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=t.timeout/1e3,this._threshold=t.threshold/1e3,this._scollTimeout=t.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=t.ignoreSelector,this._addBreadcrumbEvent=n}addListeners(){const e=Vo((()=>{this._lastMutation=qo()}));this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,t){if(function(e,t){if(!Go.includes(e.tagName))return!0;if("INPUT"===e.tagName&&!["submit","button"].includes(e.getAttribute("type")||""))return!0;if("A"===e.tagName&&(e.hasAttribute("download")||e.hasAttribute("target")&&"_self"!==e.getAttribute("target")))return!0;if(t&&e.matches(t))return!0;return!1}(t,this._ignoreSelector)||!function(e){return!(!e.data||"number"!=typeof e.data.nodeId||!e.timestamp)}(e))return;const n={timestamp:Mo(e.timestamp),clickBreadcrumb:e,clickCount:0,node:t};this._clicks.some((e=>e.node===n.node&&Math.abs(e.timestamp-n.timestamp)<1))||(this._clicks.push(n),1===this._clicks.length&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=Mo(e)}registerScroll(e=Date.now()){this._lastScroll=Mo(e)}registerClick(e){const t=Lo(e);this._handleMultiClick(t)}_handleMultiClick(e){this._getClicks(e).forEach((e=>{e.clickCount++}))}_getClicks(e){return this._clicks.filter((t=>t.node===e))}_checkClicks(){const e=[],t=qo();this._clicks.forEach((n=>{!n.mutationAfter&&this._lastMutation&&(n.mutationAfter=n.timestamp<=this._lastMutation?this._lastMutation-n.timestamp:void 0),!n.scrollAfter&&this._lastScroll&&(n.scrollAfter=n.timestamp<=this._lastScroll?this._lastScroll-n.timestamp:void 0),n.timestamp+this._timeout<=t&&e.push(n)}));for(const t of e){const e=this._clicks.indexOf(t);e>-1&&(this._generateBreadcrumbs(t),this._clicks.splice(e,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const t=this._replay,n=e.scrollAfter&&e.scrollAfter<=this._scollTimeout,r=e.mutationAfter&&e.mutationAfter<=this._threshold,i=!n&&!r,{clickCount:s,clickBreadcrumb:o}=e;if(i){const n=1e3*Math.min(e.mutationAfter||this._timeout,this._timeout),r=n<1e3*this._timeout?"mutation":"timeout",i={type:"default",message:o.message,timestamp:o.timestamp,category:"ui.slowClickDetected",data:{...o.data,url:fi.location.href,route:t.getCurrentRoute(),timeAfterClickMs:n,endReason:r,clickCount:s||1}};this._addBreadcrumbEvent(t,i)}else if(s>1){const e={type:"default",message:o.message,timestamp:o.timestamp,category:"ui.multiClick",data:{...o.data,url:fi.location.href,route:t.getCurrentRoute(),clickCount:s,metric:!0}};this._addBreadcrumbEvent(t,e)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=sr((()=>this._checkClicks()),1e3)}}const Go=["A","BUTTON","INPUT"];function qo(){return Date.now()/1e3}function zo(e,t){try{if(!function(e){return 3===e.type}(t))return;const{source:n}=t.data;if(jo.has(n)&&e.registerMutation(t.timestamp),n===Ls.Scroll&&e.registerScroll(t.timestamp),function(e){return e.data.source===Ls.MouseInteraction}(t)){const{type:n,id:r}=t.data,i=Ao.mirror.getNode(r);i instanceof HTMLElement&&n===Us.Click&&e.registerClick(i)}}catch(e){}}function Ho(e){return{timestamp:Date.now()/1e3,type:"default",...e}}var Ko;!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(Ko||(Ko={}));const Wo=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function Qo(e){const t={};!e["data-sentry-component"]&&e["data-sentry-element"]&&(e["data-sentry-component"]=e["data-sentry-element"]);for(const n in e)if(Wo.has(n)){let r=n;"data-testid"!==n&&"data-test-id"!==n||(r="testId"),t[r]=e[n]}return t}const Yo=e=>t=>{if(!e.isEnabled())return;const n=function(e){const{target:t,message:n}=function(e){const t="click"===e.name;let n,r=null;try{r=t?Uo(e.event):Fo(e.event),n=T(r,{maxStringLength:200})||"<unknown>"}catch(e){n="<unknown>"}return{target:r,message:n}}(e);return Ho({category:`ui.${e.name}`,...Jo(t,n)})}(t);if(!n)return;const r="click"===t.name,i=r?t.event:void 0;var s,o,a;!(r&&e.clickDetector&&i&&i.target)||i.altKey||i.metaKey||i.ctrlKey||i.shiftKey||(s=e.clickDetector,o=n,a=Uo(t.event),s.handleClick(o,a)),Po(e,n)};function Jo(e,t){const n=Ao.mirror.getId(e),r=n&&Ao.mirror.getNode(n),i=r&&Ao.mirror.getMeta(r),s=i&&function(e){return e.type===Ko.Element}(i)?i:null;return{message:t,data:s?{nodeId:n,node:{id:n,tagName:s.tagName,textContent:Array.from(s.childNodes).map((e=>e.type===Ko.Text&&e.textContent)).filter(Boolean).map((e=>e.trim())).join(""),attributes:Qo(s.attributes)}}:{}}}function Xo(e,t){if(!e.isEnabled())return;e.updateUserActivity();const n=function(e){const{metaKey:t,shiftKey:n,ctrlKey:r,altKey:i,key:s,target:o}=e;if(!o||function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable}(o)||!s)return null;const a=t||r||i,c=1===s.length;if(!a&&c)return null;const u=T(o,{maxStringLength:200})||"<unknown>",l=Jo(o,u);return Ho({category:"ui.keyDown",message:u,data:{...l.data,metaKey:t,shiftKey:n,ctrlKey:r,altKey:i,key:s}})}(t);n&&Po(e,n)}const Zo={resource:function(e){const{entryType:t,initiatorType:n,name:r,responseEnd:i,startTime:s,decodedBodySize:o,encodedBodySize:a,responseStatus:c,transferSize:u}=e;if(["fetch","xmlhttprequest"].includes(n))return null;return{type:`${t}.${n}`,start:na(s),end:na(i),name:r,data:{size:u,statusCode:c,decodedBodySize:o,encodedBodySize:a}}},paint:function(e){const{duration:t,entryType:n,name:r,startTime:i}=e,s=na(i);return{type:n,name:r,start:s,end:s+t,data:void 0}},navigation:function(e){const{entryType:t,name:n,decodedBodySize:r,duration:i,domComplete:s,encodedBodySize:o,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,domInteractive:u,loadEventStart:l,loadEventEnd:h,redirectCount:d,startTime:f,transferSize:p,type:m}=e;if(0===i)return null;return{type:`${t}.${m}`,start:na(f),end:na(s),name:n,data:{size:p,decodedBodySize:r,encodedBodySize:o,duration:i,domInteractive:u,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,loadEventStart:l,loadEventEnd:h,domComplete:s,redirectCount:d}}}};function ea(e,t){return({metric:n})=>{t.replayPerformanceEntries.push(e(n))}}function ta(e){const t=Zo[e.entryType];return t?t(e):null}function na(e){return((oe||fi.performance.timeOrigin)+e)/1e3}function ra(e){const t=e.entries[e.entries.length-1];return ca(e,"largest-contentful-paint",t&&t.element?[t.element]:void 0)}function ia(e){return void 0!==e.sources}function sa(e){const t=[],n=[];for(const r of e.entries)if(ia(r)){const e=[];for(const t of r.sources)if(t.node){n.push(t.node);const r=Ao.mirror.getId(t.node);r&&e.push(r)}t.push({value:r.value,nodeIds:e.length?e:void 0})}return ca(e,"cumulative-layout-shift",n,t)}function oa(e){const t=e.entries[e.entries.length-1];return ca(e,"first-input-delay",t&&t.target?[t.target]:void 0)}function aa(e){const t=e.entries[e.entries.length-1];return ca(e,"interaction-to-next-paint",t&&t.target?[t.target]:void 0)}function ca(e,t,n,r){const i=e.value,s=e.rating,o=na(i);return{type:"web-vital",name:t,start:o,end:o,data:{value:i,size:i,rating:s,nodeIds:n?n.map((e=>Ao.mirror.getId(e))):void 0,attributions:r}}}function ua(e){function t(t){e.performanceEntries.includes(t)||e.performanceEntries.push(t)}function n({entries:e}){e.forEach(t)}const r=[];return["navigation","paint","resource"].forEach((e=>{r.push(ii(e,n))})),r.push(function(e,t=!1){return li("lcp",e,ci,ni,t)}(ea(ra,e)),function(e,t=!1){return li("cls",e,oi,ei,t)}(ea(sa,e)),li("fid",ea(oa,e),ai,ti),function(e){return li("inp",e,ui,ri)}(ea(aa,e))),()=>{r.forEach((e=>e()))}}class la extends Error{constructor(){super("Event buffer exceeded maximum size of 20000000.")}}class ha{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const t=JSON.stringify(e).length;if(this._totalSize+=t,this._totalSize>vi)throw new la;this.events.push(e)}finish(){return new Promise((e=>{const t=this.events;this.clear(),e(JSON.stringify(t))}))}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map((e=>e.timestamp)).sort()[0];return e?Ro(e):null}}class da{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise||(this._ensureReadyPromise=new Promise(((e,t)=>{this._worker.addEventListener("message",(({data:n})=>{n.success?e():t()}),{once:!0}),this._worker.addEventListener("error",(e=>{t(e)}),{once:!0})}))),this._ensureReadyPromise}destroy(){xo&&Oo.info("Destroying compression worker"),this._worker.terminate()}postMessage(e,t){const n=this._getAndIncrementId();return new Promise(((r,i)=>{const s=({data:t})=>{const o=t;if(o.method===e&&o.id===n){if(this._worker.removeEventListener("message",s),!o.success)return xo&&Oo.error("Error in compression worker: ",o.response),void i(new Error("Error in compression worker"));r(o.response)}};this._worker.addEventListener("message",s),this._worker.postMessage({id:n,method:e,arg:t})}))}_getAndIncrementId(){return this._id++}}class fa{constructor(e){this._worker=new da(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const t=Ro(e.timestamp);(!this._earliestTimestamp||t<this._earliestTimestamp)&&(this._earliestTimestamp=t);const n=JSON.stringify(e);return this._totalSize+=n.length,this._totalSize>vi?Promise.reject(new la):this._sendEventToWorker(n)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,(e=>{xo&&Oo.exception(e,'Sending "clear" message to worker failed',e)}))}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class pa{constructor(e){this._fallback=new ha,this._compression=new fa(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(e){return void(xo&&Oo.exception(e,"Failed to load the compression worker, falling back to simple buffer"))}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:t}=this._fallback,n=[];for(const t of e)n.push(this._compression.addEvent(t));this._compression.hasCheckout=t,this._used=this._compression;try{await Promise.all(n)}catch(e){xo&&Oo.exception(e,"Failed to add events when switching buffers.")}}}function ma({useCompression:e,workerUrl:t}){if(e&&window.Worker){const e=function(e){try{const t=e||function(){if("undefined"==typeof __SENTRY_EXCLUDE_REPLAY_WORKER__||!__SENTRY_EXCLUDE_REPLAY_WORKER__)return function(){const e=new Blob(['var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==r||r<0)&&(r=0),(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},A=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},_=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=x(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},x=function(t,n,r){return-1==t.s?Math.max(x(t.l,n,r+1),x(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},C=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=_(f,15),M=b.t,E=b.l,x=_(h,15),C=x.t,U=x.l,F=D(M),I=F.c,S=F.n,L=D(C),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=_(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,C)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(C,U,0),R=C;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){A(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;A(r,m,Q[et]),m+=R[et],et>3&&(A(r,m,rt>>5&8191),m+=i[et])}else A(r,m,N[rt]),m+=P[rt]}return A(r,m,N[256]),m+P[256]},U=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}},L=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},O=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=U[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,A=c.p||new n(32768),_=c.h||new n(z+1),x=Math.ceil(o/3),D=2*x,T=function(t){return(a[t]^a[t+1]<<x^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=_[H];if(A[J]=K,_[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=C(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-A[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=A[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=C(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=_,c.p=A,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},j=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},q=function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&j(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}},B=function(t){return 10+(t.filename?t.filename.length+1:0)},G=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(O(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();var H=function(){function t(t,n){this.c=L(),this.v=1,G.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),G.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=O(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=L();i.p(n.dictionary),j(t,2,i.d())}}(r,this.o),this.v=0),n&&j(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),J="undefined"!=typeof TextEncoder&&new TextEncoder,K="undefined"!=typeof TextDecoder&&new TextDecoder;try{K.decode(F,{stream:!0})}catch(t){}var N=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(P(t),this.d=n||!1)},t}();function P(n,r){if(r){for(var e=new t(n.length),i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}if(J)return J.encode(n);var a=n.length,s=new t(n.length+(n.length>>1)),o=0,f=function(t){s[o++]=t};for(i=0;i<a;++i){if(o+5>s.length){var h=new t(o+8+(a-i<<1));h.set(s),s=h}var l=n.charCodeAt(i);l<128||r?f(l):l<2048?(f(192|l>>6),f(128|63&l)):l>55295&&l<57344?(f(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++i))>>18),f(128|l>>12&63),f(128|l>>6&63),f(128|63&l)):(f(224|l>>12),f(128|l>>6&63),f(128|63&l))}return b(s,0,o)}function Q(t){return function(t,n){n||(n={});var r=S(),e=t.length;r.p(t);var i=O(t,n,B(n),8),a=i.length;return q(i,n),j(i,a-8,r.d()),j(i,a-4,e),i}(P(t))}const R=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(const r of t)n+=r.length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new H,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new N(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},V={clear:()=>{R.clear()},addEvent:t=>R.addEvent(t),finish:()=>R.finish(),compress:t=>Q(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in V&&"function"==typeof V[n])try{const t=V[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});']);return URL.createObjectURL(e)}();return""}();if(!t)return;xo&&Oo.info("Using compression worker"+(e?` from ${e}`:""));const n=new Worker(t);return new pa(n)}catch(e){xo&&Oo.exception(e,"Failed to create compression worker")}}(t);if(e)return e}return xo&&Oo.info("Using simple buffer"),new ha}function ga(){try{return"sessionStorage"in fi&&!!fi.sessionStorage}catch(e){return!1}}function ya(e){!function(){if(!ga())return;try{fi.sessionStorage.removeItem(pi)}catch(e){}}(),e.session=void 0}function va(e){return void 0!==e&&Math.random()<e}function _a(e){const t=Date.now();return{id:e.id||j(),started:e.started||t,lastActivity:e.lastActivity||t,segmentId:e.segmentId||0,sampled:e.sampled,previousSessionId:e.previousSessionId}}function wa(e){if(ga())try{fi.sessionStorage.setItem(pi,JSON.stringify(e))}catch(e){}}function ba({sessionSampleRate:e,allowBuffering:t,stickySession:n=!1},{previousSessionId:r}={}){const i=function(e,t){return va(e)?"session":!!t&&"buffer"}(e,t),s=_a({sampled:i,previousSessionId:r});return n&&wa(s),s}function Ea(e,t,n=+new Date){return null===e||void 0===t||t<0||0!==t&&e+t<=n}function Ia(e,{maxReplayDuration:t,sessionIdleExpire:n,targetTime:r=Date.now()}){return Ea(e.started,t,r)||Ea(e.lastActivity,n,r)}function Sa(e,{sessionIdleExpire:t,maxReplayDuration:n}){return!!Ia(e,{sessionIdleExpire:t,maxReplayDuration:n})&&("buffer"!==e.sampled||0!==e.segmentId)}function Ta({sessionIdleExpire:e,maxReplayDuration:t,previousSessionId:n},r){const i=r.stickySession&&function(){if(!ga())return null;try{const e=fi.sessionStorage.getItem(pi);if(!e)return null;const t=JSON.parse(e);return xo&&Oo.infoTick("Loading existing session"),_a(t)}catch(e){return null}}();return i?Sa(i,{sessionIdleExpire:e,maxReplayDuration:t})?(xo&&Oo.infoTick("Session in sessionStorage is expired, creating new one..."),ba(r,{previousSessionId:i.id})):i:(xo&&Oo.infoTick("Creating new session"),ba(r,{previousSessionId:n}))}function ka(e,t,n){return!!xa(e,t)&&(Aa(e,t,n),!0)}async function Aa(e,t,n){if(!e.eventBuffer)return null;try{n&&"buffer"===e.recordingMode&&e.eventBuffer.clear(),n&&(e.eventBuffer.hasCheckout=!0);const r=function(e,t){try{if("function"==typeof t&&function(e){return e.type===Ps.Custom}(e))return t(e)}catch(e){return xo&&Oo.exception(e,"An error occured in the `beforeAddRecordingEvent` callback, skipping the event..."),null}return e}(t,e.getOptions().beforeAddRecordingEvent);if(!r)return;return await e.eventBuffer.addEvent(r)}catch(t){const n=t&&t instanceof la?"addEventSizeExceeded":"addEvent";e.handleException(t),await e.stop({reason:n});const r=be();r&&r.recordDroppedEvent("internal_sdk_error","replay")}}function xa(e,t){if(!e.eventBuffer||e.isPaused()||!e.isEnabled())return!1;const n=Ro(t.timestamp);return!(n+e.timeouts.sessionIdlePause<Date.now())&&(!(n>e.getContext().initialTimestamp+e.getOptions().maxReplayDuration)||(xo&&Oo.infoTick(`Skipping event with timestamp ${n} because it is after maxReplayDuration`),!1))}function Ca(e){return!e.type}function Da(e){return"transaction"===e.type}function Na(e){return"feedback"===e.type}function Oa(e){return(t,n)=>{if(!e.isEnabled()||!Ca(t)&&!Da(t))return;const r=n&&n.statusCode;!r||r<200||r>=300||(Da(t)?function(e,t){const n=e.getContext();t.contexts&&t.contexts.trace&&t.contexts.trace.trace_id&&n.traceIds.size<100&&n.traceIds.add(t.contexts.trace.trace_id)}(e,t):function(e,t){const n=e.getContext();t.event_id&&n.errorIds.size<100&&n.errorIds.add(t.event_id);if("buffer"!==e.recordingMode||!t.tags||!t.tags.replayId)return;const{beforeErrorSampling:r}=e.getOptions();if("function"==typeof r&&!r(t))return;sr((()=>{e.sendBufferedReplayOrFlush()}))}(e,t))}}function Ra(e){return t=>{e.isEnabled()&&Ca(t)&&function(e,t){const n=t.exception&&t.exception.values&&t.exception.values[0]&&t.exception.values[0].value;if("string"!=typeof n)return;if(n.match(/(reactjs\.org\/docs\/error-decoder\.html\?invariant=|react\.dev\/errors\/)(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i)){Po(e,Ho({category:"replay.hydrate-error",data:{url:A()}}))}}(e,t)}}function Ma(e){const t=be();t&&t.on("beforeAddBreadcrumb",(t=>function(e,t){if(!e.isEnabled()||!Pa(t))return;const n=function(e){if(!Pa(e)||["fetch","xhr","sentry.event","sentry.transaction"].includes(e.category)||e.category.startsWith("ui."))return null;if("console"===e.category)return function(e){const t=e.data&&e.data.arguments;if(!Array.isArray(t)||0===t.length)return Ho(e);let n=!1;const r=t.map((e=>{if(!e)return e;if("string"==typeof e)return e.length>yi?(n=!0,`${e.slice(0,yi)}…`):e;if("object"==typeof e)try{const t=pt(e,7);return JSON.stringify(t).length>yi?(n=!0,`${JSON.stringify(t,null,2).slice(0,yi)}…`):t}catch(e){}return e}));return Ho({...e,data:{...e.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}(e);return Ho(e)}(t);n&&Po(e,n)}(e,t)))}function Pa(e){return!!e.category}function La(e){return Object.assign(((t,n)=>{if(!e.isEnabled())return t;if(function(e){return"replay_event"===e.type}(t))return delete t.breadcrumbs,t;if(!Ca(t)&&!Da(t)&&!Na(t))return t;if(!e.checkAndHandleExpiredSession())return t;if(Na(t))return e.flush(),t.contexts.feedback.replay_id=e.getSessionId(),function(e,t){e.triggerUserActivity(),e.addUpdate((()=>!t.timestamp||(e.throttledAddEvent({type:Ps.Custom,timestamp:1e3*t.timestamp,data:{tag:"breadcrumb",payload:{timestamp:t.timestamp,type:"default",category:"sentry.feedback",data:{feedbackId:t.event_id}}}}),!1)))}(e,t),t;if(function(e,t){return!(e.type||!e.exception||!e.exception.values||!e.exception.values.length||!t.originalException||!t.originalException.__rrweb__)}(t,n)&&!e.getOptions()._experiments.captureExceptions)return xo&&Oo.log("Ignoring error from rrweb internals",t),null;const r=function(e,t){return"buffer"===e.recordingMode&&t.message!==mi&&!(!t.exception||t.type)&&va(e.getOptions().errorSampleRate)}(e,t);return(r||"session"===e.recordingMode)&&(t.tags={...t.tags,replayId:e.getSessionId()}),t}),{id:"Replay"})}function Ua(e,t){return t.map((({type:t,start:n,end:r,name:i,data:s})=>{const o=e.throttledAddEvent({type:Ps.Custom,timestamp:n,data:{tag:"performanceSpan",payload:{op:t,description:i,startTimestamp:n,endTimestamp:r,data:s}}});return"string"==typeof o?Promise.resolve(null):o}))}function Fa(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{from:t,to:n}=e,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:t}}}(t);null!==n&&(e.getContext().urls.push(n.name),e.triggerUserActivity(),e.addUpdate((()=>(Ua(e,[n]),!1))))}}function Ba(e,t){e.isEnabled()&&null!==t&&(function(e,t){return(!xo||!e.getOptions()._experiments.traceInternals)&&_r(t,be())}(e,t.name)||e.addUpdate((()=>(Ua(e,[t]),!0))))}function Va(e){if(!e)return;const t=new TextEncoder;try{if("string"==typeof e)return t.encode(e).length;if(e instanceof URLSearchParams)return t.encode(e.toString()).length;if(e instanceof FormData){const n=Wa(e);return t.encode(n).length}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength}catch(e){}}function ja(e){if(!e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}function $a(e){try{if("string"==typeof e)return[e];if(e instanceof URLSearchParams)return[e.toString()];if(e instanceof FormData)return[Wa(e)];if(!e)return[void 0]}catch(t){return xo&&Oo.exception(t,"Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return xo&&Oo.info("Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}function Ga(e,t){if(!e)return{headers:{},size:void 0,_meta:{warnings:[t]}};const n={...e._meta},r=n.warnings||[];return n.warnings=[...r,t],e._meta=n,e}function qa(e,t){if(!t)return null;const{startTimestamp:n,endTimestamp:r,url:i,method:s,statusCode:o,request:a,response:c}=t;return{type:e,start:n/1e3,end:r/1e3,name:i,data:B({method:s,statusCode:o,request:a,response:c})}}function za(e){return{headers:{},size:e,_meta:{warnings:["URL_SKIPPED"]}}}function Ha(e,t,n){if(!t&&0===Object.keys(e).length)return;if(!t)return{headers:e};if(!n)return{headers:e,size:t};const r={headers:e,size:t},{body:i,warnings:s}=function(e){if(!e||"string"!=typeof e)return{body:e};const t=e.length>gi,n=function(e){const t=e[0],n=e[e.length-1];return"["===t&&"]"===n||"{"===t&&"}"===n}(e);if(t){const t=e.slice(0,gi);return n?{body:t,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${t}…`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(e)}}catch(e){}return{body:e}}(n);return r.body=i,s&&s.length>0&&(r._meta={warnings:s}),r}function Ka(e,t){return Object.entries(e).reduce(((n,[r,i])=>{const s=r.toLowerCase();return t.includes(s)&&e[r]&&(n[s]=i),n}),{})}function Wa(e){return new URLSearchParams(e).toString()}function Qa(e,t){const n=function(e,t=fi.document.baseURI){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith(fi.location.origin))return e;const n=new URL(e,t);if(n.origin!==new URL(t).origin)return e;const r=n.href;if(!e.endsWith("/")&&r.endsWith("/"))return r.slice(0,-1);return r}(e);return N(n,t)}async function Ya(e,t,n){try{const r=await async function(e,t,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r}=t,{url:o,method:a,status_code:c=0,request_body_size:u,response_body_size:l}=e.data,h=Qa(o,n.networkDetailAllowUrls)&&!Qa(o,n.networkDetailDenyUrls),d=h?function({networkCaptureBodies:e,networkRequestHeaders:t},n,r){const i=n?function(e,t){if(1===e.length&&"string"!=typeof e[0])return Za(e[0],t);if(2===e.length)return Za(e[1],t);return{}}(n,t):{};if(!e)return Ha(i,r,void 0);const s=Ja(n),[o,a]=$a(s),c=Ha(i,r,o);if(a)return Ga(c,a);return c}(n,t.input,u):za(u),f=await async function(e,{networkCaptureBodies:t,networkResponseHeaders:n},r,i){if(!e&&void 0!==i)return za(i);const s=r?Xa(r.headers,n):{};if(!r||!t&&void 0!==i)return Ha(s,i,void 0);const[o,a]=await async function(e){const t=function(e){try{return e.clone()}catch(e){xo&&Oo.exception(e,"Failed to clone response body")}}(e);if(!t)return[void 0,"BODY_PARSE_ERROR"];try{const e=await function(e){return new Promise(((t,n)=>{const r=sr((()=>n(new Error("Timeout while trying to read response body"))),500);(async function(e){return await e.text()})(e).then((e=>t(e)),(e=>n(e))).finally((()=>clearTimeout(r)))}))}(t);return[e]}catch(e){return xo&&Oo.exception(e,"Failed to get text body from response"),[void 0,"BODY_PARSE_ERROR"]}}(r),c=function(e,{networkCaptureBodies:t,responseBodySize:n,captureDetails:r,headers:i}){try{const s=e&&e.length&&void 0===n?Va(e):n;return r?Ha(i,s,t?e:void 0):za(s)}catch(e){return xo&&Oo.exception(e,"Failed to serialize response body"),Ha(i,n,void 0)}}(o,{networkCaptureBodies:t,responseBodySize:i,captureDetails:e,headers:s});if(a)return Ga(c,a);return c}(h,n,t.response,l);return{startTimestamp:i,endTimestamp:s,url:o,method:a,statusCode:c,request:d,response:f}}(e,t,n),i=qa("resource.fetch",r);Ba(n.replay,i)}catch(e){xo&&Oo.exception(e,"Failed to capture fetch breadcrumb")}}function Ja(e=[]){if(2===e.length&&"object"==typeof e[1])return e[1].body}function Xa(e,t){const n={};return t.forEach((t=>{e.get(t)&&(n[t]=e.get(t))})),n}function Za(e,t){if(!e)return{};const n=e.headers;return n?n instanceof Headers?Xa(n,t):Array.isArray(n)?{}:Ka(n,t):{}}async function ec(e,t,n){try{const r=function(e,t,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r,input:o,xhr:a}=t,{url:c,method:u,status_code:l=0,request_body_size:h,response_body_size:d}=e.data;if(!c)return null;if(!a||!Qa(c,n.networkDetailAllowUrls)||Qa(c,n.networkDetailDenyUrls)){return{startTimestamp:i,endTimestamp:s,url:c,method:u,statusCode:l,request:za(h),response:za(d)}}const f=a[Qe],p=f?Ka(f.request_headers,n.networkRequestHeaders):{},m=Ka(function(e){const t=e.getAllResponseHeaders();if(!t)return{};return t.split("\r\n").reduce(((e,t)=>{const[n,r]=t.split(": ");return r&&(e[n.toLowerCase()]=r),e}),{})}(a),n.networkResponseHeaders),[g,y]=n.networkCaptureBodies?$a(o):[void 0],[v,_]=n.networkCaptureBodies?function(e){const t=[];try{return[e.responseText]}catch(e){t.push(e)}try{return function(e,t){try{if("string"==typeof e)return[e];if(e instanceof Document)return[e.body.outerHTML];if("json"===t&&e&&"object"==typeof e)return[JSON.stringify(e)];if(!e)return[void 0]}catch(t){return xo&&Oo.exception(t,"Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return xo&&Oo.info("Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}(e.response,e.responseType)}catch(e){t.push(e)}return xo&&Oo.warn("Failed to get xhr response body",...t),[void 0]}(a):[void 0],w=Ha(p,h,g),b=Ha(m,d,v);return{startTimestamp:i,endTimestamp:s,url:c,method:u,statusCode:l,request:y?Ga(w,y):w,response:_?Ga(b,_):b}}(e,t,n),i=qa("resource.xhr",r);Ba(n.replay,i)}catch(e){xo&&Oo.exception(e,"Failed to capture xhr breadcrumb")}}function tc(e,t){const{xhr:n,input:r}=t;if(!n)return;const i=Va(r),s=n.getResponseHeader("content-length")?ja(n.getResponseHeader("content-length")):function(e,t){try{return Va("json"===t&&e&&"object"==typeof e?JSON.stringify(e):e)}catch(e){return}}(n.response,n.responseType);void 0!==i&&(e.data.request_body_size=i),void 0!==s&&(e.data.response_body_size=s)}function nc(e){const t=be();try{const{networkDetailAllowUrls:n,networkDetailDenyUrls:r,networkCaptureBodies:i,networkRequestHeaders:s,networkResponseHeaders:o}=e.getOptions(),a={replay:e,networkDetailAllowUrls:n,networkDetailDenyUrls:r,networkCaptureBodies:i,networkRequestHeaders:s,networkResponseHeaders:o};t&&t.on("beforeAddBreadcrumb",((e,t)=>function(e,t,n){if(!t.data)return;try{(function(e){return"xhr"===e.category})(t)&&function(e){return e&&e.xhr}(n)&&(tc(t,n),ec(t,n,e)),function(e){return"fetch"===e.category}(t)&&function(e){return e&&e.response}(n)&&(!function(e,t){const{input:n,response:r}=t,i=Va(n?Ja(n):void 0),s=r?ja(r.headers.get("content-length")):void 0;void 0!==i&&(e.data.request_body_size=i),void 0!==s&&(e.data.response_body_size=s)}(t,n),Ya(t,n,e))}catch(e){xo&&Oo.exception(e,"Error when enriching network breadcrumb")}}(a,e,t)))}catch(e){}}function rc(e){const t=be();He(Yo(e)),Ze(Fa(e)),Ma(e),nc(e);const n=La(e);var r;r=n,we().addEventProcessor(r),t&&(t.on("beforeSendEvent",Ra(e)),t.on("afterSendEvent",Oa(e)),t.on("createDsc",(t=>{const n=e.getSessionId();if(n&&e.isEnabled()&&"session"===e.recordingMode){e.checkAndHandleExpiredSession()&&(t.replay_id=n)}})),t.on("spanStart",(t=>{e.lastActiveSpan=t})),t.on("spanEnd",(t=>{e.lastActiveSpan=t})),t.on("beforeSendFeedback",((t,n)=>{const r=e.getSessionId();n&&n.includeReplay&&e.isEnabled()&&r&&t.contexts&&t.contexts.feedback&&(t.contexts.feedback.replay_id=r)})))}function ic(e){const{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}=e,i=Date.now()/1e3;return{type:"memory",name:"memory",start:i,end:i,data:{memory:{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}}}}function sc(e){let t=!1;return(n,r)=>{if(!e.checkAndHandleExpiredSession())return void(xo&&Oo.warn("Received replay event after session expired."));const i=r||!t;t=!0,e.clickDetector&&zo(e.clickDetector,n),e.addUpdate((()=>{if("buffer"===e.recordingMode&&i&&e.setInitialState(),!ka(e,n,i))return!0;if(!i)return!1;if(function(e,t){if(!t||!e.session||0!==e.session.segmentId)return;ka(e,function(e){const t=e.getOptions();return{type:Ps.Custom,timestamp:Date.now(),data:{tag:"options",payload:{shouldRecordCanvas:e.isRecordingCanvas(),sessionSampleRate:t.sessionSampleRate,errorSampleRate:t.errorSampleRate,useCompressionOption:t.useCompression,blockAllMedia:t.blockAllMedia,maskAllText:t.maskAllText,maskAllInputs:t.maskAllInputs,useCompression:!!e.eventBuffer&&"worker"===e.eventBuffer.type,networkDetailHasUrls:t.networkDetailAllowUrls.length>0,networkCaptureBodies:t.networkCaptureBodies,networkRequestHasHeaders:t.networkRequestHeaders.length>0,networkResponseHasHeaders:t.networkResponseHeaders.length>0}}}}(e),!1)}(e,i),e.session&&e.session.previousSessionId)return!0;if("buffer"===e.recordingMode&&e.session&&e.eventBuffer){const t=e.eventBuffer.getEarliestTimestamp();t&&(xo&&Oo.info(`Updating session start time to earliest event in buffer to ${new Date(t)}`),e.session.started=t,e.getOptions().stickySession&&wa(e.session))}return"session"===e.recordingMode&&e.flush(),!0}))}}async function oc({recordingData:e,replayId:t,segmentId:n,eventContext:r,timestamp:i,session:s}){const o=function({recordingData:e,headers:t}){let n;const r=`${JSON.stringify(t)}\n`;if("string"==typeof e)n=`${r}${e}`;else{const t=(new TextEncoder).encode(r);n=new Uint8Array(t.length+e.length),n.set(t),n.set(e,t.length)}return n}({recordingData:e,headers:{segment_id:n}}),{urls:a,errorIds:c,traceIds:u,initialTimestamp:l}=r,h=be(),d=_e(),f=h&&h.getTransport(),p=h&&h.getDsn();if(!(h&&f&&p&&s.sampled))return _t({});const m={type:"replay_event",replay_start_timestamp:l/1e3,timestamp:i/1e3,error_ids:c,trace_ids:u,urls:a,replay_id:t,segment_id:n,replay_type:s.sampled},g=await async function({client:e,scope:t,replayId:n,event:r}){const i={event_id:n,integrations:"object"!=typeof e._integrations||null===e._integrations||Array.isArray(e._integrations)?void 0:Object.keys(e._integrations)};e.emit("preprocessEvent",r,i);const s=await qt(e.getOptions(),r,i,t,e,we());if(!s)return null;s.platform=s.platform||"javascript";const o=e.getSdkMetadata(),{name:a,version:c}=o&&o.sdk||{};return s.sdk={...s.sdk,name:a||"sentry.javascript.unknown",version:c||"0.0.0"},s}({scope:d,client:h,replayId:t,event:m});if(!g)return h.recordDroppedEvent("event_processor","replay",m),xo&&Oo.info("An event processor returned `null`, will not send event."),_t({});delete g.sdkProcessingMetadata;const y=function(e,t,n,r){return Ln(zn(e,qn(e),r,n),[[{type:"replay_event"},e],[{type:"replay_recording",length:"string"==typeof t?(new TextEncoder).encode(t).length:t.length},t]])}(g,o,p,h.getOptions().tunnel);let v;try{v=await f.send(y)}catch(e){const t=new Error(mi);try{t.cause=e}catch(e){}throw t}if("number"==typeof v.statusCode&&(v.statusCode<200||v.statusCode>=300))throw new ac(v.statusCode);const _=cr({},v);if(ar(_,"replay"))throw new cc(_);return v}class ac extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class cc extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function uc(e,t={count:0,interval:5e3}){const{recordingData:n,options:r}=e;var i,s;if(n.length)try{return await oc(e),!0}catch(n){if(n instanceof ac||n instanceof cc)throw n;if(i="Replays",s={_retryCount:t.count},we().setContext(i,s),xo&&r._experiments&&r._experiments.captureExceptions&&Wt(n),t.count>=3){const e=new Error(`${mi} - max retries exceeded`);try{e.cause=n}catch(e){}throw e}return t.interval*=++t.count,new Promise(((n,r)=>{sr((async()=>{try{await uc(e,t),n(!0)}catch(e){r(e)}}),t.interval)}))}}const lc="__THROTTLED";function hc(e,t,n){const r=new Map;let i=!1;return(...s)=>{const o=Math.floor(Date.now()/1e3);if((e=>{const t=e-n;r.forEach(((e,n)=>{n<t&&r.delete(n)}))})(o),[...r.values()].reduce(((e,t)=>e+t),0)>=t){const e=i;return i=!0,e?"__SKIPPED":lc}i=!1;const a=r.get(o)||0;return r.set(o,a+1),e(...s)}}class dc{constructor({options:e,recordingOptions:t}){dc.prototype.__init.call(this),dc.prototype.__init2.call(this),dc.prototype.__init3.call(this),dc.prototype.__init4.call(this),dc.prototype.__init5.call(this),dc.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:3e5,sessionIdleExpire:9e5},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._requiresManualStart=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=t,this._options=e,this._debouncedFlush=function(e,t,n){let r,i,s;const o=n&&n.maxWait?Math.max(n.maxWait,t):0;function a(){return c(),r=e(),r}function c(){void 0!==i&&clearTimeout(i),void 0!==s&&clearTimeout(s),i=s=void 0}function u(){return i&&clearTimeout(i),i=sr(a,t),o&&void 0===s&&(s=sr(a,o)),r}return u.cancel=c,u.flush=function(){return void 0!==i||void 0!==s?a():r},u}((()=>this._flush()),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=hc(((e,t)=>function(e,t,n){return xa(e,t)?Aa(e,t,n):Promise.resolve(null)}(this,e,t)),300,5);const{slowClickTimeout:n,slowClickIgnoreSelectors:r}=this.getOptions(),i=n?{threshold:Math.min(3e3,n),timeout:n,scrollTimeout:300,ignoreSelector:r?r.join(","):""}:void 0;if(i&&(this.clickDetector=new $o(this,i)),xo){const t=e._experiments;Oo.setConfig({captureExceptions:!!t.captureExceptions,traceInternals:!!t.traceInternals})}}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}isRecordingCanvas(){return Boolean(this._canvas)}getOptions(){return this._options}handleException(e){xo&&Oo.exception(e)}initializeSampling(e){const{errorSampleRate:t,sessionSampleRate:n}=this._options,r=t<=0&&n<=0;this._requiresManualStart=r,r||(this._initializeSessionForSampling(e),this.session?!1!==this.session.sampled&&(this.recordingMode="buffer"===this.session.sampled&&0===this.session.segmentId?"buffer":"session",xo&&Oo.infoTick(`Starting replay in ${this.recordingMode} mode`),this._initializeRecording()):xo&&Oo.exception(new Error("Unable to initialize and create session")))}start(){if(this._isEnabled&&"session"===this.recordingMode)return void(xo&&Oo.info("Recording is already in progress"));if(this._isEnabled&&"buffer"===this.recordingMode)return void(xo&&Oo.info("Buffering is in progress, call `flush()` to save the replay"));xo&&Oo.infoTick("Starting replay in session mode"),this._updateUserActivity();const e=Ta({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this._initializeRecording()}startBuffering(){if(this._isEnabled)return void(xo&&Oo.info("Buffering is in progress, call `flush()` to save the replay"));xo&&Oo.infoTick("Starting replay in buffer mode");const e=Ta({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const e=this._canvas;this._stopRecording=Ao({...this._recordingOptions,..."buffer"===this.recordingMode&&{checkoutEveryNms:6e4},emit:sc(this),onMutation:this._onMutationHandler,...e?{recordCanvas:e.recordCanvas,getCanvasManager:e.getCanvasManager,sampling:e.sampling,dataURLOptions:e.dataURLOptions}:{}})}catch(e){this.handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this.handleException(e),!1}}async stop({forceFlush:e=!1,reason:t}={}){if(this._isEnabled){this._isEnabled=!1;try{xo&&Oo.info("Stopping Replay"+(t?` triggered by ${t}`:"")),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,ya(this)}catch(e){this.handleException(e)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),xo&&Oo.info("Pausing replay"))}resume(){this._isPaused&&this._checkSession()&&(this._isPaused=!1,this.startRecording(),xo&&Oo.info("Resuming replay"))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if("session"===this.recordingMode)return this.flushImmediate();const t=Date.now();xo&&Oo.info("Converting buffer to session"),await this.flushImmediate();const n=this.stopRecording();e&&n&&"session"!==this.recordingMode&&(this.recordingMode="session",this.session&&(this._updateUserActivity(t),this._updateSessionActivity(t),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const t=e();"buffer"!==this.recordingMode&&!0!==t&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),this._stopRecording)this.checkAndHandleExpiredSession(),this._updateSessionActivity();else{if(!this._checkSession())return;this.resume()}}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return"buffer"===this.recordingMode?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(!(this._lastActivity&&Ea(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&"session"===this.session.sampled))return!!this._checkSession();this.pause()}setInitialState(){const e=`${fi.location.pathname}${fi.location.hash}${fi.location.search}`,t=`${fi.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=t,this._context.initialTimestamp=Date.now(),this._context.urls.push(t)}throttledAddEvent(e,t){const n=this._throttledAddEvent(e,t);if(n===lc){const e=Ho({category:"replay.throttled"});this.addUpdate((()=>!ka(this,{type:5,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e,metric:!0}})))}return n}getCurrentRoute(){const e=this.lastActiveSpan||Ut(),t=e&&Lt(e),n=(t&&Ot(t).data||{})[kt];if(t&&n&&["route","custom"].includes(n))return Ot(t).description}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=ma({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_initializeSessionForSampling(e){const t=this._options.errorSampleRate>0,n=Ta({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:t});this.session=n}_checkSession(){if(!this.session)return!1;const e=this.session;return!Sa(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})||(this._refreshSession(e),!1)}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{fi.document.addEventListener("visibilitychange",this._handleVisibilityChange),fi.addEventListener("blur",this._handleWindowBlur),fi.addEventListener("focus",this._handleWindowFocus),fi.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(rc(this),this._hasInitializedCoreListeners=!0)}catch(e){this.handleException(e)}this._performanceCleanupCallback=ua(this)}_removeListeners(){try{fi.document.removeEventListener("visibilitychange",this._handleVisibilityChange),fi.removeEventListener("blur",this._handleWindowBlur),fi.removeEventListener("focus",this._handleWindowFocus),fi.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this.handleException(e)}}__init(){this._handleVisibilityChange=()=>{"visible"===fi.document.visibilityState?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const e=Ho({category:"ui.blur"});this._doChangeToBackgroundTasks(e)}}__init3(){this._handleWindowFocus=()=>{const e=Ho({category:"ui.focus"});this._doChangeToForegroundTasks(e)}}__init4(){this._handleKeyboardEvent=e=>{Xo(this,e)}}_doChangeToBackgroundTasks(e){if(!this.session)return;Ia(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush())}_doChangeToForegroundTasks(e){if(!this.session)return;this.checkAndHandleExpiredSession()?e&&this._createCustomBreadcrumb(e):xo&&Oo.info("Document has become active, but session has expired")}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate((()=>{this.throttledAddEvent({type:Ps.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})}))}_addPerformanceEntries(){const e=(t=this.performanceEntries,t.map(ta).filter(Boolean)).concat(this.replayPerformanceEntries);var t;return this.performanceEntries=[],this.replayPerformanceEntries=[],Promise.all(Ua(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:t}=this;if(!e||!t||this._requiresManualStart)return;if(e.segmentId)return;const n=t.getEarliestTimestamp();n&&n<this._context.initialTimestamp&&(this._context.initialTimestamp=n)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(this.session&&this.eventBuffer&&e){if(await this._addPerformanceEntries(),this.eventBuffer&&this.eventBuffer.hasEvents&&(await async function(e){try{return Promise.all(Ua(e,[ic(fi.performance.memory)]))}catch(e){return[]}}(this),this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const t=Date.now();if(t-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const n=this._popEventContext(),r=this.session.segmentId++;this._maybeSaveSession();const i=await this.eventBuffer.finish();await uc({replayId:e,recordingData:i,segmentId:r,eventContext:n,session:this.session,options:this.getOptions(),timestamp:t})}catch(e){this.handleException(e),this.stop({reason:"sendReplay"});const t=be();t&&t.recordDroppedEvent("send_error","replay")}}else xo&&Oo.error("No session or eventBuffer found to flush.")}__init5(){this._flush=async({force:e=!1}={})=>{if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession())return void(xo&&Oo.error("Attempting to finish replay event after session expired."));if(!this.session)return;const t=this.session.started,n=Date.now()-t;this._debouncedFlush.cancel();const r=n<this._options.minReplayDuration,i=n>this._options.maxReplayDuration+5e3;if(r||i)return xo&&Oo.info(`Session duration (${Math.floor(n/1e3)}s) is too ${r?"short":"long"}, not sending replay.`),void(r&&this._debouncedFlush());const s=this.eventBuffer;if(s&&0===this.session.segmentId&&!s.hasCheckout&&xo&&Oo.info("Flushing initial segment without checkout."),!this._flushLock)return this._flushLock=this._runFlush(),await this._flushLock,void(this._flushLock=void 0);try{await this._flushLock}catch(e){xo&&Oo.error(e)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&wa(this.session)}__init6(){this._onMutationHandler=e=>{const t=e.length,n=this._options.mutationLimit,r=n&&t>n;if(t>this._options.mutationBreadcrumbLimit||r){const e=Ho({category:"replay.mutations",data:{count:t,limit:r}});this._createCustomBreadcrumb(e)}return!r||(this.stop({reason:"mutationLimit",forceFlush:"session"===this.recordingMode}),!1)}}}function fc(e,t){return[...e,...t].join(",")}const pc='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',mc=["content-length","content-type","accept"];let gc=!1;class yc{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:e=5e3,flushMaxDelay:t=5500,minReplayDuration:n=4999,maxReplayDuration:r=36e5,stickySession:i=!0,useCompression:s=!0,workerUrl:o,_experiments:a={},maskAllText:c=!0,maskAllInputs:u=!0,blockAllMedia:l=!0,mutationBreadcrumbLimit:h=750,mutationLimit:d=1e4,slowClickTimeout:f=7e3,slowClickIgnoreSelectors:p=[],networkDetailAllowUrls:m=[],networkDetailDenyUrls:g=[],networkCaptureBodies:y=!0,networkRequestHeaders:v=[],networkResponseHeaders:_=[],mask:w=[],maskAttributes:b=["title","placeholder"],unmask:E=[],block:I=[],unblock:S=[],ignore:T=[],maskFn:k,beforeAddRecordingEvent:A,beforeErrorSampling:x}={}){this.name=yc.id;const C=function({mask:e,unmask:t,block:n,unblock:r,ignore:i}){return{maskTextSelector:fc(e,[".sentry-mask","[data-sentry-mask]"]),unmaskTextSelector:fc(t,[]),blockSelector:fc(n,[".sentry-block","[data-sentry-block]",'base[href="/"]']),unblockSelector:fc(r,[]),ignoreSelector:fc(i,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'])}}({mask:w,unmask:E,block:I,unblock:S,ignore:T});if(this._recordingOptions={maskAllInputs:u,maskAllText:c,maskInputOptions:{password:!0},maskTextFn:k,maskInputFn:k,maskAttributeFn:(e,t,n)=>function({el:e,key:t,maskAttributes:n,maskAllText:r,privacyOptions:i,value:s}){return r?i.unmaskTextSelector&&e.matches(i.unmaskTextSelector)?s:n.includes(t)||"value"===t&&"INPUT"===e.tagName&&["submit","button"].includes(e.getAttribute("type")||"")?s.replace(/[\S]/g,"*"):s:s}({maskAttributes:b,maskAllText:c,privacyOptions:C,key:e,value:t,el:n}),...C,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:e=>{try{e.__rrweb__=!0}catch(e){}}},this._initialOptions={flushMinDelay:e,flushMaxDelay:t,minReplayDuration:Math.min(n,15e3),maxReplayDuration:Math.min(r,_i),stickySession:i,useCompression:s,workerUrl:o,blockAllMedia:l,maskAllInputs:u,maskAllText:c,mutationBreadcrumbLimit:h,mutationLimit:d,slowClickTimeout:f,slowClickIgnoreSelectors:p,networkDetailAllowUrls:m,networkDetailDenyUrls:g,networkCaptureBodies:y,networkRequestHeaders:vc(v),networkResponseHeaders:vc(_),beforeAddRecordingEvent:A,beforeErrorSampling:x,_experiments:a},this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${pc}`:pc),this._isInitialized&&Er())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return gc}set _isInitialized(e){gc=e}afterAllSetup(e){Er()&&!this._replay&&(this._setup(e),this._initialize(e))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:"session"===this._replay.recordingMode}):Promise.resolve()}flush(e){return this._replay?this._replay.isEnabled()?this._replay.sendBufferedReplayOrFlush(e):(this._replay.start(),Promise.resolve()):Promise.resolve()}getReplayId(){if(this._replay&&this._replay.isEnabled())return this._replay.getSessionId()}_initialize(e){this._replay&&(this._maybeLoadFromReplayCanvasIntegration(e),this._replay.initializeSampling())}_setup(e){const t=function(e,t){const n=t.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...B(e)},i=Yn(n.replaysSessionSampleRate),s=Yn(n.replaysOnErrorSampleRate);null==i&&null==s&&u((()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}));null!=i&&(r.sessionSampleRate=i);null!=s&&(r.errorSampleRate=s);return r}(this._initialOptions,e);this._replay=new dc({options:t,recordingOptions:this._recordingOptions})}_maybeLoadFromReplayCanvasIntegration(e){try{const t=e.getIntegrationByName("ReplayCanvas");if(!t)return;this._replay._canvas=t.getOptions()}catch(e){}}}function vc(e){return[...mc,...e.map((e=>e.toLowerCase()))]}yc.__initStatic();const _c=new Proxy(console,{get:(e,t)=>"release"==="MISSING_ENV_VAR".MODE?()=>{}:e[t].bind(e)});var wc=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};const bc=t().storage.local,Ec=t().storage.sync,Ic=()=>wc(void 0,void 0,void 0,(function*(){return Ec?yield Ec.clear():yield bc.clear(),!0}));var Sc,Tc,kc,Ac;!function(e){e.BUBBLE_ERROR_TO_BACKGROUND_SENTRY="BUBBLE_ERROR_TO_BACKGROUND_SENTRY",e.IS_SCRIPT_INJECTED="IS_SCRIPT_INJECTED",e.TOGGLE_POPUP="TOGGLE_POPUP",e.HIDE_POPUP="HIDE_POPUP",e.SHOW_POPUP="SHOW_POPUP",e.GET_USER_AUTH_STATE="GET_USER_AUTH_STATE",e.RELOAD_CURRENT_USER_AUTH_STATE="RELOAD_CURRENT_USER_AUTH_STATE",e.EMAIL_LOGIN="EMAIL_LOGIN",e.EMAIL_SIGN_UP="EMAIL_SIGN_UP",e.SIGN_IN_WITH_GOOGLE="SIGN_IN_WITH_GOOGLE",e.USER_AUTH_STATE_CHANGED="USER_AUTH_STATE_CHANGED",e.SIGN_OUT="SIGN_OUT",e.SEND_VERIFICATION_EMAIL="SEND_VERIFICATION_EMAIL",e.SEND_PASSWORD_RESET_EMAIL="SEND_PASSWORD_RESET_EMAIL",e.SEND_VERIFICATION_CODE_TO_PHONE="SEND_VERIFICATION_CODE_TO_PHONE",e.GET_FIREBASE_AUTH_INSTANCE="GET_FIREBASE_AUTH_INSTANCE",e.GET_SUGGESTED_COMMENTS="GET_SUGGESTED_COMMENTS",e.GET_RECENT_ACTIVITIES="GET_RECENT_ACTIVITIES",e.GET_SAVED_COMMANDS="GET_SAVED_COMMANDS",e.SAVE_COMMAND="SAVE_COMMAND",e.REMOVE_SAVED_COMMAND="REMOVE_SAVE_COMMAND",e.GET_SUBSCRIPTION_PLANS="GET_SUBSCRIPTION_PLANS",e.GET_SUBSCRIPTION_PAYMENT_URL="GET_SUBSCRIPTION_PAYMENT_URL",e.OPEN_NEW_TAB="OPEN_NEW_TAB",e.GET_SUBSCRIPTION_STATUS="GET_SUBSCRIPTION_STATUS",e.GET_BANNER_DETAILS="GET_BANNER_DETAILS",e.GET_WEB_APP_AUTH_DETAILS="GET_WEB_APP_AUTH_DETAILS",e.GET_WEB_APP_AUTH_SIGN_OUT="GET_WEB_APP_AUTH_SIGN_OUT",e.GET_MANAGE_SUBSCRIPTION_LINK="GET_MANAGE_SUBSCRIPTION_LINK",e.UPDATE_USER_DETAILS="UPDATE_USER_DETAILS",e.GET_USER_SUBSCRIPTION_DATA="GET_USER_SUBSCRIPTION_DATA",e.GET_SINGLE_COLLECTION_DATA="GET_SINGLE_COLLECTION_DATA",e.ADD_REVIEW="ADD_REVIEW",e.ADD_QUESTIONS="ADD_QUESTION",e.ADD_LINKEDIN_PROFILE="ADD_LINKEDIN_PROFILE",e.IS_PROFILE_SAVED="IS_PROFILE_SAVED",e.SAVED_PROFILE_LENGTH="SAVED_PROFILE_LENGTH",e.GET_PERSPONA="GET_PERSPONA",e.GET_SINGLE_PERSONA="GET_SINGLE_PERSONA",e.SEARCH_PERSONA="SEARCH_PERSONA",e.GET_TEMPLATES="GET_TEMPLATES",e.SEARCH_TEMPLATES="SEARCH_TEMPLATES",e.GET_LISTS="GET_LISTS",e.UPDATE_PROFILE_LISTS="UPDATE_PROFILE_LISTS",e.DELETE_LINKDIN_SAVE_PROFILE="DELETE_LINKDIN_SAVE_PROFILE",e.GET_SAVE_PROFILE_LISTS="GET_SAVE_PROFILE_LISTS",e.PROFILE_SUMMARY="PROFILE_SUMMARY",e.EXISTING_PROFILE_SUMMARY="EXISTING_PROFILE_SUMMARY",e.OLDER_VERSION_CHECK="OLDER_VERSION_CHECK",e.UPDATE_PROFILE_SUMMARY_ID="UPDATE_PROFILE_SUMMARY_ID",e.IS_COMMAND_SAVED="IS_COMMAND_SAVED",e.IS_LOGGED_OUT="IS_LOGGED_OUT",e.GET_CURRENT_URL="get_current_url",e.HANDLE_BUTTON_INSERTION_EXCEPTION="handle_button_insertion_exception"}(Sc||(Sc={})),function(e){e[e.Authenticated=0]="Authenticated",e[e.UnverifiedAuthenticated=1]="UnverifiedAuthenticated",e[e.Login=2]="Login",e[e.Register=3]="Register",e[e.ForgotPassword=4]="ForgotPassword",e[e.SendVerificationCodeInPhone=5]="SendVerificationCodeInPhone",e[e.VerifyPhoneNumber=6]="VerifyPhoneNumber",e[e.MyAccount=7]="MyAccount",e[e.setting=8]="setting",e[e.manageSubscripion=9]="manageSubscripion",e[e.UpgradePlan=10]="UpgradePlan",e[e.ShareWithFriend=11]="ShareWithFriend",e[e.QuestionsAndIssues=12]="QuestionsAndIssues"}(Tc||(Tc={})),function(e){e.HOME="home",e.MESSAGE="message",e.CREATE_POST="create_post",e.INVITATION_NOTE="invitation_note",e.PROFILE_HEADLINE="profile_headline",e.PROFILE_ABOUT="profile_about",e.RECOMMENDATION_TEXT="recommendation_text",e.SALES_MESSAGE_PAGE="sales_message_page",e.ADVICE="advice"}(kc||(kc={})),function(e){e.ASCENDING="asc",e.DESCENDING="desc"}(Ac||(Ac={}));const xc=5,Cc=5,Dc=5,Nc=5;var Oc;!function(e){e.POST_COMMENT="post_comment",e.PERSPECTIVE_COMMENT="contributed_article_comment",e.MESSAGE_REPLY="message_reply",e.COMMENT_REPLY="comment_reply",e.CREATE_POST="create_post",e.INVITATION_NOTE="invitation_note",e.PROFILE_HEADLINE="profile_headline",e.PROFILE_ABOUT="profile_about",e.ARTICLE_COMMENT="article_comment",e.ARTICLE_COMMENT_REPLY="article_comment_reply",e.RECOMMENDATION_TEXT="recommendation_text",e.RE_POST="re_post",e.PROFILE_SUMMARY="profile_summary"}(Oc||(Oc={}));Oc.POST_COMMENT,Oc.MESSAGE_REPLY,Oc.COMMENT_REPLY,Oc.CREATE_POST,Oc.RE_POST,Oc.INVITATION_NOTE,Oc.PROFILE_HEADLINE,Oc.PROFILE_ABOUT,Oc.ARTICLE_COMMENT,Oc.ARTICLE_COMMENT_REPLY,Oc.RECOMMENDATION_TEXT,Oc.PROFILE_SUMMARY,Oc.PERSPECTIVE_COMMENT;const Rc="https://us-central1-gptchromeextension.cloudfunctions.net/generatePostReply",Mc="last_language_used";var Pc;!function(e){e[e.FREE=0]="FREE",e[e.PRO=1]="PRO"}(Pc||(Pc={}));const Lc="prod_QDEMhGnqTkwTr0",Uc="price_1PMntuKLRkrcwJ5STo8EpaH0",Fc="price_1PQpT5KLRkrcwJ5SIVkFtfTQ",Bc="price_1PMntuKLRkrcwJ5SSWXxSbNp",Vc="FREE",jc="PREMIUM",$c="TEAMS_PREMIUM",Gc="TEAMS_MEMBER",qc="MONTH",zc="YEAR",Hc="active",Kc="past_due",Wc="canceled",Qc="trialing",Yc=(Pc.FREE,Pc.PRO,Pc.FREE,Pc.PRO,2e4),Jc=1e6;n(2935);var Xc=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};const Zc=()=>{var e;return null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent.includes("Firefox")},eu=Zc()?"browserAction":"action",tu=(Zc(),(e,n,r={})=>t().tabs.sendMessage(e,{action:n,data:r})),nu=(e,n={})=>{t().tabs.query({}).then((r=>Xc(void 0,void 0,void 0,(function*(){for(let i=0;i<r.length;i++){const s=r[i];try{s.id&&(yield t().tabs.sendMessage(s.id,{action:e,data:n}))}catch(e){}}})))).catch((e=>{_c.log({error:e})}))};const ru=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},iu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(ru(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw Error();const c=i<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},su=function(e){return function(e){const t=ru(e);return iu.encodeByteArray(t,!0)}(e).replace(/\./g,"")},ou=function(e){try{return iu.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};class au{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function cu(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function uu(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cu())}function lu(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function hu(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function du(){const e=cu();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function fu(){return!function(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pu(){return"object"==typeof indexedDB}class mu extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,mu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gu.prototype.create)}}class gu{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(yu,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new mu(r,o,n)}}const yu=/\{\$([^}]+)}/g;function vu(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(_u(n)&&_u(s)){if(!vu(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function _u(e){return null!==e&&"object"==typeof e}function wu(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function bu(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function Eu(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Iu{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Su),void 0===r.error&&(r.error=Su),void 0===r.complete&&(r.complete=Su);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function Su(){}function Tu(e){return e&&e._delegate?e._delegate:e}class ku{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Au="[DEFAULT]";class xu{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new au;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Au})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=Au){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=Au){return this.instances.has(e)}getOptions(e=Au){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===Au?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=Au){return this.component?this.component.multipleInstances?e:Au:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Cu{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new xu(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Du=[];var Nu;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Nu||(Nu={}));const Ou={debug:Nu.DEBUG,verbose:Nu.VERBOSE,info:Nu.INFO,warn:Nu.WARN,error:Nu.ERROR,silent:Nu.SILENT},Ru=Nu.INFO,Mu={[Nu.DEBUG]:"log",[Nu.VERBOSE]:"log",[Nu.INFO]:"info",[Nu.WARN]:"warn",[Nu.ERROR]:"error"},Pu=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=Mu[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class Lu{constructor(e){this.name=e,this._logLevel=Ru,this._logHandler=Pu,this._userLogHandler=null,Du.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Nu))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Ou[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Nu.DEBUG,...e),this._logHandler(this,Nu.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Nu.VERBOSE,...e),this._logHandler(this,Nu.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Nu.INFO,...e),this._logHandler(this,Nu.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Nu.WARN,...e),this._logHandler(this,Nu.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Nu.ERROR,...e),this._logHandler(this,Nu.ERROR,...e)}}let Uu,Fu;const Bu=new WeakMap,Vu=new WeakMap,ju=new WeakMap,$u=new WeakMap,Gu=new WeakMap;let qu={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Vu.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ju.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ku(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function zu(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Fu||(Fu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Wu(this),t),Ku(Bu.get(this))}:function(...t){return Ku(e.apply(Wu(this),t))}:function(t,...n){const r=e.call(Wu(this),t,...n);return ju.set(r,t.sort?t.sort():[t]),Ku(r)}}function Hu(e){return"function"==typeof e?zu(e):(e instanceof IDBTransaction&&function(e){if(Vu.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));Vu.set(e,t)}(e),t=e,(Uu||(Uu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,qu):e);var t}function Ku(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(Ku(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Bu.set(t,e)})).catch((()=>{})),Gu.set(t,e),t}(e);if($u.has(e))return $u.get(e);const t=Hu(e);return t!==e&&($u.set(e,t),Gu.set(t,e)),t}const Wu=e=>Gu.get(e);const Qu=["get","getKey","getAll","getAllKeys","count"],Yu=["put","add","delete","clear"],Ju=new Map;function Xu(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Ju.get(t))return Ju.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Yu.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Qu.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return Ju.set(t,s),s}qu=(e=>({...e,get:(t,n,r)=>Xu(t,n)||e.get(t,n,r),has:(t,n)=>!!Xu(t,n)||e.has(t,n)}))(qu);class Zu{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const el="@firebase/app",tl="0.7.30",nl=new Lu("@firebase/app"),rl="@firebase/app-compat",il="@firebase/analytics-compat",sl="@firebase/analytics",ol="@firebase/app-check-compat",al="@firebase/app-check",cl="@firebase/auth",ul="@firebase/auth-compat",ll="@firebase/database",hl="@firebase/database-compat",dl="@firebase/functions",fl="@firebase/functions-compat",pl="@firebase/installations",ml="@firebase/installations-compat",gl="@firebase/messaging",yl="@firebase/messaging-compat",vl="@firebase/performance",_l="@firebase/performance-compat",wl="@firebase/remote-config",bl="@firebase/remote-config-compat",El="@firebase/storage",Il="@firebase/storage-compat",Sl="@firebase/firestore",Tl="@firebase/firestore-compat",kl="firebase",Al="[DEFAULT]",xl={[el]:"fire-core",[rl]:"fire-core-compat",[sl]:"fire-analytics",[il]:"fire-analytics-compat",[al]:"fire-app-check",[ol]:"fire-app-check-compat",[cl]:"fire-auth",[ul]:"fire-auth-compat",[ll]:"fire-rtdb",[hl]:"fire-rtdb-compat",[dl]:"fire-fn",[fl]:"fire-fn-compat",[pl]:"fire-iid",[ml]:"fire-iid-compat",[gl]:"fire-fcm",[yl]:"fire-fcm-compat",[vl]:"fire-perf",[_l]:"fire-perf-compat",[wl]:"fire-rc",[bl]:"fire-rc-compat",[El]:"fire-gcs",[Il]:"fire-gcs-compat",[Sl]:"fire-fst",[Tl]:"fire-fst-compat","fire-js":"fire-js",[kl]:"fire-js-all"},Cl=new Map,Dl=new Map;function Nl(e,t){try{e.container.addComponent(t)}catch(n){nl.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ol(e){const t=e.name;if(Dl.has(t))return nl.debug(`There were multiple attempts to register component ${t}.`),!1;Dl.set(t,e);for(const t of Cl.values())Nl(t,e);return!0}function Rl(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const Ml=new gu("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Pl{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ku("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ml.create("app-deleted",{appName:this._name})}}const Ll="9.9.2";function Ul(e=Al){const t=Cl.get(e);if(!t)throw Ml.create("no-app",{appName:e});return t}function Fl(e,t,n){var r;let i=null!==(r=xl[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void nl.warn(e.join(" "))}Ol(new ku(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const Bl="firebase-heartbeat-store";let Vl=null;function jl(){return Vl||(Vl=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=Ku(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(Ku(o.result),e.oldVersion,e.newVersion,Ku(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Bl)}}).catch((e=>{throw Ml.create("idb-open",{originalErrorMessage:e.message})}))),Vl}async function $l(e,t){var n;try{const n=(await jl()).transaction(Bl,"readwrite"),r=n.objectStore(Bl);return await r.put(t,Gl(e)),n.done}catch(e){if(e instanceof mu)nl.warn(e.message);else{const t=Ml.create("idb-set",{originalErrorMessage:null===(n=e)||void 0===n?void 0:n.message});nl.warn(t.message)}}}function Gl(e){return`${e.name}!${e.options.appId}`}class ql{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Hl(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=zl();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=zl(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Kl(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Kl(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=su(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function zl(){return(new Date).toISOString().substring(0,10)}class Hl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!pu()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){var t;try{return(await jl()).transaction(Bl).objectStore(Bl).get(Gl(e))}catch(e){if(e instanceof mu)nl.warn(e.message);else{const n=Ml.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});nl.warn(n.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return $l(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return $l(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Kl(e){return su(JSON.stringify({version:2,heartbeats:e})).length}var Wl;Wl="",Ol(new ku("platform-logger",(e=>new Zu(e)),"PRIVATE")),Ol(new ku("heartbeat",(e=>new ql(e)),"PRIVATE")),Fl(el,tl,Wl),Fl(el,tl,"esm2017"),Fl("fire-js","");Fl("firebase","9.9.2","app");function Ql(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;function Yl(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Jl=Yl,Xl=new gu("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Zl=new Lu("@firebase/auth");function eh(e,...t){Zl.logLevel<=Nu.ERROR&&Zl.error(`Auth (${Ll}): ${e}`,...t)}function th(e,...t){throw ih(e,...t)}function nh(e,...t){return ih(e,...t)}function rh(e,t,n){const r=Object.assign(Object.assign({},Jl()),{[t]:n});return new gu("auth","Firebase",r).create(t,{appName:e.name})}function ih(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Xl.create(e,...t)}function sh(e,t,...n){if(!e)throw ih(t,...n)}function oh(e){const t="INTERNAL ASSERTION FAILED: "+e;throw eh(t),new Error(t)}function ah(e,t){e||oh(t)}const ch=new Map;function uh(e){ah(e instanceof Function,"Expected a class definition");let t=ch.get(e);return t?(ah(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ch.set(e,t),t)}function lh(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function hh(){return"http:"===dh()||"https:"===dh()}function dh(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class fh{constructor(e,t){this.shortDelay=e,this.longDelay=t,ah(t>e,"Short delay should be less than long delay!"),this.isMobile=uu()||hu()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(hh()||lu()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function ph(e,t){ah(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class mh{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void oh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void oh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void oh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const gh={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},yh=new fh(3e4,6e4);function vh(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function _h(e,t,n,r,i={}){return wh(e,i,(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=wu(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),mh.fetch()(Eh(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function wh(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},gh),t);try{const t=new Ih(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Sh(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Sh(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Sh(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Sh(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw rh(e,a,o);th(e,a)}}catch(t){if(t instanceof mu)throw t;th(e,"network-request-failed")}}async function bh(e,t,n,r,i={}){const s=await _h(e,t,n,r,i);return"mfaPendingCredential"in s&&th(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Eh(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?ph(e.config,i):`${e.config.apiScheme}://${i}`}class Ih{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(nh(this.auth,"network-request-failed"))),yh.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Sh(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=nh(e,t,r);return i.customData._tokenResponse=n,i}function Th(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function kh(e){return 1e3*Number(e)}function Ah(e){var t;const[n,r,i]=e.split(".");if(void 0===n||void 0===r||void 0===i)return eh("JWT malformed, contained fewer than 3 sections"),null;try{const e=ou(r);return e?JSON.parse(e):(eh("Failed to decode base64 JWT payload"),null)}catch(e){return eh("Caught error parsing JWT payload as JSON",null===(t=e)||void 0===t?void 0:t.toString()),null}}async function xh(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof mu&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Ch{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null===(e=t)||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Dh{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Th(this.lastLoginAt),this.creationTime=Th(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Nh(e){var t;const n=e.auth,r=await e.getIdToken(),i=await xh(e,async function(e,t){return _h(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));sh(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=Ql(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Dh(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class Oh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){sh(e.idToken,"internal-error"),sh(void 0!==e.idToken,"internal-error"),sh(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Ah(e);return sh(t,"internal-error"),sh(void 0!==t.exp,"internal-error"),sh(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return sh(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await wh(e,{},(async()=>{const n=wu({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Eh(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",mh.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Oh;return n&&(sh("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(sh("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(sh("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Oh,this.toJSON())}_performRefresh(){return oh("not implemented")}}function Rh(e,t){sh("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Mh{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Ql(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ch(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Dh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await xh(this,this.stsTokenManager.getToken(this.auth,e));return sh(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Tu(e),r=await n.getIdToken(t),i=Ah(r);sh(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Th(kh(i.auth_time)),issuedAtTime:Th(kh(i.iat)),expirationTime:Th(kh(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Tu(e);await Nh(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(sh(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Mh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){sh(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Nh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await xh(this,async function(e,t){return _h(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:_,isAnonymous:w,providerData:b,stsTokenManager:E}=t;sh(v&&E,e,"internal-error");const I=Oh.fromJSON(this.name,E);sh("string"==typeof v,e,"internal-error"),Rh(l,e.name),Rh(h,e.name),sh("boolean"==typeof _,e,"internal-error"),sh("boolean"==typeof w,e,"internal-error"),Rh(d,e.name),Rh(f,e.name),Rh(p,e.name),Rh(m,e.name),Rh(g,e.name),Rh(y,e.name);const S=new Mh({uid:v,auth:e,email:h,emailVerified:_,displayName:l,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:g,lastLoginAt:y});return b&&Array.isArray(b)&&(S.providerData=b.map((e=>Object.assign({},e)))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(e,t,n=!1){const r=new Oh;r.updateFromServerResponse(t);const i=new Mh({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Nh(i),i}}class Ph{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ph.type="NONE";const Lh=Ph;function Uh(e,t,n){return`firebase:${e}:${t}:${n}`}class Fh{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Uh(this.userKey,r.apiKey,i),this.fullPersistenceKey=Uh("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Mh._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Fh(uh(Lh),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||uh(Lh);const s=Uh(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=Mh._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new Fh(i,e,n)):new Fh(i,e,n)}}function Bh(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Gh(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Vh(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(zh(t))return"Blackberry";if(Hh(t))return"Webos";if(jh(t))return"Safari";if((t.includes("chrome/")||$h(t))&&!t.includes("edge/"))return"Chrome";if(qh(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Vh(e=cu()){return/firefox\//i.test(e)}function jh(e=cu()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function $h(e=cu()){return/crios\//i.test(e)}function Gh(e=cu()){return/iemobile/i.test(e)}function qh(e=cu()){return/android/i.test(e)}function zh(e=cu()){return/blackberry/i.test(e)}function Hh(e=cu()){return/webos/i.test(e)}function Kh(e=cu()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Wh(e=cu()){return Kh(e)||qh(e)||Hh(e)||zh(e)||/windows phone/i.test(e)||Gh(e)}function Qh(e,t=[]){let n;switch(e){case"Browser":n=Bh(cu());break;case"Worker":n=`${Bh(cu())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ll}/${r}`}class Yh{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){var t;if(this.auth.currentUser===e)return;const n=[];try{for(const t of this.queue)await t(e),t.onAbort&&n.push(t.onAbort)}catch(e){n.reverse();for(const e of n)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(t=e)||void 0===t?void 0:t.message})}}}class Jh{constructor(e,t,n){this.app=e,this.heartbeatServiceProvider=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zh(this),this.idTokenSubscription=new Zh(this),this.beforeStateQueue=new Yh(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xl,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=uh(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Fh.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return sh(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){var t;try{await Nh(e)}catch(e){if("auth/network-request-failed"!==(null===(t=e)||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Tu(e):null;return t&&sh(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&sh(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(uh(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new gu("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&uh(e)||this._popupRedirectResolver;sh(t,this,"argument-error"),this.redirectPersistenceManager=await Fh.create(this,[uh(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return sh(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return sh(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Qh(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());return n&&(t["X-Firebase-Client"]=n),t}}function Xh(e){return Tu(e)}class Zh{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Iu(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return sh(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class ed{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oh("not implemented")}_getIdTokenResponse(e){return oh("not implemented")}_linkToIdToken(e,t){return oh("not implemented")}_getReauthenticationResolver(e){return oh("not implemented")}}async function td(e,t){return _h(e,"POST","/v1/accounts:update",t)}async function nd(e,t){return _h(e,"POST","/v1/accounts:sendOobCode",vh(e,t))}class rd extends ed{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new rd(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new rd(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return bh(e,"POST","/v1/accounts:signInWithPassword",vh(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return bh(e,"POST","/v1/accounts:signInWithEmailLink",vh(e,t))}(e,{email:this._email,oobCode:this._password});default:th(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return td(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return bh(e,"POST","/v1/accounts:signInWithEmailLink",vh(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:th(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function id(e,t){return bh(e,"POST","/v1/accounts:signInWithIdp",vh(e,t))}class sd extends ed{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new sd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):th("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Ql(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new sd(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return id(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,id(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,id(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=wu(t)}return e}}const od={USER_NOT_FOUND:"user-not-found"};class ad extends ed{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ad({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ad({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return bh(e,"POST","/v1/accounts:signInWithPhoneNumber",vh(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await bh(e,"POST","/v1/accounts:signInWithPhoneNumber",vh(e,t));if(n.temporaryProof)throw Sh(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return bh(e,"POST","/v1/accounts:signInWithPhoneNumber",vh(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),od)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new ad({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class cd{constructor(e){var t,n,r,i,s,o;const a=bu(Eu(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);sh(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=bu(Eu(e)).link,n=t?bu(Eu(t)).deep_link_id:null,r=bu(Eu(e)).deep_link_id;return(r?bu(Eu(r)).link:null)||r||n||t||e}(e);try{return new cd(t)}catch(e){return null}}}class ud{constructor(){this.providerId=ud.PROVIDER_ID}static credential(e,t){return rd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=cd.parseLink(t);return sh(n,"argument-error"),rd._fromEmailAndCode(e,n.code,n.tenantId)}}ud.PROVIDER_ID="password",ud.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ud.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ld{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class hd extends ld{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class dd extends hd{constructor(){super("facebook.com")}static credential(e){return sd._fromParams({providerId:dd.PROVIDER_ID,signInMethod:dd.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dd.credentialFromTaggedObject(e)}static credentialFromError(e){return dd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return dd.credential(e.oauthAccessToken)}catch(e){return null}}}dd.FACEBOOK_SIGN_IN_METHOD="facebook.com",dd.PROVIDER_ID="facebook.com";class fd extends hd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return sd._fromParams({providerId:fd.PROVIDER_ID,signInMethod:fd.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return fd.credentialFromTaggedObject(e)}static credentialFromError(e){return fd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return fd.credential(t,n)}catch(e){return null}}}fd.GOOGLE_SIGN_IN_METHOD="google.com",fd.PROVIDER_ID="google.com";class pd extends hd{constructor(){super("github.com")}static credential(e){return sd._fromParams({providerId:pd.PROVIDER_ID,signInMethod:pd.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pd.credentialFromTaggedObject(e)}static credentialFromError(e){return pd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return pd.credential(e.oauthAccessToken)}catch(e){return null}}}pd.GITHUB_SIGN_IN_METHOD="github.com",pd.PROVIDER_ID="github.com";class md extends hd{constructor(){super("twitter.com")}static credential(e,t){return sd._fromParams({providerId:md.PROVIDER_ID,signInMethod:md.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return md.credentialFromTaggedObject(e)}static credentialFromError(e){return md.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return md.credential(t,n)}catch(e){return null}}}async function gd(e,t){return bh(e,"POST","/v1/accounts:signUp",vh(e,t))}md.TWITTER_SIGN_IN_METHOD="twitter.com",md.PROVIDER_ID="twitter.com";class yd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Mh._fromIdTokenResponse(e,n,r),s=vd(n);return new yd({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=vd(n);return new yd({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function vd(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class _d extends mu{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,_d.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new _d(e,t,n,r)}}function wd(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw _d._fromErrorAndOperation(e,n,t,r);throw n}))}async function bd(e,t,n=!1){const r=await xh(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return yd._forOperation(e,"link",r)}async function Ed(e,t,n=!1){var r;const{auth:i}=e,s="reauthenticate";try{const r=await xh(e,wd(i,s,t,e),n);sh(r.idToken,i,"internal-error");const o=Ah(r.idToken);sh(o,i,"internal-error");const{sub:a}=o;return sh(e.uid===a,i,"user-mismatch"),yd._forOperation(e,s,r)}catch(e){throw"auth/user-not-found"===(null===(r=e)||void 0===r?void 0:r.code)&&th(i,"user-mismatch"),e}}async function Id(e,t,n=!1){const r="signIn",i=await wd(e,r,t),s=await yd._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function Sd(e,t){return Id(Xh(e),t)}async function Td(e,t){const n=Xh(e),r=await async function(e,t){return bh(e,"POST","/v1/accounts:signInWithCustomToken",vh(e,t))}(n,{token:t,returnSecureToken:!0}),i=await yd._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}function kd(e,t,n){var r;sh((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),sh(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(sh(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(sh(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Ad(e,t,n){const r=Tu(e),i={requestType:"PASSWORD_RESET",email:t};n&&kd(r,i,n),await async function(e,t){return nd(e,t)}(r,i)}async function xd(e,t){const n=Tu(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&kd(n.auth,r,t);const{email:i}=await async function(e,t){return nd(e,t)}(n.auth,r);i!==e.email&&await e.reload()}new WeakMap;const Cd="__sak";class Dd{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Cd,"1"),this.storage.removeItem(Cd),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Nd extends Dd{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=cu();return jh(e)||Kh(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Wh(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);du()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Nd.type="LOCAL";const Od=Nd;class Rd extends Dd{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Rd.type="SESSION";const Md=Rd;class Pd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Pd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ld(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Pd.receivers=[];class Ud{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=Ld("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Fd(){return window}function Bd(){return void 0!==Fd().WorkerGlobalScope&&"function"==typeof Fd().importScripts}const Vd="firebaseLocalStorageDb",jd="firebaseLocalStorage",$d="fbase_key";class Gd{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function qd(e,t){return e.transaction([jd],t?"readwrite":"readonly").objectStore(jd)}function zd(){const e=indexedDB.open(Vd,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(jd,{keyPath:$d})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(jd)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Vd);return new Gd(e).toPromise()}(),t(await zd()))}))}))}async function Hd(e,t,n){const r=qd(e,!0).put({[$d]:t,value:n});return new Gd(r).toPromise()}function Kd(e,t){const n=qd(e,!0).delete(t);return new Gd(n).toPromise()}class Wd{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await zd()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Bd()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Pd._getInstance(Bd()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Ud(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zd();return await Hd(e,Cd,"1"),await Kd(e,Cd),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Hd(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=qd(e,!1).get(t),r=await new Gd(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Kd(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=qd(e,!1).getAll();return new Gd(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Wd.type="LOCAL";const Qd=Wd;function Yd(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=nh("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Jd(e){return`__${e}${Math.floor(1e6*Math.random())}`}const Xd=1e12;class Zd{constructor(e){this.auth=e,this.counter=Xd,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new ef(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Xd;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Xd;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Xd;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class ef{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;sh(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const tf=Jd("rcb"),nf=new fh(3e4,6e4);class rf{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=Fd().grecaptcha)||void 0===e?void 0:e.render)}load(e,t=""){return sh(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)?Promise.resolve(Fd().grecaptcha):new Promise(((n,r)=>{const i=Fd().setTimeout((()=>{r(nh(e,"network-request-failed"))}),nf.get());Fd()[tf]=()=>{Fd().clearTimeout(i),delete Fd()[tf];const s=Fd().grecaptcha;if(!s)return void r(nh(e,"internal-error"));const o=s.render;s.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};Yd(`https://www.google.com/recaptcha/api.js??${wu({onload:tf,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(i),r(nh(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=Fd().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class sf{async load(e){return new Zd(e)}clearedOneInstance(){}}const of="recaptcha",af={theme:"light",type:"image"};class cf{constructor(e,t=Object.assign({},af),n){this.parameters=t,this.type=of,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Xh(n),this.isInvisible="invisible"===this.parameters.size,sh("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof e?document.getElementById(e):e;sh(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new sf:new rf,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){sh(!this.parameters.sitekey,this.auth,"argument-error"),sh(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),sh("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"==typeof e)e(t);else if("string"==typeof e){const n=Fd()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){sh(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){sh(hh()&&!Bd(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await _h(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);sh(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return sh(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class uf{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ad._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function lf(e,t,n){var r;const i=await n.verify();try{let s;if(sh("string"==typeof i,e,"argument-error"),sh(n.type===of,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){sh("enroll"===t.type,e,"internal-error");const n=await function(e,t){return _h(e,"POST","/v2/accounts/mfaEnrollment:start",vh(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{sh("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;sh(n,e,"missing-multi-factor-info");const o=await function(e,t){return _h(e,"POST","/v2/accounts/mfaSignIn:start",vh(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return _h(e,"POST","/v1/accounts:sendVerificationCode",vh(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class hf{constructor(e){this.providerId=hf.PROVIDER_ID,this.auth=Xh(e)}verifyPhoneNumber(e,t){return lf(this.auth,e,Tu(t))}static credential(e,t){return ad._fromVerification(e,t)}static credentialFromResult(e){const t=e;return hf.credentialFromTaggedObject(t)}static credentialFromError(e){return hf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?ad._fromTokenResponse(t,n):null}}function df(e,t){return t?uh(t):(sh(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}hf.PROVIDER_ID="phone",hf.PHONE_SIGN_IN_METHOD="phone";class ff extends ed{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return id(e,this._buildIdpRequest())}_linkToIdToken(e,t){return id(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return id(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function pf(e){return Id(e.auth,new ff(e),e.bypassAuthState)}function mf(e){const{auth:t,user:n}=e;return sh(n,t,"internal-error"),Ed(n,new ff(e),e.bypassAuthState)}async function gf(e){const{auth:t,user:n}=e;return sh(n,t,"internal-error"),bd(n,new ff(e),e.bypassAuthState)}class yf{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return pf;case"linkViaPopup":case"linkViaRedirect":return gf;case"reauthViaPopup":case"reauthViaRedirect":return mf;default:th(this.auth,"internal-error")}}resolve(e){ah(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ah(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const vf=new fh(2e3,1e4);class _f extends yf{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,_f.currentPopupAction&&_f.currentPopupAction.cancel(),_f.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return sh(e,this.auth,"internal-error"),e}async onExecution(){ah(1===this.filter.length,"Popup operations only handle one event");const e=Ld();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(nh(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(nh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_f.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(nh(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,vf.get())};e()}}_f.currentPopupAction=null;const wf=new Map;class bf extends yf{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=wf.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Sf(t),r=If(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}wf.set(this.auth._key(),e)}return this.bypassAuthState||wf.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ef(e,t){wf.set(e._key(),t)}function If(e){return uh(e._redirectPersistence)}function Sf(e){return Uh("pendingRedirect",e.config.apiKey,e.name)}async function Tf(e,t,n=!1){const r=Xh(e),i=df(r,t),s=new bf(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class kf{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xf(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!xf(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(nh(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Af(e))}saveEventToCache(e){this.cachedEventUids.add(Af(e)),this.lastProcessedEventTime=Date.now()}}function Af(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function xf({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Cf=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Df=/^https?/;async function Nf(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return _h(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Of(e))return}catch(e){}th(e,"unauthorized-domain")}function Of(e){const t=lh(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Df.test(n))return!1;if(Cf.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Rf=new fh(3e4,6e4);function Mf(){const e=Fd().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let Pf=null;function Lf(e){return Pf=Pf||function(e){return new Promise(((t,n)=>{var r,i,s;function o(){Mf(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Mf(),n(nh(e,"network-request-failed"))},timeout:Rf.get()})}if(null===(i=null===(r=Fd().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Fd().gapi)||void 0===s?void 0:s.load)){const t=Jd("iframefcb");return Fd()[t]=()=>{gapi.load?o():n(nh(e,"network-request-failed"))},Yd(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Pf=null,e}))}(e),Pf}const Uf=new fh(5e3,15e3),Ff={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Bf=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Vf(e){const t=e.config;sh(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?ph(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ll},i=Bf.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${wu(r).slice(1)}`}const jf={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class $f{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Gf(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},jf),{width:r.toString(),height:i.toString(),top:s,left:o}),u=cu().toLowerCase();n&&(a=$h(u)?"_blank":n),Vh(u)&&(t=t||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=cu()){var t;return Kh(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new $f(null);const h=window.open(t||"",a,l);sh(h,e,"popup-blocked");try{h.focus()}catch(e){}return new $f(h)}const qf="__/auth/handler",zf="emulator/auth/handler";function Hf(e,t,n,r,i,s){sh(e.config.authDomain,e,"auth-domain-config-required"),sh(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ll,eventId:i};if(t instanceof ld){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof hd){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${qf}`;return ph(e,zf)}(e)}?${wu(a).slice(1)}`}const Kf="webStorageSupport";const Wf=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Md,this._completeRedirectFn=Tf,this._overrideRedirectResult=Ef}async _openPopup(e,t,n,r){var i;ah(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Gf(e,Hf(e,t,n,lh(),r),Ld())}async _openRedirect(e,t,n,r){var i;return await this._originValidation(e),i=Hf(e,t,n,lh(),r),Fd().location.href=i,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(ah(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await Lf(e),n=Fd().gapi;return sh(n,e,"internal-error"),t.open({where:document.body,url:Vf(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ff,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=nh(e,"network-request-failed"),s=Fd().setTimeout((()=>{r(i)}),Uf.get());function o(){Fd().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new kf(e);return t.register("authEvent",(t=>{sh(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Kf,{type:Kf},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[Kf];void 0!==i&&t(!!i),th(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Nf(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Wh()||jh()||Kh()}};var Qf,Yf="@firebase/auth",Jf="0.20.5";class Xf{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){sh(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}Qf="Browser",Ol(new ku("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),{apiKey:i,authDomain:s}=n.options;return((e,n)=>{sh(i&&!i.includes(":"),"invalid-api-key",{appName:e.name}),sh(!(null==s?void 0:s.includes(":")),"argument-error",{appName:e.name});const r={apiKey:i,authDomain:s,clientPlatform:Qf,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qh(Qf)},o=new Jh(e,n,r);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(uh);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(o,t),o})(n,r)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Ol(new ku("auth-internal",(e=>(e=>new Xf(e))(Xh(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Fl(Yf,Jf,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Qf)),Fl(Yf,Jf,"esm2017");var Zf,ep="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},tp={},np=np||{},rp=ep||self;function ip(){}function sp(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function op(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var ap="closure_uid_"+(1e9*Math.random()>>>0),cp=0;function up(e,t,n){return e.call.apply(e.bind,arguments)}function lp(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function hp(e,t,n){return(hp=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?up:lp).apply(null,arguments)}function dp(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function fp(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function pp(){this.s=this.s,this.o=this.o}var mp={};pp.prototype.s=!1,pp.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,ap)&&e[ap]||(e[ap]=++cp)}(this);delete mp[e]}},pp.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const gp=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},yp=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){const r=e.length,i="string"==typeof e?e.split(""):e;for(let s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function vp(e){return Array.prototype.concat.apply([],arguments)}function _p(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function wp(e){return/^[\s\xa0]*$/.test(e)}var bp,Ep=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Ip(e,t){return-1!=e.indexOf(t)}function Sp(e,t){return e<t?-1:e>t?1:0}e:{var Tp=rp.navigator;if(Tp){var kp=Tp.userAgent;if(kp){bp=kp;break e}}bp=""}function Ap(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function xp(e){const t={};for(const n in e)t[n]=e[n];return t}var Cp="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Dp(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<Cp.length;t++)n=Cp[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Np(e){return Np[" "](e),e}Np[" "]=ip;var Op,Rp,Mp=Ip(bp,"Opera"),Pp=Ip(bp,"Trident")||Ip(bp,"MSIE"),Lp=Ip(bp,"Edge"),Up=Lp||Pp,Fp=Ip(bp,"Gecko")&&!(Ip(bp.toLowerCase(),"webkit")&&!Ip(bp,"Edge"))&&!(Ip(bp,"Trident")||Ip(bp,"MSIE"))&&!Ip(bp,"Edge"),Bp=Ip(bp.toLowerCase(),"webkit")&&!Ip(bp,"Edge");function Vp(){var e=rp.document;return e?e.documentMode:void 0}e:{var jp="",$p=(Rp=bp,Fp?/rv:([^\);]+)(\)|;)/.exec(Rp):Lp?/Edge\/([\d\.]+)/.exec(Rp):Pp?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Rp):Bp?/WebKit\/(\S+)/.exec(Rp):Mp?/(?:Version)[ \/]?(\S+)/.exec(Rp):void 0);if($p&&(jp=$p?$p[1]:""),Pp){var Gp=Vp();if(null!=Gp&&Gp>parseFloat(jp)){Op=String(Gp);break e}}Op=jp}var qp,zp={};function Hp(){return function(e){var t=zp;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){let e=0;const t=Ep(String(Op)).split("."),n=Ep("9").split("."),r=Math.max(t.length,n.length);for(let o=0;0==e&&o<r;o++){var i=t[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;e=Sp(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||Sp(0==i[2].length,0==s[2].length)||Sp(i[2],s[2]),i=i[3],s=s[3]}while(0==e)}return 0<=e}))}if(rp.document&&Pp){var Kp=Vp();qp=Kp||(parseInt(Op,10)||void 0)}else qp=void 0;var Wp=qp,Qp=function(){if(!rp.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{rp.addEventListener("test",ip,t),rp.removeEventListener("test",ip,t)}catch(e){}return e}();function Yp(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function Jp(e,t){if(Yp.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Fp){e:{try{Np(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Xp[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Jp.Z.h.call(this)}}Yp.prototype.h=function(){this.defaultPrevented=!0},fp(Jp,Yp);var Xp={2:"touch",3:"pen",4:"mouse"};Jp.prototype.h=function(){Jp.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Zp="closure_listenable_"+(1e6*Math.random()|0),em=0;function tm(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++em,this.ca=this.fa=!1}function nm(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function rm(e){this.src=e,this.g={},this.h=0}function im(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=gp(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(nm(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function sm(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return i}return-1}rm.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=sm(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new tm(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var om="closure_lm_"+(1e6*Math.random()|0),am={};function cm(e,t,n,r,i){if(r&&r.once)return lm(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)cm(e,t[s],n,r,i);return null}return n=ym(n),e&&e[Zp]?e.N(t,n,op(r)?!!r.capture:!!r,i):um(e,t,n,!1,r,i)}function um(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=op(i)?!!i.capture:!!i,a=mm(e);if(a||(e[om]=a=new rm(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=pm;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Qp||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(fm(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function lm(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)lm(e,t[s],n,r,i);return null}return n=ym(n),e&&e[Zp]?e.O(t,n,op(r)?!!r.capture:!!r,i):um(e,t,n,!0,r,i)}function hm(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)hm(e,t[s],n,r,i);else r=op(r)?!!r.capture:!!r,n=ym(n),e&&e[Zp]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=sm(s=e.g[t],n,r,i))&&(nm(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=mm(e))&&(t=e.g[t.toString()],e=-1,t&&(e=sm(t,n,r,i)),(n=-1<e?t[e]:null)&&dm(n))}function dm(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[Zp])im(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(fm(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=mm(t))?(im(n,e),0==n.h&&(n.src=null,t[om]=null)):nm(e)}}}function fm(e){return e in am?am[e]:am[e]="on"+e}function pm(e,t){if(e.ca)e=!0;else{t=new Jp(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&dm(e),e=n.call(r,t)}return e}function mm(e){return(e=e[om])instanceof rm?e:null}var gm="__closure_events_fn_"+(1e9*Math.random()>>>0);function ym(e){return"function"==typeof e?e:(e[gm]||(e[gm]=function(t){return e.handleEvent(t)}),e[gm])}function vm(){pp.call(this),this.i=new rm(this),this.P=this,this.I=null}function _m(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new Yp(t,e);else if(t instanceof Yp)t.target=t.target||e;else{var i=t;Dp(t=new Yp(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=wm(o,r,!0,t)&&i}if(i=wm(o=t.g=e,r,!0,t)&&i,i=wm(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=wm(o=t.g=n[s],r,!1,t)&&i}function wm(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&im(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}fp(vm,pp),vm.prototype[Zp]=!0,vm.prototype.removeEventListener=function(e,t,n,r){hm(this,e,t,n,r)},vm.prototype.M=function(){if(vm.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)nm(n[r]);delete t.g[e],t.h--}}this.I=null},vm.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},vm.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var bm=rp.JSON.stringify;function Em(){var e=Cm;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Im,Sm=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Tm),(e=>e.reset()));class Tm{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function km(e){rp.setTimeout((()=>{throw e}),0)}function Am(e,t){Im||function(){var e=rp.Promise.resolve(void 0);Im=function(){e.then(Dm)}}(),xm||(Im(),xm=!0),Cm.add(e,t)}var xm=!1,Cm=new class{constructor(){this.h=this.g=null}add(e,t){const n=Sm.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function Dm(){for(var e;e=Em();){try{e.h.call(e.g)}catch(e){km(e)}var t=Sm;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}xm=!1}function Nm(e,t){vm.call(this),this.h=e||1,this.g=t||rp,this.j=hp(this.kb,this),this.l=Date.now()}function Om(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function Rm(e,t,n){if("function"==typeof e)n&&(e=hp(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=hp(e.handleEvent,e)}return 2147483647<Number(t)?-1:rp.setTimeout(e,t||0)}function Mm(e){e.g=Rm((()=>{e.g=null,e.i&&(e.i=!1,Mm(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}fp(Nm,vm),(Zf=Nm.prototype).da=!1,Zf.S=null,Zf.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),_m(this,"tick"),this.da&&(Om(this),this.start()))}},Zf.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Zf.M=function(){Nm.Z.M.call(this),Om(this),delete this.g};class Pm extends pp{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Mm(this)}M(){super.M(),this.g&&(rp.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lm(e){pp.call(this),this.h=e,this.g={}}fp(Lm,pp);var Um=[];function Fm(e,t,n,r){Array.isArray(n)||(n&&(Um[0]=n.toString()),n=Um);for(var i=0;i<n.length;i++){var s=cm(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Bm(e){Ap(e.g,(function(e,t){this.g.hasOwnProperty(t)&&dm(e)}),e),e.g={}}function Vm(){this.g=!0}function jm(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return bm(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Lm.prototype.M=function(){Lm.Z.M.call(this),Bm(this)},Lm.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Vm.prototype.Aa=function(){this.g=!1},Vm.prototype.info=function(){};var $m={},Gm=null;function qm(){return Gm=Gm||new vm}function zm(e){Yp.call(this,$m.Ma,e)}function Hm(e){const t=qm();_m(t,new zm(t,e))}function Km(e,t){Yp.call(this,$m.STAT_EVENT,e),this.stat=t}function Wm(e){const t=qm();_m(t,new Km(t,e))}function Qm(e,t){Yp.call(this,$m.Na,e),this.size=t}function Ym(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return rp.setTimeout((function(){e()}),t)}$m.Ma="serverreachability",fp(zm,Yp),$m.STAT_EVENT="statevent",fp(Km,Yp),$m.Na="timingevent",fp(Qm,Yp);var Jm={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Xm={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Zm(){}function eg(e){return e.h||(e.h=e.i())}function tg(){}Zm.prototype.h=null;var ng,rg={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ig(){Yp.call(this,"d")}function sg(){Yp.call(this,"c")}function og(){}function ag(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new Lm(this),this.P=ug,e=Up?125:void 0,this.W=new Nm(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new cg}function cg(){this.i=null,this.g="",this.h=!1}fp(ig,Yp),fp(sg,Yp),fp(og,Zm),og.prototype.g=function(){return new XMLHttpRequest},og.prototype.i=function(){return{}},ng=new og;var ug=45e3,lg={},hg={};function dg(e,t,n){e.K=1,e.v=Pg(Cg(t)),e.s=n,e.U=!0,fg(e,null)}function fg(e,t){e.F=Date.now(),yg(e),e.A=Cg(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),Wg(n.h,"t",r),e.C=0,n=e.l.H,e.h=new cg,e.g=Qy(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Pm(hp(e.Ia,e,e.g),e.O)),Fm(e.V,e.g,"readystatechange",e.gb),t=e.H?xp(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Hm(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function pg(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function mg(e,t,n){let r,i=!0;for(;!e.I&&e.C<n.length;){if(r=gg(e,n),r==hg){4==t&&(e.o=4,Wm(14),i=!1),jm(e.j,e.m,null,"[Incomplete Response]");break}if(r==lg){e.o=4,Wm(15),jm(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}jm(e.j,e.m,r,null),Eg(e,r)}pg(e)&&r!=hg&&r!=lg&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Wm(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),jy(t),t.L=!0,Wm(11))):(jm(e.j,e.m,n,"[Invalid Chunked Response]"),bg(e),wg(e))}function gg(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?hg:(n=Number(t.substring(n,r)),isNaN(n)?lg:(r+=1)+n>t.length?hg:(t=t.substr(r,n),e.C=r+n,t))}function yg(e){e.Y=Date.now()+e.P,vg(e,e.P)}function vg(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ym(hp(e.eb,e),t)}function _g(e){e.B&&(rp.clearTimeout(e.B),e.B=null)}function wg(e){0==e.l.G||e.I||qy(e.l,e)}function bg(e){_g(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Om(e.W),Bm(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Eg(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||ty(n.i,e)))if(n.I=e.N,!e.J&&ty(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;Gy(n),Oy(n)}Vy(n),Wm(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Ym(hp(n.ab,n),6e3));if(1>=ey(n.i)&&n.ka){try{n.ka()}catch(e){}n.ka=void 0}}else Hy(n,11)}else if((e.J||n.g==e)&&Gy(n),!wp(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.U=u[0],u=u[1],2==n.G)if("c"==u[0]){n.J=u[1],n.la=u[2];const t=u[3];null!=t&&(n.ma=t,n.h.info("VER="+n.ma));const i=u[4];null!=i&&(n.za=i,n.h.info("SVER="+n.za));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(r=1.5*l,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;!s.g&&(Ip(e,"spdy")||Ip(e,"quic")||Ip(e,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(ny(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.sa=e,Mg(r.F,r.D,e))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=e;if((r=n).oa=Wy(r,r.H?r.la:null,r.W),o.J){ry(r.i,o);var a=o,c=r.K;c&&a.setTimeout(c),a.B&&(_g(a),yg(a)),r.g=o}else By(r);0<n.l.length&&Py(n)}else"stop"!=u[0]&&"close"!=u[0]||Hy(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Hy(n,7):Ny(n):"noop"!=u[0]&&n.j&&n.j.wa(u),n.A=0)}Hm(4)}catch(e){}}function Ig(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(sp(e)||"string"==typeof e)yp(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(sp(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(sp(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function Sg(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Sg)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Tg(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];kg(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)kg(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function kg(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(Zf=ag.prototype).setTimeout=function(e){this.P=e},Zf.gb=function(e){e=e.target;const t=this.L;t&&3==ky(e)?t.l():this.Ia(e)},Zf.Ia=function(e){try{if(e==this.g)e:{const l=ky(this.g);var t=this.g.Da();const h=this.g.ba();if(!(3>l)&&(3!=l||Up||this.g&&(this.h.h||this.g.ga()||Ay(this.g)))){this.I||4!=l||7==t||Hm(8==t||0>=h?3:2),_g(this);var n=this.g.ba();this.N=n;t:if(pg(this)){var r=Ay(this.g);e="";var i=r.length,s=4==ky(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){bg(this),wg(this);var o="";break t}this.h.i=new rp.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,l,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wp(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,Wm(12),bg(this),wg(this);break e}jm(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Eg(this,n)}this.U?(mg(this,l,o),Up&&this.i&&3==l&&(Fm(this.V,this.W,"tick",this.fb),this.W.start())):(jm(this.j,this.m,o,null),Eg(this,o)),4==l&&bg(this),this.i&&!this.I&&(4==l?qy(this.l,this):(this.i=!1,yg(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Wm(12)):(this.o=0,Wm(13)),bg(this),wg(this)}}}catch(e){}},Zf.fb=function(){if(this.g){var e=ky(this.g),t=this.g.ga();this.C<t.length&&(_g(this),mg(this,e,t),this.i&&4!=e&&yg(this))}},Zf.cancel=function(){this.I=!0,bg(this)},Zf.eb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(Hm(3),Wm(17)),bg(this),this.o=2,wg(this)):vg(this,this.Y-e)},(Zf=Sg.prototype).R=function(){Tg(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},Zf.T=function(){return Tg(this),this.g.concat()},Zf.get=function(e,t){return kg(this.h,e)?this.h[e]:t},Zf.set=function(e,t){kg(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},Zf.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var Ag=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function xg(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof xg){this.g=void 0!==t?t:e.g,Dg(this,e.j),this.s=e.s,Ng(this,e.i),Og(this,e.m),this.l=e.l,t=e.h;var n=new qg;n.i=t.i,t.g&&(n.g=new Sg(t.g),n.h=t.h),Rg(this,n),this.o=e.o}else e&&(n=String(e).match(Ag))?(this.g=!!t,Dg(this,n[1]||"",!0),this.s=Lg(n[2]||""),Ng(this,n[3]||"",!0),Og(this,n[4]),this.l=Lg(n[5]||"",!0),Rg(this,n[6]||"",!0),this.o=Lg(n[7]||"")):(this.g=!!t,this.h=new qg(null,this.g))}function Cg(e){return new xg(e)}function Dg(e,t,n){e.j=n?Lg(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ng(e,t,n){e.i=n?Lg(t,!0):t}function Og(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Rg(e,t,n){t instanceof qg?(e.h=t,function(e,t){t&&!e.j&&(zg(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Hg(this,t),Wg(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=Ug(t,$g)),e.h=new qg(t,e.g))}function Mg(e,t,n){e.h.set(t,n)}function Pg(e){return Mg(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Lg(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ug(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Fg),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Fg(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}xg.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ug(t,Bg,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ug(t,Bg,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ug(n,"/"==n.charAt(0)?jg:Vg,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ug(n,Gg)),e.join("")};var Bg=/[#\/\?@]/g,Vg=/[#\?:]/g,jg=/[#\?]/g,$g=/[#\?@]/g,Gg=/#/g;function qg(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function zg(e){e.g||(e.g=new Sg,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Hg(e,t){zg(e),t=Qg(e,t),kg(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,kg((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Tg(e)))}function Kg(e,t){return zg(e),t=Qg(e,t),kg(e.g.h,t)}function Wg(e,t,n){Hg(e,t),0<n.length&&(e.i=null,e.g.set(Qg(e,t),_p(n)),e.h+=n.length)}function Qg(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Zf=qg.prototype).add=function(e,t){zg(this),this.i=null,e=Qg(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Zf.forEach=function(e,t){zg(this),this.g.forEach((function(n,r){yp(n,(function(n){e.call(t,n,r,this)}),this)}),this)},Zf.T=function(){zg(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},Zf.R=function(e){zg(this);var t=[];if("string"==typeof e)Kg(this,e)&&(t=vp(t,this.g.get(Qg(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=vp(t,e[n])}return t},Zf.set=function(e,t){return zg(this),this.i=null,Kg(this,e=Qg(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Zf.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},Zf.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var Yg=class{constructor(e,t){this.h=e,this.g=t}};function Jg(e){this.l=e||Xg,rp.PerformanceNavigationTiming?e=0<(e=rp.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(rp.g&&rp.g.Ea&&rp.g.Ea()&&rp.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Xg=10;function Zg(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ey(e){return e.h?1:e.g?e.g.size:0}function ty(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ny(e,t){e.g?e.g.add(t):e.h=t}function ry(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function iy(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return _p(e.i)}function sy(){}function oy(){this.g=new sy}function ay(e,t,n){const r=n||"";try{Ig(e,(function(e,n){let i=e;op(e)&&(i=bm(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function cy(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function uy(e){this.l=e.$b||null,this.j=e.ib||!1}function ly(e,t){vm.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=hy,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Jg.prototype.cancel=function(){if(this.i=iy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},sy.prototype.stringify=function(e){return rp.JSON.stringify(e,void 0)},sy.prototype.parse=function(e){return rp.JSON.parse(e,void 0)},fp(uy,Zm),uy.prototype.g=function(){return new ly(this.l,this.j)},uy.prototype.i=function(e){return function(){return e}}({}),fp(ly,vm);var hy=0;function dy(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function fy(e){e.readyState=4,e.l=null,e.j=null,e.A=null,py(e)}function py(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Zf=ly.prototype).open=function(e,t){if(this.readyState!=hy)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,py(this)},Zf.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||rp).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},Zf.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,fy(this)),this.readyState=hy},Zf.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,py(this)),this.g&&(this.readyState=3,py(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==rp.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;dy(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},Zf.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?fy(this):py(this),3==this.readyState&&dy(this)}},Zf.Ua=function(e){this.g&&(this.response=this.responseText=e,fy(this))},Zf.Ta=function(e){this.g&&(this.response=e,fy(this))},Zf.ha=function(){this.g&&fy(this)},Zf.setRequestHeader=function(e,t){this.v.append(e,t)},Zf.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Zf.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ly.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var my=rp.JSON.parse;function gy(e){vm.call(this),this.headers=new Sg,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=yy,this.K=this.L=!1}fp(gy,vm);var yy="",vy=/^https?$/i,_y=["POST","PUT"];function wy(e){return"content-type"==e.toLowerCase()}function by(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Ey(e),Sy(e)}function Ey(e){e.D||(e.D=!0,_m(e,"complete"),_m(e,"error"))}function Iy(e){if(e.h&&void 0!==np&&(!e.C[1]||4!=ky(e)||2!=e.ba()))if(e.v&&4==ky(e))Rm(e.Fa,0,e);else if(_m(e,"readystatechange"),4==ky(e)){e.h=!1;try{const a=e.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){var i=String(e.H).match(Ag)[1]||null;if(!i&&rp.self&&rp.self.location){var s=rp.self.location.protocol;i=s.substr(0,s.length-1)}r=!vy.test(i?i.toLowerCase():"")}n=r}if(n)_m(e,"complete"),_m(e,"success");else{e.m=6;try{var o=2<ky(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.ba()+"]",Ey(e)}}finally{Sy(e)}}}function Sy(e,t){if(e.g){Ty(e);const n=e.g,r=e.C[0]?ip:null;e.g=null,e.C=null,t||_m(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function Ty(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(rp.clearTimeout(e.A),e.A=null)}function ky(e){return e.g?e.g.readyState:0}function Ay(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case yy:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function xy(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){let t="";return Ap(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Mg(e,t,n))}function Cy(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Dy(e){this.za=0,this.l=[],this.h=new Vm,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Cy("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Cy("baseRetryDelayMs",5e3,e),this.$a=Cy("retryDelaySeedMs",1e4,e),this.Ya=Cy("forwardChannelMaxRetries",2,e),this.ra=Cy("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new Jg(e&&e.concurrentRequestLimit),this.Ca=new oy,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function Ny(e){if(Ry(e),3==e.G){var t=e.V++,n=Cg(e.F);Mg(n,"SID",e.J),Mg(n,"RID",t),Mg(n,"TYPE","terminate"),Uy(e,n),(t=new ag(e,e.h,t,void 0)).K=2,t.v=Pg(Cg(n)),n=!1,rp.navigator&&rp.navigator.sendBeacon&&(n=rp.navigator.sendBeacon(t.v.toString(),"")),!n&&rp.Image&&((new Image).src=t.v,n=!0),n||(t.g=Qy(t.l,null),t.g.ea(t.v)),t.F=Date.now(),yg(t)}Ky(e)}function Oy(e){e.g&&(jy(e),e.g.cancel(),e.g=null)}function Ry(e){Oy(e),e.u&&(rp.clearTimeout(e.u),e.u=null),Gy(e),e.i.cancel(),e.m&&("number"==typeof e.m&&rp.clearTimeout(e.m),e.m=null)}function My(e,t){e.l.push(new Yg(e.Za++,t)),3==e.G&&Py(e)}function Py(e){Zg(e.i)||e.m||(e.m=!0,Am(e.Ha,e),e.C=0)}function Ly(e,t){var n;n=t?t.m:e.V++;const r=Cg(e.F);Mg(r,"SID",e.J),Mg(r,"RID",n),Mg(r,"AID",e.U),Uy(e,r),e.o&&e.s&&xy(r,e.o,e.s),n=new ag(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Fy(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),ny(e.i,n),dg(n,r,t)}function Uy(e,t){e.j&&Ig({},(function(e,n){Mg(t,n,e)}))}function Fy(e,t,n){n=Math.min(e.l.length,n);var r=e.j?hp(e.j.Oa,e.j,e):null;e:{var i=e.l;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].h;const a=i[o].g;if(n-=t,0>n)t=Math.max(0,i[o].h-100),s=!1;else try{ay(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.l.splice(0,n),t.D=e,r}function By(e){e.g||e.u||(e.Y=1,Am(e.Ga,e),e.A=0)}function Vy(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=Ym(hp(e.Ga,e),zy(e,e.A)),e.A++,!0)}function jy(e){null!=e.B&&(rp.clearTimeout(e.B),e.B=null)}function $y(e){e.g=new ag(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=Cg(e.oa);Mg(t,"RID","rpc"),Mg(t,"SID",e.J),Mg(t,"CI",e.N?"0":"1"),Mg(t,"AID",e.U),Uy(e,t),Mg(t,"TYPE","xmlhttp"),e.o&&e.s&&xy(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=Pg(Cg(t)),n.s=null,n.U=!0,fg(n,e)}function Gy(e){null!=e.v&&(rp.clearTimeout(e.v),e.v=null)}function qy(e,t){var n=null;if(e.g==t){Gy(e),jy(e),e.g=null;var r=2}else{if(!ty(e.i,t))return;n=t.D,ry(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;_m(r=qm(),new Qm(r,n,t,i)),Py(e)}else By(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(ey(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=Ym(hp(e.Ha,e,t),zy(e,e.C)),e.C++,0)))}(e,t)||2==r&&Vy(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Hy(e,5);break;case 4:Hy(e,10);break;case 3:Hy(e,6);break;default:Hy(e,2)}}function zy(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function Hy(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=hp(e.jb,e);n||(n=new xg("//www.google.com/images/cleardot.gif"),rp.location&&"http"==rp.location.protocol||Dg(n,"https"),Pg(n)),function(e,t){const n=new Vm;if(rp.Image){const r=new Image;r.onload=dp(cy,n,r,"TestLoadImage: loaded",!0,t),r.onerror=dp(cy,n,r,"TestLoadImage: error",!1,t),r.onabort=dp(cy,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=dp(cy,n,r,"TestLoadImage: timeout",!1,t),rp.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Wm(2);e.G=0,e.j&&e.j.va(t),Ky(e),Ry(e)}function Ky(e){e.G=0,e.I=-1,e.j&&(0==iy(e.i).length&&0==e.l.length||(e.i.i.length=0,_p(e.l),e.l.length=0),e.j.ua())}function Wy(e,t,n){let r=function(e){return e instanceof xg?Cg(e):new xg(e,void 0)}(n);if(""!=r.i)t&&Ng(r,t+"."+r.i),Og(r,r.m);else{const e=rp.location;r=function(e,t,n,r){var i=new xg(null,void 0);return e&&Dg(i,e),t&&Ng(i,t),n&&Og(i,n),r&&(i.l=r),i}(e.protocol,t?t+"."+e.hostname:e.hostname,+e.port,n)}return e.aa&&Ap(e.aa,(function(e,t){Mg(r,t,e)})),t=e.D,n=e.sa,t&&n&&Mg(r,t,n),Mg(r,"VER",e.ma),Uy(e,r),r}function Qy(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new gy(new uy({ib:!0})):new gy(e.qa)).L=e.H,t}function Yy(){}function Jy(){if(Pp&&!(10<=Number(Wp)))throw Error("Environmental error: no available transport.")}function Xy(e,t){vm.call(this),this.g=new Dy(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!wp(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!wp(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new tv(this)}function Zy(e){ig.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ev(){sg.call(this),this.status=1}function tv(e){this.g=e}(Zf=gy.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ng.g(),this.C=this.u?eg(this.u):eg(ng),this.g.onreadystatechange=hp(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void by(this,e)}e=n||"";const i=new Sg(this.headers);r&&Ig(r,(function(e,t){i.set(t,e)})),r=function(e){e:{var t=wy;const n=e.length,r="string"==typeof e?e.split(""):e;for(let i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=rp.FormData&&e instanceof rp.FormData,!(0<=gp(_y,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Ty(this),0<this.B&&((this.K=function(e){return Pp&&Hp()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=hp(this.pa,this)):this.A=Rm(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){by(this,e)}},Zf.pa=function(){void 0!==np&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,_m(this,"timeout"),this.abort(8))},Zf.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,_m(this,"complete"),_m(this,"abort"),Sy(this))},Zf.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Sy(this,!0)),gy.Z.M.call(this)},Zf.Fa=function(){this.s||(this.F||this.v||this.l?Iy(this):this.cb())},Zf.cb=function(){Iy(this)},Zf.ba=function(){try{return 2<ky(this)?this.g.status:-1}catch(e){return-1}},Zf.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},Zf.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),my(t)}},Zf.Da=function(){return this.m},Zf.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Zf=Dy.prototype).ma=8,Zf.G=1,Zf.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(e){}},Zf.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new ag(this,this.h,e,void 0);let s=this.s;if(this.P&&(s?(s=xp(s),Dp(s,this.P)):s=this.P),null===this.o&&(i.H=s),this.ja)e:{for(var t=0,n=0;n<this.l.length;n++){var r=this.l[n];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.l.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Fy(this,i,t),Mg(n=Cg(this.F),"RID",e),Mg(n,"CVER",22),this.D&&Mg(n,"X-HTTP-Session-Id",this.D),Uy(this,n),this.o&&s&&xy(n,this.o,s),ny(this.i,i),this.Ra&&Mg(n,"TYPE","init"),this.ja?(Mg(n,"$req",t),Mg(n,"SID","null"),i.$=!0,dg(i,n,null)):dg(i,n,t),this.G=2}}else 3==this.G&&(e?Ly(this,e):0==this.l.length||Zg(this.i)||Ly(this))},Zf.Ga=function(){if(this.u=null,$y(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=Ym(hp(this.bb,this),e)}},Zf.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Wm(10),Oy(this),$y(this))},Zf.ab=function(){null!=this.v&&(this.v=null,Oy(this),Vy(this),Wm(19))},Zf.jb=function(e){e?(this.h.info("Successfully pinged google.com"),Wm(2)):(this.h.info("Failed to ping google.com"),Wm(1))},(Zf=Yy.prototype).xa=function(){},Zf.wa=function(){},Zf.va=function(){},Zf.ua=function(){},Zf.Oa=function(){},Jy.prototype.g=function(e,t){return new Xy(e,t)},fp(Xy,vm),Xy.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Am(hp(e.hb,e,t))),Wm(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Wy(e,null,e.W),Py(e)},Xy.prototype.close=function(){Ny(this.g)},Xy.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,My(this.g,t)}else this.v?((t={}).__data__=bm(e),My(this.g,t)):My(this.g,e)},Xy.prototype.M=function(){this.g.j=null,delete this.j,Ny(this.g),delete this.g,Xy.Z.M.call(this)},fp(Zy,ig),fp(ev,sg),fp(tv,Yy),tv.prototype.xa=function(){_m(this.g,"a")},tv.prototype.wa=function(e){_m(this.g,new Zy(e))},tv.prototype.va=function(e){_m(this.g,new ev(e))},tv.prototype.ua=function(){_m(this.g,"b")},Jy.prototype.createWebChannel=Jy.prototype.g,Xy.prototype.send=Xy.prototype.u,Xy.prototype.open=Xy.prototype.m,Xy.prototype.close=Xy.prototype.close,Jm.NO_ERROR=0,Jm.TIMEOUT=8,Jm.HTTP_ERROR=6,Xm.COMPLETE="complete",tg.EventType=rg,rg.OPEN="a",rg.CLOSE="b",rg.ERROR="c",rg.MESSAGE="d",vm.prototype.listen=vm.prototype.N,gy.prototype.listenOnce=gy.prototype.O,gy.prototype.getLastError=gy.prototype.La,gy.prototype.getLastErrorCode=gy.prototype.Da,gy.prototype.getStatus=gy.prototype.ba,gy.prototype.getResponseJson=gy.prototype.Qa,gy.prototype.getResponseText=gy.prototype.ga,gy.prototype.send=gy.prototype.ea;var nv=tp.createWebChannelTransport=function(){return new Jy},rv=tp.getStatEventTarget=function(){return qm()},iv=tp.ErrorCode=Jm,sv=tp.EventType=Xm,ov=tp.Event=$m,av=tp.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},cv=tp.FetchXmlHttpFactory=uy,uv=tp.WebChannel=tg,lv=tp.XhrIo=gy;const hv="@firebase/firestore";class dv{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}dv.UNAUTHENTICATED=new dv(null),dv.GOOGLE_CREDENTIALS=new dv("google-credentials-uid"),dv.FIRST_PARTY=new dv("first-party-uid"),dv.MOCK_USER=new dv("mock-user");let fv="9.9.2";const pv=new Lu("@firebase/firestore");function mv(){return pv.logLevel}function gv(e,...t){if(pv.logLevel<=Nu.DEBUG){const n=t.map(_v);pv.debug(`Firestore (${fv}): ${e}`,...n)}}function yv(e,...t){if(pv.logLevel<=Nu.ERROR){const n=t.map(_v);pv.error(`Firestore (${fv}): ${e}`,...n)}}function vv(e,...t){if(pv.logLevel<=Nu.WARN){const n=t.map(_v);pv.warn(`Firestore (${fv}): ${e}`,...n)}}function _v(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function wv(e="Unexpected state"){const t=`FIRESTORE (${fv}) INTERNAL ASSERTION FAILED: `+e;throw yv(t),new Error(t)}function bv(e,t){e||wv()}function Ev(e,t){return e}const Iv={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Sv extends mu{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Tv{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class kv{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Av{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(dv.UNAUTHENTICATED)))}shutdown(){}}class xv{constructor(e){this.t=e,this.currentUser=dv.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Tv;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Tv,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{gv("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(gv("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Tv)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(gv("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(bv("string"==typeof t.accessToken),new kv(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return bv(null===e||"string"==typeof e),new dv(e)}}class Cv{constructor(e,t,n){this.type="FirstParty",this.user=dv.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class Dv{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new Cv(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(dv.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Nv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ov{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const n=e=>{null!=e.error&&gv("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.p;return this.p=e.token,gv("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{gv("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.g.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.g.getImmediate({optional:!0});e?r(e):gv("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(bv("string"==typeof e.token),this.p=e.token,new Nv(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Rv(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class Mv{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=Rv(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function Pv(e,t){return e<t?-1:e>t?1:0}function Lv(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function Uv(e){return e+"\0"}class Fv{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Sv(Iv.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Sv(Iv.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Sv(Iv.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Sv(Iv.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Fv.fromMillis(Date.now())}static fromDate(e){return Fv.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Fv(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Pv(this.nanoseconds,e.nanoseconds):Pv(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Bv{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Bv(e)}static min(){return new Bv(new Fv(0,0))}static max(){return new Bv(new Fv(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Vv{constructor(e,t,n){void 0===t?t=0:t>e.length&&wv(),void 0===n?n=e.length-t:n>e.length-t&&wv(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Vv.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Vv?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class jv extends Vv{construct(e,t,n){return new jv(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Sv(Iv.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new jv(t)}static emptyPath(){return new jv([])}}const $v=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gv extends Vv{construct(e,t,n){return new Gv(e,t,n)}static isValidIdentifier(e){return $v.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gv.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Gv(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Sv(Iv.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Sv(Iv.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Sv(Iv.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Sv(Iv.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gv(t)}static emptyPath(){return new Gv([])}}class qv{constructor(e){this.path=e}static fromPath(e){return new qv(jv.fromString(e))}static fromName(e){return new qv(jv.fromString(e).popFirst(5))}static empty(){return new qv(jv.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===jv.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return jv.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qv(new jv(e.slice()))}}class zv{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function Hv(e){return e.fields.find((e=>2===e.kind))}function Kv(e){return e.fields.filter((e=>2!==e.kind))}zv.UNKNOWN_ID=-1;class Wv{constructor(e,t){this.fieldPath=e,this.kind=t}}class Qv{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Qv(0,Xv.min())}}function Yv(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Bv.fromTimestamp(1e9===r?new Fv(n+1,0):new Fv(n,r));return new Xv(i,qv.empty(),t)}function Jv(e){return new Xv(e.readTime,e.key,-1)}class Xv{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Xv(Bv.min(),qv.empty(),-1)}static max(){return new Xv(Bv.max(),qv.empty(),-1)}}function Zv(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=qv.comparator(e.documentKey,t.documentKey),0!==n?n:Pv(e.largestBatchId,t.largestBatchId))}const e_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class t_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function n_(e){if(e.code!==Iv.FAILED_PRECONDITION||e.message!==e_)throw e;gv("LocalStore","Unexpectedly lost primary lease")}class r_{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&wv(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new r_(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof r_?t:r_.resolve(t)}catch(e){return r_.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):r_.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):r_.reject(t)}static resolve(e){return new r_(((t,n)=>{t(e)}))}static reject(e){return new r_(((t,n)=>{n(e)}))}static waitFor(e){return new r_(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=r_.resolve(!1);for(const n of e)t=t.next((e=>e?r_.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new r_(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new r_(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class i_{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.T=new Tv,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{t.error?this.T.reject(new a_(e,t.error)):this.T.resolve()},this.transaction.onerror=t=>{const n=d_(t.target.error);this.T.reject(new a_(e,n))}}static open(e,t,n,r){try{return new i_(t,e.transaction(r,n))}catch(e){throw new a_(t,e)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(gv("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new u_(t)}}class s_{constructor(e,t,n){this.name=e,this.version=t,this.P=n,12.2===s_.v(cu())&&yv("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return gv("SimpleDb","Removing database:",e),l_(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!pu())return!1;if(s_.S())return!0;const e=cu(),t=s_.v(e),n=0<t&&t<10,r=s_.D(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static S(){var e;return"undefined"!=typeof process&&"YES"===(null===(e="MISSING_ENV_VAR")?void 0:e.C)}static N(e,t){return e.store(t)}static v(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static D(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async k(e){return this.db||(gv("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new a_(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Sv(Iv.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Sv(Iv.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new a_(e,r))},r.onupgradeneeded=e=>{gv("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.P.M(t,r.transaction,e.oldVersion,this.version).next((()=>{gv("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.O&&(this.db.onversionchange=e=>this.O(e)),this.db}F(e){this.O=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.k(e);const t=i_.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.R(),e))).catch((e=>(t.abort(e),r_.reject(e)))).toPromise();return s.catch((()=>{})),await t.A,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(gv("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class o_{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return l_(this.$.delete())}}class a_ extends Sv{constructor(e,t){super(Iv.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function c_(e){return"IndexedDbTransactionError"===e.name}class u_{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(gv("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(gv("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),l_(n)}add(e){return gv("SimpleDb","ADD",this.store.name,e,e),l_(this.store.add(e))}get(e){return l_(this.store.get(e)).next((t=>(void 0===t&&(t=null),gv("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return gv("SimpleDb","DELETE",this.store.name,e),l_(this.store.delete(e))}count(){return gv("SimpleDb","COUNT",this.store.name),l_(this.store.count())}K(e,t){const n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){const e=this.cursor(n),t=[];return this.G(e,((e,n)=>{t.push(n)})).next((()=>t))}{const e=this.store.getAll(n.range);return new r_(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new r_(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}W(e,t){gv("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const r=this.cursor(n);return this.G(r,((e,t,n)=>n.delete()))}J(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.G(r,t)}Y(e){const t=this.cursor({});return new r_(((n,r)=>{t.onerror=e=>{const t=d_(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}G(e,t){const n=[];return new r_(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new o_(i),o=t(i.primaryKey,i.value,s);if(o instanceof r_){const e=o.catch((e=>(s.done(),r_.reject(e))));n.push(e)}s.isDone?r():null===s.U?i.continue():i.continue(s.U)}})).next((()=>r_.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function l_(e){return new r_(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=d_(e.target.error);n(t)}}))}let h_=!1;function d_(e){const t=s_.v(cu());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Sv("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return h_||(h_=!0,setTimeout((()=>{throw e}),0)),e}}return e}class f_{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.Z(15)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}Z(e){gv("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{gv("IndexBackiller",`Documents written: ${await this.X.tt()}`)}catch(e){c_(e)?gv("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e):await n_(e)}await this.Z(1)}))}}class p_{constructor(e,t){this.localStore=e,this.persistence=t}async tt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.et(t,e)))}et(e,t){const n=new Set;let r=t,i=!0;return r_.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return gv("IndexBackiller",`Processing collection: ${t}`),this.nt(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}nt(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.st(r,n))).next((n=>(gv("IndexBackiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}st(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=Jv(t);Zv(r,n)>0&&(n=r)})),new Xv(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class m_{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.it(e),this.rt=e=>t.writeSequenceNumber(e))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function g_(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function y_(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function v_(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}m_.ot=-1;class __{constructor(e,t){this.comparator=e,this.root=t||b_.EMPTY}insert(e,t){return new __(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,b_.BLACK,null,null))}remove(e){return new __(this.comparator,this.root.remove(e,this.comparator).copy(null,null,b_.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new w_(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new w_(this.root,e,this.comparator,!1)}getReverseIterator(){return new w_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new w_(this.root,e,this.comparator,!0)}}class w_{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class b_{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:b_.RED,this.left=null!=r?r:b_.EMPTY,this.right=null!=i?i:b_.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new b_(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return b_.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return b_.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,b_.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,b_.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw wv();if(this.right.isRed())throw wv();const e=this.left.check();if(e!==this.right.check())throw wv();return e+(this.isRed()?0:1)}}b_.EMPTY=null,b_.RED=!0,b_.BLACK=!1,b_.EMPTY=new class{constructor(){this.size=0}get key(){throw wv()}get value(){throw wv()}get color(){throw wv()}get left(){throw wv()}get right(){throw wv()}copy(e,t,n,r,i){return this}insert(e,t,n){return new b_(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class E_{constructor(e){this.comparator=e,this.data=new __(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new I_(this.data.getIterator())}getIteratorFrom(e){return new I_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof E_))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new E_(this.comparator);return t.data=e,t}}class I_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function S_(e){return e.hasNext()?e.getNext():void 0}class T_{constructor(e){this.fields=e,e.sort(Gv.comparator)}static empty(){return new T_([])}unionWith(e){let t=new E_(Gv.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new T_(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Lv(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class k_{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new k_(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new k_(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pv(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}k_.EMPTY_BYTE_STRING=new k_("");const A_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function x_(e){if(bv(!!e),"string"==typeof e){let t=0;const n=A_.exec(e);if(bv(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:C_(e.seconds),nanos:C_(e.nanos)}}function C_(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function D_(e){return"string"==typeof e?k_.fromBase64String(e):k_.fromUint8Array(e)}function N_(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function O_(e){const t=e.mapValue.fields.__previous_value__;return N_(t)?O_(t):t}function R_(e){const t=x_(e.mapValue.fields.__local_write_time__.timestampValue);return new Fv(t.seconds,t.nanos)}class M_{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class P_{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new P_("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof P_&&e.projectId===this.projectId&&e.database===this.database}}function L_(e){return null==e}function U_(e){return 0===e&&1/e==-1/0}function F_(e){return"number"==typeof e&&Number.isInteger(e)&&!U_(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const B_={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},V_={nullValue:"NULL_VALUE"};function j_(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?N_(e)?4:tw(e)?9007199254740991:10:wv()}function $_(e,t){if(e===t)return!0;const n=j_(e);if(n!==j_(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return R_(e).isEqual(R_(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=x_(e.timestampValue),r=x_(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return D_(e.bytesValue).isEqual(D_(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return C_(e.geoPointValue.latitude)===C_(t.geoPointValue.latitude)&&C_(e.geoPointValue.longitude)===C_(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return C_(e.integerValue)===C_(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=C_(e.doubleValue),r=C_(t.doubleValue);return n===r?U_(n)===U_(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Lv(e.arrayValue.values||[],t.arrayValue.values||[],$_);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(g_(n)!==g_(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!$_(n[e],r[e])))return!1;return!0}(e,t);default:return wv()}}function G_(e,t){return void 0!==(e.values||[]).find((e=>$_(e,t)))}function q_(e,t){if(e===t)return 0;const n=j_(e),r=j_(t);if(n!==r)return Pv(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Pv(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=C_(e.integerValue||e.doubleValue),r=C_(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return z_(e.timestampValue,t.timestampValue);case 4:return z_(R_(e),R_(t));case 5:return Pv(e.stringValue,t.stringValue);case 6:return function(e,t){const n=D_(e),r=D_(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=Pv(n[e],r[e]);if(0!==t)return t}return Pv(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Pv(C_(e.latitude),C_(t.latitude));return 0!==n?n:Pv(C_(e.longitude),C_(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=q_(n[e],r[e]);if(t)return t}return Pv(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===B_.mapValue&&t===B_.mapValue)return 0;if(e===B_.mapValue)return 1;if(t===B_.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=Pv(r[e],s[e]);if(0!==t)return t;const o=q_(n[r[e]],i[s[e]]);if(0!==o)return o}return Pv(r.length,s.length)}(e.mapValue,t.mapValue);default:throw wv()}}function z_(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Pv(e,t);const n=x_(e),r=x_(t),i=Pv(n.seconds,r.seconds);return 0!==i?i:Pv(n.nanos,r.nanos)}function H_(e){return K_(e)}function K_(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=x_(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?D_(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,qv.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=K_(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${K_(e.fields[i])}`;return n+"}"}(e.mapValue):wv();var t,n}function W_(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Q_(e){return!!e&&"integerValue"in e}function Y_(e){return!!e&&"arrayValue"in e}function J_(e){return!!e&&"nullValue"in e}function X_(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Z_(e){return!!e&&"mapValue"in e}function ew(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return y_(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ew(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ew(e.arrayValue.values[n]);return t}return Object.assign({},e)}function tw(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function nw(e){return"nullValue"in e?V_:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?W_(P_.empty(),qv.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:wv()}function rw(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?W_(P_.empty(),qv.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?B_:wv()}function iw(e,t){const n=q_(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function sw(e,t){const n=q_(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class ow{constructor(e){this.value=e}static empty(){return new ow({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Z_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ew(t)}setAll(e){let t=Gv.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=ew(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Z_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $_(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Z_(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){y_(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new ow(ew(this.value))}}function aw(e){const t=[];return y_(e.fields,((e,n)=>{const r=new Gv([e]);if(Z_(n)){const e=aw(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new T_(t)}class cw{constructor(e,t,n,r,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.data=i,this.documentState=s}static newInvalidDocument(e){return new cw(e,0,Bv.min(),Bv.min(),ow.empty(),0)}static newFoundDocument(e,t,n){return new cw(e,1,t,Bv.min(),n,0)}static newNoDocument(e,t){return new cw(e,2,t,Bv.min(),ow.empty(),0)}static newUnknownDocument(e,t){return new cw(e,3,t,Bv.min(),ow.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ow.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ow.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Bv.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof cw&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cw(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class uw{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ut=null}}function lw(e,t=null,n=[],r=[],i=null,s=null,o=null){return new uw(e,t,n,r,i,s,o)}function hw(e){const t=Ev(e);if(null===t.ut){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>{return(t=e).field.canonicalString()+t.op.toString()+H_(t.value);var t})).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),L_(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>H_(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>H_(e))).join(",")),t.ut=e}return t.ut}function dw(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!xw(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(n=e.filters[i],r=t.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!$_(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Dw(e.startAt,t.startAt)&&Dw(e.endAt,t.endAt)}function fw(e){return qv.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function pw(e,t){return e.filters.filter((e=>e instanceof yw&&e.field.isEqual(t)))}function mw(e,t,n){let r=V_,i=!0;for(const n of pw(e,t)){let e=V_,t=!0;switch(n.op){case"<":case"<=":e=nw(n.value);break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=V_}iw({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];iw({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function gw(e,t,n){let r=B_,i=!0;for(const n of pw(e,t)){let e=B_,t=!0;switch(n.op){case">=":case">":e=rw(n.value),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=B_}sw({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];sw({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class yw extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,n):new vw(e,t,n):"array-contains"===t?new Ew(e,n):"in"===t?new Iw(e,n):"not-in"===t?new Sw(e,n):"array-contains-any"===t?new Tw(e,n):new yw(e,t,n)}static ct(e,t,n){return"in"===t?new _w(e,n):new ww(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(q_(t,this.value)):null!==t&&j_(this.value)===j_(t)&&this.at(q_(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return wv()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class vw extends yw{constructor(e,t,n){super(e,t,n),this.key=qv.fromName(n.referenceValue)}matches(e){const t=qv.comparator(e.key,this.key);return this.at(t)}}class _w extends yw{constructor(e,t){super(e,"in",t),this.keys=bw("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ww extends yw{constructor(e,t){super(e,"not-in",t),this.keys=bw("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function bw(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>qv.fromName(e.referenceValue)))}class Ew extends yw{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Y_(t)&&G_(t.arrayValue,this.value)}}class Iw extends yw{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&G_(this.value.arrayValue,t)}}class Sw extends yw{constructor(e,t){super(e,"not-in",t)}matches(e){if(G_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!G_(this.value.arrayValue,t)}}class Tw extends yw{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Y_(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>G_(this.value.arrayValue,e)))}}class kw{constructor(e,t){this.position=e,this.inclusive=t}}class Aw{constructor(e,t="asc"){this.field=e,this.dir=t}}function xw(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Cw(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?qv.comparator(qv.fromName(o.referenceValue),n.key):q_(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Dw(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!$_(e.position[n],t.position[n]))return!1;return!0}class Nw{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.lt=null,this.ft=null,this.startAt,this.endAt}}function Ow(e,t,n,r,i,s,o,a){return new Nw(e,t,n,r,i,s,o,a)}function Rw(e){return new Nw(e)}function Mw(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Pw(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Lw(e){for(const t of e.filters)if(t.ht())return t.field;return null}function Uw(e){return null!==e.collectionGroup}function Fw(e){const t=Ev(e);if(null===t.lt){t.lt=[];const e=Lw(t),n=Pw(t);if(null!==e&&null===n)e.isKeyField()||t.lt.push(new Aw(e)),t.lt.push(new Aw(Gv.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.lt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new Aw(Gv.keyField(),e))}}}return t.lt}function Bw(e){const t=Ev(e);if(!t.ft)if("F"===t.limitType)t.ft=lw(t.path,t.collectionGroup,Fw(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of Fw(t)){const t="desc"===n.dir?"asc":"desc";e.push(new Aw(n.field,t))}const n=t.endAt?new kw(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new kw(t.startAt.position,t.startAt.inclusive):null;t.ft=lw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.ft}function Vw(e,t,n){return new Nw(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function jw(e,t){return dw(Bw(e),Bw(t))&&e.limitType===t.limitType}function $w(e){return`${hw(Bw(e))}|lt:${e.limitType}`}function Gw(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>{return`${(t=e).field.canonicalString()} ${t.op} ${H_(t.value)}`;var t})).join(", ")}]`),L_(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>H_(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>H_(e))).join(",")),`Target(${t})`}(Bw(e))}; limitType=${e.limitType})`}function qw(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):qv.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Cw(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Fw(e),t))&&!(e.endAt&&!function(e,t,n){const r=Cw(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Fw(e),t))}(e,t)}function zw(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Hw(e){return(t,n)=>{let r=!1;for(const i of Fw(e)){const e=Kw(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Kw(e,t,n){const r=e.field.isKeyField()?qv.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?q_(r,i):wv()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return wv()}}function Ww(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:U_(t)?"-0":t}}function Qw(e){return{integerValue:""+e}}function Yw(e,t){return F_(t)?Qw(t):Ww(e,t)}class Jw{constructor(){this._=void 0}}function Xw(e,t,n){return e instanceof tb?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof nb?rb(e,t):e instanceof ib?sb(e,t):function(e,t){const n=eb(e,t),r=ab(n)+ab(e._t);return Q_(n)&&Q_(e._t)?Qw(r):Ww(e.wt,r)}(e,t)}function Zw(e,t,n){return e instanceof nb?rb(e,t):e instanceof ib?sb(e,t):n}function eb(e,t){return e instanceof ob?Q_(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class tb extends Jw{}class nb extends Jw{constructor(e){super(),this.elements=e}}function rb(e,t){const n=cb(t);for(const t of e.elements)n.some((e=>$_(e,t)))||n.push(t);return{arrayValue:{values:n}}}class ib extends Jw{constructor(e){super(),this.elements=e}}function sb(e,t){let n=cb(t);for(const t of e.elements)n=n.filter((e=>!$_(e,t)));return{arrayValue:{values:n}}}class ob extends Jw{constructor(e,t){super(),this.wt=e,this._t=t}}function ab(e){return C_(e.integerValue||e.doubleValue)}function cb(e){return Y_(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class ub{constructor(e,t){this.field=e,this.transform=t}}class lb{constructor(e,t){this.version=e,this.transformResults=t}}class hb{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hb}static exists(e){return new hb(void 0,e)}static updateTime(e){return new hb(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function db(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class fb{}function pb(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Sb(e.key,hb.none()):new _b(e.key,e.data,hb.none());{const n=e.data,r=ow.empty();let i=new E_(Gv.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new wb(e.key,r,new T_(i.toArray()),hb.none())}}function mb(e,t,n){e instanceof _b?function(e,t,n){const r=e.value.clone(),i=Eb(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof wb?function(e,t,n){if(!db(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Eb(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(bb(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function gb(e,t,n,r){return e instanceof _b?function(e,t,n,r){if(!db(e.precondition,t))return n;const i=e.value.clone(),s=Ib(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof wb?function(e,t,n,r){if(!db(e.precondition,t))return n;const i=Ib(e.fieldTransforms,r,t),s=t.data;return s.setAll(bb(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return db(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function yb(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=eb(r.transform,e||null);null!=i&&(null===n&&(n=ow.empty()),n.set(r.field,i))}return n||null}function vb(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Lv(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof nb&&t instanceof nb||e instanceof ib&&t instanceof ib?Lv(e.elements,t.elements,$_):e instanceof ob&&t instanceof ob?$_(e._t,t._t):e instanceof tb&&t instanceof tb}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class _b extends fb{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class wb extends fb{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function bb(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Eb(e,t,n){const r=new Map;bv(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Zw(o,a,n[i]))}return r}function Ib(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Xw(e,s,t))}return r}class Sb extends fb{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Tb extends fb{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class kb{constructor(e){this.count=e}}var Ab,xb;function Cb(e){switch(e){default:return wv();case Iv.CANCELLED:case Iv.UNKNOWN:case Iv.DEADLINE_EXCEEDED:case Iv.RESOURCE_EXHAUSTED:case Iv.INTERNAL:case Iv.UNAVAILABLE:case Iv.UNAUTHENTICATED:return!1;case Iv.INVALID_ARGUMENT:case Iv.NOT_FOUND:case Iv.ALREADY_EXISTS:case Iv.PERMISSION_DENIED:case Iv.FAILED_PRECONDITION:case Iv.ABORTED:case Iv.OUT_OF_RANGE:case Iv.UNIMPLEMENTED:case Iv.DATA_LOSS:return!0}}function Db(e){if(void 0===e)return yv("GRPC error has no .code"),Iv.UNKNOWN;switch(e){case Ab.OK:return Iv.OK;case Ab.CANCELLED:return Iv.CANCELLED;case Ab.UNKNOWN:return Iv.UNKNOWN;case Ab.DEADLINE_EXCEEDED:return Iv.DEADLINE_EXCEEDED;case Ab.RESOURCE_EXHAUSTED:return Iv.RESOURCE_EXHAUSTED;case Ab.INTERNAL:return Iv.INTERNAL;case Ab.UNAVAILABLE:return Iv.UNAVAILABLE;case Ab.UNAUTHENTICATED:return Iv.UNAUTHENTICATED;case Ab.INVALID_ARGUMENT:return Iv.INVALID_ARGUMENT;case Ab.NOT_FOUND:return Iv.NOT_FOUND;case Ab.ALREADY_EXISTS:return Iv.ALREADY_EXISTS;case Ab.PERMISSION_DENIED:return Iv.PERMISSION_DENIED;case Ab.FAILED_PRECONDITION:return Iv.FAILED_PRECONDITION;case Ab.ABORTED:return Iv.ABORTED;case Ab.OUT_OF_RANGE:return Iv.OUT_OF_RANGE;case Ab.UNIMPLEMENTED:return Iv.UNIMPLEMENTED;case Ab.DATA_LOSS:return Iv.DATA_LOSS;default:return wv()}}(xb=Ab||(Ab={}))[xb.OK=0]="OK",xb[xb.CANCELLED=1]="CANCELLED",xb[xb.UNKNOWN=2]="UNKNOWN",xb[xb.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xb[xb.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xb[xb.NOT_FOUND=5]="NOT_FOUND",xb[xb.ALREADY_EXISTS=6]="ALREADY_EXISTS",xb[xb.PERMISSION_DENIED=7]="PERMISSION_DENIED",xb[xb.UNAUTHENTICATED=16]="UNAUTHENTICATED",xb[xb.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xb[xb.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xb[xb.ABORTED=10]="ABORTED",xb[xb.OUT_OF_RANGE=11]="OUT_OF_RANGE",xb[xb.UNIMPLEMENTED=12]="UNIMPLEMENTED",xb[xb.INTERNAL=13]="INTERNAL",xb[xb.UNAVAILABLE=14]="UNAVAILABLE",xb[xb.DATA_LOSS=15]="DATA_LOSS";class Nb{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){y_(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return v_(this.inner)}size(){return this.innerSize}}const Ob=new __(qv.comparator);function Rb(){return Ob}const Mb=new __(qv.comparator);function Pb(...e){let t=Mb;for(const n of e)t=t.insert(n.key,n);return t}function Lb(e){let t=Mb;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Ub(){return Bb()}function Fb(){return Bb()}function Bb(){return new Nb((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Vb=new __(qv.comparator),jb=new E_(qv.comparator);function $b(...e){let t=jb;for(const n of e)t=t.add(n);return t}const Gb=new E_(Pv);function qb(){return Gb}class zb{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,Hb.createSynthesizedTargetChangeForCurrentChange(e,t)),new zb(Bv.min(),n,qb(),Rb(),$b())}}class Hb{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new Hb(k_.EMPTY_BYTE_STRING,t,$b(),$b(),$b())}}class Kb{constructor(e,t,n,r){this.gt=e,this.removedTargetIds=t,this.key=n,this.yt=r}}class Wb{constructor(e,t){this.targetId=e,this.It=t}}class Qb{constructor(e,t,n=k_.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Yb{constructor(){this.Tt=0,this.Et=Zb(),this.At=k_.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=$b(),t=$b(),n=$b();return this.Et.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:wv()}})),new Hb(this.At,this.Rt,e,t,n)}Dt(){this.bt=!1,this.Et=Zb()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Mt(){this.bt=!0,this.Rt=!0}}class Jb{constructor(e){this.Ot=e,this.Ft=new Map,this.$t=Rb(),this.Bt=Xb(),this.Lt=new E_(Pv)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,(t=>{const n=this.Qt(t);switch(e.state){case 0:this.jt(t)&&n.Vt(e.resumeToken);break;case 1:n.kt(),n.Pt||n.Dt(),n.Vt(e.resumeToken);break;case 2:n.kt(),n.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(n.Mt(),n.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),n.Vt(e.resumeToken));break;default:wv()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach(((e,n)=>{this.jt(n)&&t(n)}))}zt(e){const t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){const e=r.target;if(fw(e))if(0===n){const n=new qv(e.path);this.Kt(t,n,cw.newNoDocument(n,Bv.min()))}else bv(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach(((n,r)=>{const i=this.Ht(r);if(i){if(n.current&&fw(i.target)){const t=new qv(i.target.path);null!==this.$t.get(t)||this.Xt(r,t)||this.Kt(r,t,cw.newNoDocument(t,e))}n.vt&&(t.set(r,n.St()),n.Dt())}}));let n=$b();this.Bt.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Ht(e);return!t||2===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.$t.forEach(((t,n)=>n.setReadTime(e)));const r=new zb(e,t,this.Lt,this.$t,n);return this.$t=Rb(),this.Bt=Xb(),this.Lt=new E_(Pv),r}qt(e,t){if(!this.jt(e))return;const n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,n){if(!this.jt(e))return;const r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Ot.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new Yb,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new E_(Pv),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||gv("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Ot.te(e)}Wt(e){this.Ft.set(e,new Yb),this.Ot.getRemoteKeysForTarget(e).forEach((t=>{this.Kt(e,t,null)}))}Xt(e,t){return this.Ot.getRemoteKeysForTarget(e).has(t)}}function Xb(){return new __(qv.comparator)}function Zb(){return new __(qv.comparator)}const eE={asc:"ASCENDING",desc:"DESCENDING"},tE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class nE{constructor(e,t){this.databaseId=e,this.dt=t}}function rE(e,t){return e.dt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function iE(e,t){return e.dt?t.toBase64():t.toUint8Array()}function sE(e,t){return rE(e,t.toTimestamp())}function oE(e){return bv(!!e),Bv.fromTimestamp(function(e){const t=x_(e);return new Fv(t.seconds,t.nanos)}(e))}function aE(e,t){return function(e){return new jv(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function cE(e){const t=jv.fromString(e);return bv(DE(t)),t}function uE(e,t){return aE(e.databaseId,t.path)}function lE(e,t){const n=cE(t);if(n.get(1)!==e.databaseId.projectId)throw new Sv(Iv.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Sv(Iv.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new qv(pE(n))}function hE(e,t){return aE(e.databaseId,t)}function dE(e){const t=cE(e);return 4===t.length?jv.emptyPath():pE(t)}function fE(e){return new jv(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function pE(e){return bv(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function mE(e,t,n){return{name:uE(e,t),fields:n.value.mapValue.fields}}function gE(e,t,n){const r=lE(e,t.name),i=oE(t.updateTime),s=new ow({mapValue:{fields:t.fields}}),o=cw.newFoundDocument(r,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function yE(e,t){let n;if(t instanceof _b)n={update:mE(e,t.key,t.value)};else if(t instanceof Sb)n={delete:uE(e,t.key)};else if(t instanceof wb)n={update:mE(e,t.key,t.data),updateMask:CE(t.fieldMask)};else{if(!(t instanceof Tb))return wv();n={verify:uE(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof tb)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof nb)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ib)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof ob)return{fieldPath:t.field.canonicalString(),increment:n._t};throw wv()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:sE(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:wv()}(e,t.precondition)),n}function vE(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?hb.updateTime(oE(e.updateTime)):void 0!==e.exists?hb.exists(e.exists):hb.none()}(t.currentDocument):hb.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)bv("REQUEST_TIME"===t.setToServerValue),n=new tb;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new nb(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new ib(e)}else"increment"in t?n=new ob(e,t.increment):wv();const r=Gv.fromServerFormat(t.fieldPath);return new ub(r,n)}(e,t))):[];if(t.update){t.update.name;const i=lE(e,t.update.name),s=new ow({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new T_(t.map((e=>Gv.fromServerFormat(e))))}(t.updateMask);return new wb(i,s,e,n,r)}return new _b(i,s,n,r)}if(t.delete){const r=lE(e,t.delete);return new Sb(r,n)}if(t.verify){const r=lE(e,t.verify);return new Tb(r,n)}return wv()}function _E(e,t){return{documents:[hE(e,t.path)]}}function wE(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=hE(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=hE(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map((e=>function(e){if("=="===e.op){if(X_(e.value))return{unaryFilter:{field:TE(e.field),op:"IS_NAN"}};if(J_(e.value))return{unaryFilter:{field:TE(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(X_(e.value))return{unaryFilter:{field:TE(e.field),op:"IS_NOT_NAN"}};if(J_(e.value))return{unaryFilter:{field:TE(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:TE(e.field),op:SE(e.op),value:e.value}}}(e)));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:TE(e.field),direction:IE(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(e,t){return e.dt||L_(t)?t:{value:t}}(e,t.limit);var a;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function bE(e){let t=dE(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){bv(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=EE(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new Aw(kE(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,L_(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new kw(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new kw(n,t)}(n.endAt)),Ow(t,i,o,s,a,"F",c,u)}function EE(e){return e?void 0!==e.unaryFilter?[xE(e)]:void 0!==e.fieldFilter?[AE(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((e=>EE(e))).reduce(((e,t)=>e.concat(t))):wv():[]}function IE(e){return eE[e]}function SE(e){return tE[e]}function TE(e){return{fieldPath:e.canonicalString()}}function kE(e){return Gv.fromServerFormat(e.fieldPath)}function AE(e){return yw.create(kE(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return wv()}}(e.fieldFilter.op),e.fieldFilter.value)}function xE(e){switch(e.unaryFilter.op){case"IS_NAN":const t=kE(e.unaryFilter.field);return yw.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=kE(e.unaryFilter.field);return yw.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=kE(e.unaryFilter.field);return yw.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=kE(e.unaryFilter.field);return yw.create(i,"!=",{nullValue:"NULL_VALUE"});default:return wv()}}function CE(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function DE(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function NE(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=RE(t)),t=OE(e.get(n),t);return RE(t)}function OE(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function RE(e){return e+""}function ME(e){const t=e.length;if(bv(t>=2),2===t)return bv(""===e.charAt(0)&&""===e.charAt(1)),jv.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&wv(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:wv()}s=t+2}return new jv(r)}const PE=["userId","batchId"];function LE(e,t){return[e,NE(t)]}function UE(e,t,n){return[e,NE(t),n]}const FE={},BE=["prefixPath","collectionGroup","readTime","documentId"],VE=["prefixPath","collectionGroup","documentId"],jE=["collectionGroup","readTime","prefixPath","documentId"],$E=["canonicalId","targetId"],GE=["targetId","path"],qE=["path","targetId"],zE=["collectionId","parent"],HE=["indexId","uid"],KE=["uid","sequenceNumber"],WE=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],QE=["indexId","uid","orderedDocumentKey"],YE=["userId","collectionPath","documentId"],JE=["userId","collectionPath","largestBatchId"],XE=["userId","collectionGroup","largestBatchId"],ZE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],eI=[...ZE,"documentOverlays"],tI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],nI=tI,rI=[...nI,"indexConfiguration","indexState","indexEntries"];class iI extends t_{constructor(e,t){super(),this.ee=e,this.currentSequenceNumber=t}}function sI(e,t){const n=Ev(e);return s_.N(n.ee,t)}class oI{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&mb(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=gb(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=gb(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Fb();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=pb(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Bv.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),$b())}isEqual(e){return this.batchId===e.batchId&&Lv(this.mutations,e.mutations,((e,t)=>vb(e,t)))&&Lv(this.baseMutations,e.baseMutations,((e,t)=>vb(e,t)))}}class aI{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){bv(e.mutations.length===n.length);let r=Vb;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new aI(e,t,n,r)}}class cI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class uI{constructor(e,t,n,r,i=Bv.min(),s=Bv.min(),o=k_.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new uI(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new uI(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new uI(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class lI{constructor(e){this.ne=e}}function hI(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:dI(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:uE(e,t.key),fields:t.data.value.mapValue.fields,updateTime:rE(e,t.version.toTimestamp())}}(e.ne,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:fI(t.version)};else{if(!t.isUnknownDocument())return wv();r.unknownDocument={path:n.path.toArray(),version:fI(t.version)}}return r}function dI(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function fI(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function pI(e){const t=new Fv(e.seconds,e.nanoseconds);return Bv.fromTimestamp(t)}function mI(e,t){const n=(t.baseMutations||[]).map((t=>vE(e.ne,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>vE(e.ne,t))),i=Fv.fromMillis(t.localWriteTimeMs);return new oI(t.batchId,i,n,r)}function gI(e){const t=pI(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?pI(e.lastLimboFreeSnapshotVersion):Bv.min();let r;var i;return void 0!==e.query.documents?(bv(1===(i=e.query).documents.length),r=Bw(Rw(dE(i.documents[0])))):r=function(e){return Bw(bE(e))}(e.query),new uI(r,e.targetId,0,e.lastListenSequenceNumber,t,n,k_.fromBase64String(e.resumeToken))}function yI(e,t){const n=fI(t.snapshotVersion),r=fI(t.lastLimboFreeSnapshotVersion);let i;i=fw(t.target)?_E(e.ne,t.target):wE(e.ne,t.target);const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:hw(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function vI(e){const t=bE({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Vw(t,t.limit,"L"):t}function _I(e,t){return new cI(t.largestBatchId,vE(e.ne,t.overlayMutation))}function wI(e,t){const n=t.path.lastSegment();return[e,NE(t.path.popLast()),n]}function bI(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:fI(r.readTime),documentKey:NE(r.documentKey.path),largestBatchId:r.largestBatchId}}class EI{getBundleMetadata(e,t){return II(e).get(t).next((e=>{if(e)return{id:(t=e).bundleId,createTime:pI(t.createTime),version:t.version};var t}))}saveBundleMetadata(e,t){return II(e).put({bundleId:(n=t).id,createTime:fI(oE(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return SI(e).get(t).next((e=>{if(e)return{name:(t=e).name,query:vI(t.bundledQuery),readTime:pI(t.readTime)};var t}))}saveNamedQuery(e,t){return SI(e).put(function(e){return{name:e.name,readTime:fI(oE(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function II(e){return sI(e,"bundles")}function SI(e){return sI(e,"namedQueries")}class TI{constructor(e,t){this.wt=e,this.userId=t}static se(e,t){const n=t.uid||"";return new TI(e,n)}getOverlay(e,t){return kI(e).get(wI(this.userId,t)).next((e=>e?_I(this.wt,e):null))}getOverlays(e,t){const n=Ub();return r_.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new cI(t,i);r.push(this.ie(e,s))})),r_.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(NE(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(kI(e).W("collectionPathOverlayIndex",r))})),r_.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Ub(),i=NE(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return kI(e).K("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=_I(this.wt,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=Ub();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return kI(e).J({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=_I(this.wt,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}ie(e,t){return kI(e).put(function(e,t,n){const[r,i,s]=wI(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:yE(e.ne,n.mutation)}}(this.wt,this.userId,t))}}function kI(e){return sI(e,"documentOverlays")}class AI{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(C_(e.integerValue));else if("doubleValue"in e){const n=C_(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),U_(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ce(t,20),"string"==typeof n?t.he(n):(t.he(`${n.seconds||""}`),t.ae(n.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(D_(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ce(t,45),t.ae(n.latitude||0),t.ae(n.longitude||0)}else"mapValue"in e?tw(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):wv()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const n=e.fields||{};this.ce(t,55);for(const e of Object.keys(n))this.le(e,t),this.oe(n[e],t)}me(e,t){const n=e.values||[];this.ce(t,50);for(const e of n)this.oe(e,t)}_e(e,t){this.ce(t,37),qv.fromName(e).path.forEach((e=>{this.ce(t,60),this.ge(e,t)}))}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}function xI(e){if(0===e)return 8;let t=0;return!(e>>4)&&(t+=4,e<<=4),!(e>>6)&&(t+=2,e<<=2),!(e>>7)&&(t+=1),t}function CI(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=xI(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}AI.ye=new AI;class DI{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ie(n.value),n=t.next();this.Te()}Ee(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ae(n.value),n=t.next();this.Re()}be(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ie(e);else if(e<2048)this.Ie(960|e>>>6),this.Ie(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ie(480|e>>>12),this.Ie(128|63&e>>>6),this.Ie(128|63&e);else{const e=t.codePointAt(0);this.Ie(240|e>>>18),this.Ie(128|63&e>>>12),this.Ie(128|63&e>>>6),this.Ie(128|63&e)}}this.Te()}Pe(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ae(e);else if(e<2048)this.Ae(960|e>>>6),this.Ae(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|e>>>12),this.Ae(128|63&e>>>6),this.Ae(128|63&e);else{const e=t.codePointAt(0);this.Ae(240|e>>>18),this.Ae(128|63&e>>>12),this.Ae(128|63&e>>>6),this.Ae(128|63&e)}}this.Re()}ve(e){const t=this.Ve(e),n=CI(t);this.Se(1+n),this.buffer[this.position++]=255&n;for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=255&t[e]}De(e){const t=this.Ve(e),n=CI(t);this.Se(1+n),this.buffer[this.position++]=~(255&n);for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Me(){return this.buffer.slice(0,this.position)}Ve(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let e=1;e<t.length;++e)t[e]^=n?255:0;return t}Ie(e){const t=255&e;0===t?(this.xe(0),this.xe(255)):255===t?(this.xe(255),this.xe(0)):this.xe(t)}Ae(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class NI{constructor(e){this.Oe=e}de(e){this.Oe.pe(e)}he(e){this.Oe.be(e)}ae(e){this.Oe.ve(e)}ue(){this.Oe.Ce()}}class OI{constructor(e){this.Oe=e}de(e){this.Oe.Ee(e)}he(e){this.Oe.Pe(e)}ae(e){this.Oe.De(e)}ue(){this.Oe.Ne()}}class RI{constructor(){this.Oe=new DI,this.Fe=new NI(this.Oe),this.$e=new OI(this.Oe)}seed(e){this.Oe.seed(e)}Be(e){return 0===e?this.Fe:this.$e}Me(){return this.Oe.Me()}reset(){this.Oe.reset()}}class MI{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Le(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new MI(this.indexId,this.documentKey,this.arrayValue,n)}}function PI(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=LI(e.arrayValue,t.arrayValue),0!==n?n:(n=LI(e.directionalValue,t.directionalValue),0!==n?n:qv.comparator(e.documentKey,t.documentKey)))}function LI(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class UI{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const t of e.filters){const e=t;e.ht()?this.Ke=e:this.qe.push(e)}}Ge(e){const t=Hv(e);if(void 0!==t&&!this.Qe(t))return!1;const n=Kv(e);let r=0,i=0;for(;r<n.length&&this.Qe(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Ke){const e=n[r];if(!this.je(this.Ke,e)||!this.We(this.Ue[i++],e))return!1;++r}for(;r<n.length;++r){const e=n[r];if(i>=this.Ue.length||!this.We(this.Ue[i++],e))return!1}return!0}Qe(e){for(const t of this.qe)if(this.je(t,e))return!0;return!1}je(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class FI{constructor(){this.ze=new BI}addToCollectionParentIndex(e,t){return this.ze.add(t),r_.resolve()}getCollectionParents(e,t){return r_.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return r_.resolve()}deleteFieldIndex(e,t){return r_.resolve()}getDocumentsMatchingTarget(e,t){return r_.resolve(null)}getIndexType(e,t){return r_.resolve(0)}getFieldIndexes(e,t){return r_.resolve([])}getNextCollectionGroupToUpdate(e){return r_.resolve(null)}getMinOffset(e,t){return r_.resolve(Xv.min())}getMinOffsetFromCollectionGroup(e,t){return r_.resolve(Xv.min())}updateCollectionGroup(e,t,n){return r_.resolve()}updateIndexEntries(e,t){return r_.resolve()}}class BI{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new E_(jv.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new E_(jv.comparator)).toArray()}}const VI=new Uint8Array(0);class jI{constructor(e,t){this.user=e,this.databaseId=t,this.He=new BI,this.Je=new Nb((e=>hw(e)),((e,t)=>dw(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.He.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.He.add(t)}));const i={collectionId:n,parent:NE(r)};return $I(e).put(i)}return r_.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[Uv(t),""],!1,!0);return $I(e).K(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(ME(r.parent))}return n}))}addFieldIndex(e,t){const n=qI(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=zI(e);return i.next((e=>{n.put(bI(e,this.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=qI(e),r=zI(e),i=GI(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}getDocumentsMatchingTarget(e,t){const n=GI(e);let r=!0;const i=new Map;return r_.forEach(this.Ye(t),(t=>this.Xe(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=$b();const r=[];return r_.forEach(i,((i,s)=>{var o;gv("IndexedDbIndexManager",`Using index ${o=i,`id=${o.indexId}|cg=${o.collectionGroup}|f=${o.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`} to execute ${hw(t)}`);const a=function(e,t){const n=Hv(t);if(void 0===n)return null;for(const t of pw(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),c=function(e,t){const n=new Map;for(const r of Kv(t))for(const t of pw(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of Kv(t)){const t=0===i.kind?mw(e,i.fieldPath,e.startAt):gw(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new kw(n,r)}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of Kv(t)){const t=0===i.kind?gw(e,i.fieldPath,e.endAt):mw(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new kw(n,r)}(s,i),h=this.Ze(i,s,u),d=this.Ze(i,s,l),f=this.tn(i,s,c),p=this.en(i.indexId,a,h,u.inclusive,d,l.inclusive,f);return r_.forEach(p,(i=>n.j(i,t.limit).next((t=>{t.forEach((t=>{const n=qv.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return r_.resolve(null)}))}Ye(e){let t=this.Je.get(e);return t||(t=[e],this.Je.set(e,t),t)}en(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),c=a/(null!=t?t.length:1),u=[];for(let l=0;l<a;++l){const a=t?this.nn(t[l/c]):VI,h=this.sn(e,a,n[l%c],r),d=this.rn(e,a,i[l%c],s),f=o.map((t=>this.sn(e,a,t,!0)));u.push(...this.createRange(h,d,f))}return u}sn(e,t,n,r){const i=new MI(e,qv.empty(),t,n);return r?i:i.Le()}rn(e,t,n,r){const i=new MI(e,qv.empty(),t,n);return r?i.Le():i}Xe(e,t){const n=new UI(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.Ge(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;return r_.forEach(this.Ye(t),(t=>this.Xe(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new E_(Gv.comparator),n=!1;for(const r of e.filters){const e=r;e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field))}for(const n of e.orderBy)n.field.isKeyField()||(t=t.add(n.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>n))}on(e,t){const n=new RI;for(const r of Kv(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Be(r.kind);AI.ye.re(e,i)}return n.Me()}nn(e){const t=new RI;return AI.ye.re(e,t.Be(0)),t.Me()}un(e,t){const n=new RI;return AI.ye.re(W_(this.databaseId,t),n.Be(function(e){const t=Kv(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Me()}tn(e,t,n){if(null===n)return[];let r=[];r.push(new RI);let i=0;for(const s of Kv(e)){const e=n[i++];for(const n of r)if(this.cn(t,s.fieldPath)&&Y_(e))r=this.an(r,s,e);else{const t=n.Be(s.kind);AI.ye.re(e,t)}}return this.hn(r)}Ze(e,t,n){return this.tn(e,t,n.position)}hn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Me();return t}an(e,t,n){const r=[...e],i=[];for(const e of n.arrayValue.values||[])for(const n of r){const r=new RI;r.seed(n.Me()),AI.ye.re(e,r.Be(t.kind)),i.push(r)}return i}cn(e,t){return!!e.filters.find((e=>e instanceof yw&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=qI(e),r=zI(e);return(t?n.K("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.K()).next((e=>{const t=[];return r_.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new Qv(t.sequenceNumber,new Xv(pI(t.readTime),new qv(ME(t.documentKey)),t.largestBatchId)):Qv.empty(),r=e.fields.map((([e,t])=>new Wv(Gv.fromServerFormat(e),t)));return new zv(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Pv(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=qI(e),i=zI(e);return this.ln(e).next((e=>r.K("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>r_.forEach(t,(t=>i.put(bI(t.indexId,this.user,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return r_.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?r_.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),r_.forEach(i,(n=>this.fn(e,t,n).next((t=>{const i=this.dn(r,n);return t.isEqual(i)?r_.resolve():this._n(e,r,n,t,i)})))))))}))}wn(e,t,n,r){return GI(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.un(n,t.key),documentKey:t.key.path.toArray()})}mn(e,t,n,r){return GI(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.un(n,t.key),t.key.path.toArray()])}fn(e,t,n){const r=GI(e);let i=new E_(PI);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.un(n,t)])},((e,r)=>{i=i.add(new MI(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}dn(e,t){let n=new E_(PI);const r=this.on(t,e);if(null==r)return n;const i=Hv(t);if(null!=i){const s=e.data.field(i.fieldPath);if(Y_(s))for(const i of s.arrayValue.values||[])n=n.add(new MI(t.indexId,e.key,this.nn(i),r))}else n=n.add(new MI(t.indexId,e.key,VI,r));return n}_n(e,t,n,r,i){gv("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=S_(s),c=S_(o);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=S_(o)):t?(i(a),a=S_(s)):(a=S_(s),c=S_(o))}}(r,i,PI,(r=>{s.push(this.wn(e,t,n,r))}),(r=>{s.push(this.mn(e,t,n,r))})),r_.waitFor(s)}ln(e){let t=1;return zI(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>PI(e,t))).filter(((e,t,n)=>!t||0!==PI(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=PI(i,e),s=PI(i,t);if(0===n)r[0]=e.Le();else if(n>0&&s<0)r.push(i),r.push(i.Le());else if(s>0)break}r.push(t);const i=[];for(let e=0;e<r.length;e+=2)i.push(IDBKeyRange.bound([r[e].indexId,this.uid,r[e].arrayValue,r[e].directionalValue,VI,[]],[r[e+1].indexId,this.uid,r[e+1].arrayValue,r[e+1].directionalValue,VI,[]]));return i}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(HI)}getMinOffset(e,t){return r_.mapArray(this.Ye(t),(t=>this.Xe(e,t).next((e=>e||wv())))).next(HI)}}function $I(e){return sI(e,"collectionParents")}function GI(e){return sI(e,"indexEntries")}function qI(e){return sI(e,"indexConfiguration")}function zI(e){return sI(e,"indexState")}function HI(e){bv(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;Zv(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Xv(t.readTime,t.documentKey,n)}const KI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class WI{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new WI(e,WI.DEFAULT_COLLECTION_PERCENTILE,WI.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function QI(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.J({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{bv(1===a)})));const u=[];for(const e of n.mutations){const r=UE(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return r_.waitFor(s).next((()=>u))}function YI(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw wv();t=e.noDocument}return JSON.stringify(t).length}WI.DEFAULT_COLLECTION_PERCENTILE=10,WI.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,WI.DEFAULT=new WI(41943040,WI.DEFAULT_COLLECTION_PERCENTILE,WI.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),WI.DISABLED=new WI(-1,0,0);class JI{constructor(e,t,n,r){this.userId=e,this.wt=t,this.indexManager=n,this.referenceDelegate=r,this.gn={}}static se(e,t,n,r){bv(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new JI(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ZI(e).J({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=eS(e),s=ZI(e);return s.add({}).next((o=>{bv("number"==typeof o);const a=new oI(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>yE(e.ne,t))),i=n.mutations.map((t=>yE(e.ne,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.wt,this.userId,a),u=[];let l=new E_(((e,t)=>Pv(e.canonicalString(),t.canonicalString())));for(const e of r){const t=UE(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,FE))}return l.forEach((t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.gn[o]=a.keys()})),r_.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return ZI(e).get(t).next((e=>e?(bv(e.userId===this.userId),mI(this.wt,e)):null))}yn(e,t){return this.gn[t]?r_.resolve(this.gn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.gn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return ZI(e).J({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(bv(t.batchId>=n),i=mI(this.wt,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return ZI(e).J({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ZI(e).K("userMutationsIndex",t).next((e=>e.map((e=>mI(this.wt,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=LE(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return eS(e).J({range:r},((n,r,s)=>{const[o,a,c]=n,u=ME(a);if(o===this.userId&&t.path.isEqual(u))return ZI(e).get(c).next((e=>{if(!e)throw wv();bv(e.userId===this.userId),i.push(mI(this.wt,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new E_(Pv);const r=[];return t.forEach((t=>{const i=LE(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=eS(e).J({range:s},((e,r,i)=>{const[s,o,a]=e,c=ME(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),r_.waitFor(r).next((()=>this.pn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=LE(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new E_(Pv);return eS(e).J({range:s},((e,t,i)=>{const[s,a,c]=e,u=ME(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.pn(e,o)))}pn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(ZI(e).get(t).next((e=>{if(null===e)throw wv();bv(e.userId===this.userId),n.push(mI(this.wt,e))})))})),r_.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return QI(e.ee,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.In(t.batchId)})),r_.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return r_.resolve();const n=IDBKeyRange.lowerBound([this.userId]),r=[];return eS(e).J({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=ME(e[1]);r.push(t)}else n.done()})).next((()=>{bv(0===r.length)}))}))}containsKey(e,t){return XI(e,this.userId,t)}Tn(e){return tS(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function XI(e,t,n){const r=LE(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return eS(e).J({range:s,H:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function ZI(e){return sI(e,"mutations")}function eS(e){return sI(e,"documentMutations")}function tS(e){return sI(e,"mutationQueues")}class nS{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new nS(0)}static Rn(){return new nS(-1)}}class rS{constructor(e,t){this.referenceDelegate=e,this.wt=t}allocateTargetId(e){return this.bn(e).next((t=>{const n=new nS(t.highestTargetId);return t.highestTargetId=n.next(),this.Pn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.bn(e).next((e=>Bv.fromTimestamp(new Fv(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.bn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.bn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Pn(e,r))))}addTargetData(e,t){return this.vn(e,t).next((()=>this.bn(e).next((n=>(n.targetCount+=1,this.Vn(t,n),this.Pn(e,n))))))}updateTargetData(e,t){return this.vn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>iS(e).delete(t.targetId))).next((()=>this.bn(e))).next((t=>(bv(t.targetCount>0),t.targetCount-=1,this.Pn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return iS(e).J(((s,o)=>{const a=gI(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>r_.waitFor(i))).next((()=>r))}forEachTarget(e,t){return iS(e).J(((e,n)=>{const r=gI(n);t(r)}))}bn(e){return sS(e).get("targetGlobalKey").next((e=>(bv(null!==e),e)))}Pn(e,t){return sS(e).put("targetGlobalKey",t)}vn(e,t){return iS(e).put(yI(this.wt,t))}Vn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.bn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=hw(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return iS(e).J({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const s=gI(n);dw(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=oS(e);return t.forEach((t=>{const s=NE(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),r_.waitFor(r)}removeMatchingKeys(e,t,n){const r=oS(e);return r_.forEach(t,(t=>{const i=NE(t.path);return r_.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=oS(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=oS(e);let i=$b();return r.J({range:n,H:!0},((e,t,n)=>{const r=ME(e[1]),s=new qv(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=NE(t.path),r=IDBKeyRange.bound([n],[Uv(n)],!1,!0);let i=0;return oS(e).J({index:"documentTargetsIndex",H:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}te(e,t){return iS(e).get(t).next((e=>e?gI(e):null))}}function iS(e){return sI(e,"targets")}function sS(e){return sI(e,"targetGlobal")}function oS(e){return sI(e,"targetDocuments")}function aS([e,t],[n,r]){const i=Pv(e,n);return 0===i?Pv(t,r):i}class cS{constructor(e){this.Sn=e,this.buffer=new E_(aS),this.Dn=0}Cn(){return++this.Dn}xn(e){const t=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();aS(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class uS{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Nn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return null!==this.Nn}kn(e){gv("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Nn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){c_(e)?gv("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await n_(e)}await this.kn(3e5)}))}}class lS{constructor(e,t){this.Mn=e,this.params=t}calculateTargetCount(e,t){return this.Mn.On(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return r_.resolve(m_.ot);const n=new cS(t);return this.Mn.forEachTarget(e,(e=>n.xn(e.sequenceNumber))).next((()=>this.Mn.Fn(e,(e=>n.xn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Mn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Mn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(gv("LruGarbageCollector","Garbage collection skipped; disabled"),r_.resolve(KI)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(gv("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),KI):this.$n(e,t)))}getCacheSize(e){return this.Mn.getCacheSize(e)}$n(e,t){let n,r,i,s,o,a,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(gv("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),mv()<=Nu.DEBUG&&gv("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(c-a)+"ms\n"+`Total Duration: ${c-u}ms`),r_.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}class hS{constructor(e,t){this.db=e,this.garbageCollector=function(e,t){return new lS(e,t)}(this,t)}On(e){const t=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Bn(e){let t=0;return this.Fn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Fn(e,t){return this.Ln(e,((e,n)=>t(n)))}addReference(e,t,n){return dS(e,n)}removeReference(e,t,n){return dS(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return dS(e,t)}Un(e,t){return function(e,t){let n=!1;return tS(e).Y((r=>XI(e,r,t).next((e=>(e&&(n=!0),r_.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Ln(e,((s,o)=>{if(o<=t){const t=this.Un(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,Bv.min()),oS(e).delete([0,NE(s.path)]))))}));r.push(t)}})).next((()=>r_.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return dS(e,t)}Ln(e,t){const n=oS(e);let r,i=m_.ot;return n.J({index:"documentTargetsIndex"},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==m_.ot&&t(new qv(ME(r)),i),i=o,r=s):i=m_.ot})).next((()=>{i!==m_.ot&&t(new qv(ME(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function dS(e,t){return oS(e).put(function(e,t){return{targetId:0,path:NE(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class fS{constructor(){this.changes=new Nb((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,cw.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?r_.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class pS{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return vS(e).put(n)}removeEntry(e,t,n){return vS(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],dI(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.qn(e,n))))}getEntry(e,t){let n=cw.newInvalidDocument(t);return vS(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(_S(t))},((e,r)=>{n=this.Kn(t,r)})).next((()=>n))}Gn(e,t){let n={size:0,document:cw.newInvalidDocument(t)};return vS(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(_S(t))},((e,r)=>{n={document:this.Kn(t,r),size:YI(r)}})).next((()=>n))}getEntries(e,t){let n=Rb();return this.Qn(e,t,((e,t)=>{const r=this.Kn(e,t);n=n.insert(e,r)})).next((()=>n))}jn(e,t){let n=Rb(),r=new __(qv.comparator);return this.Qn(e,t,((e,t)=>{const i=this.Kn(e,t);n=n.insert(e,i),r=r.insert(e,YI(t))})).next((()=>({documents:n,Wn:r})))}Qn(e,t,n){if(t.isEmpty())return r_.resolve();let r=new E_(bS);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(_S(r.first()),_S(r.last())),s=r.getIterator();let o=s.getNext();return vS(e).J({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=qv.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&bS(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.q(_S(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getAllFromCollection(e,t,n){const r=[t.popLast().toArray(),t.lastSegment(),dI(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],i=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return vS(e).K(IDBKeyRange.bound(r,i,!0)).next((e=>{let t=Rb();for(const n of e){const e=this.Kn(qv.fromSegments(n.prefixPath.concat(n.collectionGroup,n.documentId)),n);t=t.insert(e.key,e)}return t}))}getAllFromCollectionGroup(e,t,n,r){let i=Rb();const s=wS(t,n),o=wS(t,Xv.max());return vS(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.Kn(qv.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new gS(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return yS(e).get("remoteDocumentGlobalKey").next((e=>(bv(!!e),e)))}qn(e,t){return yS(e).put("remoteDocumentGlobalKey",t)}Kn(e,t){if(t){const e=function(e,t){let n;if(t.document)n=gE(e.ne,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=qv.fromSegments(t.noDocument.path),r=pI(t.noDocument.readTime);n=cw.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return wv();{const e=qv.fromSegments(t.unknownDocument.path),r=pI(t.unknownDocument.version);n=cw.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new Fv(e[0],e[1]);return Bv.fromTimestamp(t)}(t.readTime)),n}(this.wt,t);if(!e.isNoDocument()||!e.version.isEqual(Bv.min()))return e}return cw.newInvalidDocument(e)}}function mS(e){return new pS(e)}class gS extends fS{constructor(e,t){super(),this.zn=e,this.trackRemovals=t,this.Hn=new Nb((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new E_(((e,t)=>Pv(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.Hn.get(i);if(t.push(this.zn.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=hI(this.zn.wt,s);r=r.add(i.path.popLast());const c=YI(a);n+=c-o.size,t.push(this.zn.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=hI(this.zn.wt,s.convertToNoDocument(Bv.min()));t.push(this.zn.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.zn.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.zn.updateMetadata(e,n)),r_.waitFor(t)}getFromCache(e,t){return this.zn.Gn(e,t).next((e=>(this.Hn.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.zn.jn(e,t).next((({documents:e,Wn:t})=>(t.forEach(((t,n)=>{this.Hn.set(t,{size:n,readTime:e.get(t).readTime})})),e)))}}function yS(e){return sI(e,"remoteDocumentGlobal")}function vS(e){return sI(e,"remoteDocumentsV14")}function _S(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function wS(e,t){const n=t.documentKey.path.toArray();return[e,dI(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function bS(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let e=0;e<n.length-2&&e<r.length-2;++e)if(i=Pv(n[e],r[e]),i)return i;return i=Pv(n.length,r.length),i||(i=Pv(n[n.length-2],r[r.length-2]),i||Pv(n[n.length-1],r[r.length-1]))}class ES{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class IS{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.getBaseDocument(e,t,n)))).next((e=>(null!==n&&gb(n.mutation,e,T_.empty(),Fv.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,$b()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=$b()){const r=Ub();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Pb();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Ub();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,$b())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Rb();const s=Bb(),o=Bb();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof wb)?i=i.insert(t.key,t):void 0!==o&&(s.set(t.key,o.mutation.getFieldMask()),gb(o.mutation,t,o.mutation.getFieldMask(),Fv.now()))})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new ES(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Bb();let r=new __(((e,t)=>e-t)),i=$b();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||T_.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||$b()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=Fb();c.forEach((e=>{if(!i.has(e)){const r=pb(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return r_.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return qv.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Uw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):r_.resolve(Ub());let o=-1,a=i;return s.next((t=>r_.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?r_.resolve():this.getBaseDocument(e,t,n).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,$b()))).next((e=>({batchId:o,changes:Lb(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new qv(t)).next((e=>{let t=Pb();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=Pb();return this.indexManager.getCollectionParents(e,r).next((s=>r_.forEach(s,(s=>{const o=function(e,t){return new Nw(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)))).next((e=>{e.forEach(((e,t)=>{const n=t.getKey();null===r.get(n)&&(r=r.insert(n,cw.newInvalidDocument(n)))}));let n=Pb();return r.forEach(((r,i)=>{const s=e.get(r);void 0!==s&&gb(s.mutation,i,T_.empty(),Fv.now()),qw(t,i)&&(n=n.insert(r,i))})),n}))}getBaseDocument(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):r_.resolve(cw.newInvalidDocument(t))}}class SS{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return r_.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:oE(n.createTime)}),r_.resolve()}getNamedQuery(e,t){return r_.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,function(e){return{name:e.name,query:vI(e.bundledQuery),readTime:oE(e.readTime)}}(t)),r_.resolve()}}class TS{constructor(){this.overlays=new __(qv.comparator),this.Xn=new Map}getOverlay(e,t){return r_.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ub();return r_.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ie(e,t,r)})),r_.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Xn.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Xn.delete(n)),r_.resolve()}getOverlaysForCollection(e,t,n){const r=Ub(),i=t.length+1,s=new qv(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return r_.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new __(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Ub(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Ub(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return r_.resolve(o)}ie(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new cI(t,n));let i=this.Xn.get(t);void 0===i&&(i=$b(),this.Xn.set(t,i)),this.Xn.set(t,i.add(n.key))}}class kS{constructor(){this.Zn=new E_(AS.ts),this.es=new E_(AS.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const n=new AS(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.rs(new AS(e,t))}os(e,t){e.forEach((e=>this.removeReference(e,t)))}us(e){const t=new qv(new jv([])),n=new AS(t,e),r=new AS(t,e+1),i=[];return this.es.forEachInRange([n,r],(e=>{this.rs(e),i.push(e.key)})),i}cs(){this.Zn.forEach((e=>this.rs(e)))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new qv(new jv([])),n=new AS(t,e),r=new AS(t,e+1);let i=$b();return this.es.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new AS(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class AS{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return qv.comparator(e.key,t.key)||Pv(e.ls,t.ls)}static ns(e,t){return Pv(e.ls,t.ls)||qv.comparator(e.key,t.key)}}class xS{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new E_(AS.ts)}checkEmpty(e){return r_.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new oI(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.ds=this.ds.add(new AS(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return r_.resolve(s)}lookupMutationBatch(e,t){return r_.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ws(n),i=r<0?0:r;return r_.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return r_.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return r_.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new AS(t,0),r=new AS(t,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([n,r],(e=>{const t=this._s(e.ls);i.push(t)})),r_.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new E_(Pv);return t.forEach((e=>{const t=new AS(e,0),r=new AS(e,Number.POSITIVE_INFINITY);this.ds.forEachInRange([t,r],(e=>{n=n.add(e.ls)}))})),r_.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;qv.isDocumentKey(i)||(i=i.child(""));const s=new AS(new qv(i),0);let o=new E_(Pv);return this.ds.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)}),s),r_.resolve(this.gs(o))}gs(e){const t=[];return e.forEach((e=>{const n=this._s(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){bv(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let n=this.ds;return r_.forEach(t.mutations,(r=>{const i=new AS(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.ds=n}))}In(e){}containsKey(e,t){const n=new AS(t,0),r=this.ds.firstAfterOrEqual(n);return r_.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,r_.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class CS{constructor(e){this.ps=e,this.docs=new __(qv.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return r_.resolve(n?n.document.mutableCopy():cw.newInvalidDocument(t))}getEntries(e,t){let n=Rb();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():cw.newInvalidDocument(e))})),r_.resolve(n)}getAllFromCollection(e,t,n){let r=Rb();const i=new qv(t.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i}}=s.getNext();if(!t.isPrefixOf(e.path))break;e.path.length>t.length+1||Zv(Jv(i),n)<=0||(r=r.insert(i.key,i.mutableCopy()))}return r_.resolve(r)}getAllFromCollectionGroup(e,t,n,r){wv()}Is(e,t){return r_.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new DS(this)}getSize(e){return r_.resolve(this.size)}}class DS extends fS{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.zn.addEntry(e,r)):this.zn.removeEntry(n)})),r_.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class NS{constructor(e){this.persistence=e,this.Ts=new Nb((e=>hw(e)),dw),this.lastRemoteSnapshotVersion=Bv.min(),this.highestTargetId=0,this.Es=0,this.As=new kS,this.targetCount=0,this.Rs=nS.An()}forEachTarget(e,t){return this.Ts.forEach(((e,n)=>t(n))),r_.resolve()}getLastRemoteSnapshotVersion(e){return r_.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return r_.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),r_.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),r_.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new nS(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,r_.resolve()}updateTargetData(e,t){return this.vn(t),r_.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,r_.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Ts.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Ts.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),r_.waitFor(i).next((()=>r))}getTargetCount(e){return r_.resolve(this.targetCount)}getTargetData(e,t){const n=this.Ts.get(t)||null;return r_.resolve(n)}addMatchingKeys(e,t,n){return this.As.ss(t,n),r_.resolve()}removeMatchingKeys(e,t,n){this.As.os(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),r_.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),r_.resolve()}getMatchingKeysForTargetId(e,t){const n=this.As.hs(t);return r_.resolve(n)}containsKey(e,t){return r_.resolve(this.As.containsKey(t))}}class OS{constructor(e,t){this.bs={},this.overlays={},this.Ps=new m_(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new NS(this),this.indexManager=new FI,this.remoteDocumentCache=function(e){return new CS(e)}((e=>this.referenceDelegate.Ss(e))),this.wt=new lI(t),this.Ds=new SS(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new TS,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.bs[e.toKey()];return n||(n=new xS(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,n){gv("MemoryPersistence","Starting transaction:",e);const r=new RS(this.Ps.next());return this.referenceDelegate.Cs(),n(r).next((e=>this.referenceDelegate.xs(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ns(e,t){return r_.or(Object.values(this.bs).map((n=>()=>n.containsKey(e,t))))}}class RS extends t_{constructor(e){super(),this.currentSequenceNumber=e}}class MS{constructor(e){this.persistence=e,this.ks=new kS,this.Ms=null}static Os(e){return new MS(e)}get Fs(){if(this.Ms)return this.Ms;throw wv()}addReference(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),r_.resolve()}removeReference(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),r_.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),r_.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach((e=>this.Fs.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Fs.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Cs(){this.Ms=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return r_.forEach(this.Fs,(n=>{const r=qv.fromPath(n);return this.$s(e,r).next((e=>{e||t.removeEntry(r,Bv.min())}))})).next((()=>(this.Ms=null,t.apply(e))))}updateLimboDocument(e,t){return this.$s(e,t).next((e=>{e?this.Fs.delete(t.toString()):this.Fs.add(t.toString())}))}Ss(e){return 0}$s(e,t){return r_.or([()=>r_.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class PS{constructor(e){this.wt=e}M(e,t,n,r){const i=new i_("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",PE,{unique:!0}),e.createObjectStore("documentMutations")}(e),LS(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=r_.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),LS(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Bv.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").K().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",PE,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return r_.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Bs(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(i))))),n<7&&r>=7&&(s=s.next((()=>this.Us(i)))),n<8&&r>=8&&(s=s.next((()=>this.qs(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.Ks(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:YE});t.createIndex("collectionPathOverlayIndex",JE,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",XE,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:BE});t.createIndex("documentKeyIndex",VE),t.createIndex("collectionGroupIndex",jE)}(e))).next((()=>this.Gs(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(s=s.next((()=>this.Qs(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:HE}).createIndex("sequenceNumberIndex",KE,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:WE}).createIndex("documentKeyIndex",QE,{unique:!1})}(e)))),s}Ls(e){let t=0;return e.store("remoteDocuments").J(((e,n)=>{t+=YI(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}Bs(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.K().next((t=>r_.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.K("userMutationsIndex",r).next((n=>r_.forEach(n,(n=>{bv(n.userId===t.userId);const r=mI(this.wt,n);return QI(e,t.userId,r).next((()=>{}))}))))}))))}Us(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.J(((n,i)=>{const s=new jv(n),o=function(e){return[0,NE(e)]}(s);r.push(t.get(o).next((n=>n?r_.resolve():(n=>t.put({targetId:0,path:NE(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>r_.waitFor(r)))}))}qs(e,t){e.createObjectStore("collectionParents",{keyPath:zE});const n=t.store("collectionParents"),r=new BI,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:NE(r)})}};return t.store("remoteDocuments").J({H:!0},((e,t)=>{const n=new jv(e);return i(n.popLast())})).next((()=>t.store("documentMutations").J({H:!0},(([e,t,n],r)=>{const s=ME(t);return i(s.popLast())}))))}Ks(e){const t=e.store("targets");return t.J(((e,n)=>{const r=gI(n),i=yI(this.wt,r);return t.put(i)}))}Gs(e,t){const n=t.store("remoteDocuments"),r=[];return n.J(((e,n)=>{const i=t.store("remoteDocumentsV14"),s=(o=n,o.document?new qv(jv.fromString(o.document.name).popFirst(5)):o.noDocument?qv.fromSegments(o.noDocument.path):o.unknownDocument?qv.fromSegments(o.unknownDocument.path):wv()).path.toArray();var o;const a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(a))})).next((()=>r_.waitFor(r)))}Qs(e,t){const n=t.store("mutations"),r=mS(this.wt),i=new OS(MS.Os,this.wt.ne);return n.K().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:$b();mI(this.wt,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),r_.forEach(n,((e,n)=>{const s=new dv(n),o=TI.se(this.wt,s),a=i.getIndexManager(s),c=JI.se(s,this.wt,a,i.referenceDelegate);return new IS(r,c,o,a).recalculateAndSaveOverlaysForDocumentKeys(new iI(t,m_.ot),e).next()}))}))}}function LS(e){e.createObjectStore("targetDocuments",{keyPath:GE}).createIndex("documentTargetsIndex",qE,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",$E,{unique:!0}),e.createObjectStore("targetGlobal")}const US="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class FS{constructor(e,t,n,r,i,s,o,a,c,u,l=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.js=i,this.window=s,this.document=o,this.Ws=c,this.zs=u,this.Hs=l,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=e=>Promise.resolve(),!FS.V())throw new Sv(Iv.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new hS(this,r),this.ei=t+"main",this.wt=new lI(a),this.ni=new s_(this.ei,this.Hs,new PS(this.wt)),this.Vs=new rS(this.referenceDelegate,this.wt),this.remoteDocumentCache=mS(this.wt),this.Ds=new EI,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,!1===u&&yv("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Sv(Iv.FAILED_PRECONDITION,US);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Vs.getHighestSequenceNumber(e)))})).then((e=>{this.Ps=new m_(e,this.Ws)})).then((()=>{this.vs=!0})).catch((e=>(this.ni&&this.ni.close(),Promise.reject(e))))}ci(e){return this.ti=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget((async()=>{this.started&&await this.ii()})))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>VS(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ai(e).next((e=>{e||(this.isPrimary=!1,this.js.enqueueRetryable((()=>this.ti(!1))))}))})).next((()=>this.hi(e))).next((t=>this.isPrimary&&!t?this.li(e).next((()=>!1)):!!t&&this.fi(e).next((()=>!0)))))).catch((e=>{if(c_(e))return gv("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return gv("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.js.enqueueRetryable((()=>this.ti(e))),this.isPrimary=e}))}ai(e){return BS(e).get("owner").next((e=>r_.resolve(this.di(e))))}_i(e){return VS(e).delete(this.clientId)}async wi(){if(this.isPrimary&&!this.mi(this.Zs,18e5)){this.Zs=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=sI(e,"clientMetadata");return t.K().next((e=>{const n=this.gi(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return r_.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.si)for(const t of e)this.si.removeItem(this.yi(t.clientId))}}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.ii().then((()=>this.wi())).then((()=>this.ui()))))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?r_.resolve(!0):BS(e).get("owner").next((t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)){if(this.di(t)&&this.networkEnabled)return!0;if(!this.di(t)){if(!t.allowTabSynchronization)throw new Sv(Iv.FAILED_PRECONDITION,US);return!1}}return!(!this.networkEnabled||!this.inForeground)||VS(e).K().next((e=>void 0===this.gi(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&gv("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.vs=!1,this.Ii(),this.Xs&&(this.Xs.cancel(),this.Xs=null),this.Ti(),this.Ei(),await this.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new iI(e,m_.ot);return this.li(t).next((()=>this._i(t)))})),this.ni.close(),this.Ai()}gi(e,t){return e.filter((e=>this.mi(e.updateTimeMs,t)&&!this.pi(e.clientId)))}Ri(){return this.runTransaction("getActiveClients","readonly",(e=>VS(e).K().next((e=>this.gi(e,18e5).map((e=>e.clientId))))))}get started(){return this.vs}getMutationQueue(e,t){return JI.se(e,this.wt,t,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new jI(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return TI.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,t,n){gv("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=15===(s=this.Hs)?rI:14===s?nI:13===s?tI:12===s?eI:11===s?ZE:void wv();var s;let o;return this.ni.runTransaction(e,r,i,(r=>(o=new iI(r,this.Ps?this.Ps.next():m_.ot),"readwrite-primary"===t?this.ai(o).next((e=>!!e||this.hi(o))).next((t=>{if(!t)throw yv(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable((()=>this.ti(!1))),new Sv(Iv.FAILED_PRECONDITION,e_);return n(o)})).next((e=>this.fi(o).next((()=>e)))):this.bi(o).next((()=>n(o)))))).then((e=>(o.raiseOnCommittedEvent(),e)))}bi(e){return BS(e).get("owner").next((e=>{if(null!==e&&this.mi(e.leaseTimestampMs,5e3)&&!this.pi(e.ownerId)&&!this.di(e)&&!(this.zs||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Sv(Iv.FAILED_PRECONDITION,US)}))}fi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return BS(e).put("owner",t)}static V(){return s_.V()}li(e){const t=BS(e);return t.get("owner").next((e=>this.di(e)?(gv("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):r_.resolve()))}mi(e,t){const n=Date.now();return!(e<n-t||e>n&&(yv(`Detected an update time that is in the future: ${e} > ${n}`),1))}ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ys=()=>{this.js.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.ii())))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground="visible"===this.document.visibilityState)}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Js=()=>{this.Ii(),fu()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var t;try{const n=null!==(null===(t=this.si)||void 0===t?void 0:t.getItem(this.yi(e)));return gv("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return yv("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){yv("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch(e){}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function BS(e){return sI(e,"owner")}function VS(e){return sI(e,"clientMetadata")}function jS(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class $S{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Pi=n,this.vi=r}static Vi(e,t){let n=$b(),r=$b();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new $S(e,t.fromCache,n,r)}}class GS{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ci(e,t).next((i=>i||this.xi(e,t,r,n))).next((n=>n||this.Ni(e,t)))}Ci(e,t){if(Mw(t))return r_.resolve(null);let n=Bw(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Vw(t,null,"F"),n=Bw(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=$b(...r);return this.Di.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.ki(t,r);return this.Mi(t,s,i,n.readTime)?this.Ci(e,Vw(t,null,"F")):this.Oi(e,s,t,n)}))))})))))}xi(e,t,n,r){return Mw(t)||r.isEqual(Bv.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next((i=>{const s=this.ki(t,i);return this.Mi(t,s,n,r)?this.Ni(e,t):(mv()<=Nu.DEBUG&&gv("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Gw(t)),this.Oi(e,s,t,Yv(r,-1)))}))}ki(e,t){let n=new E_(Hw(e));return t.forEach(((t,r)=>{qw(e,r)&&(n=n.add(r))})),n}Mi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ni(e,t){return mv()<=Nu.DEBUG&&gv("QueryEngine","Using full collection scan to execute query:",Gw(t)),this.Di.getDocumentsMatchingQuery(e,t,Xv.min())}Oi(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class qS{constructor(e,t,n,r){this.persistence=e,this.Fi=t,this.wt=r,this.$i=new __(Pv),this.Bi=new Nb((e=>hw(e)),dw),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(n)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new IS(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.$i)))}}function zS(e,t,n,r){return new qS(e,t,n,r)}async function HS(e,t){const n=Ev(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.qi(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=$b();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({Ki:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function KS(e){const t=Ev(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Vs.getLastRemoteSnapshotVersion(e)))}function WS(e,t,n){let r=$b(),i=$b();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Rb();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Bv.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):gv("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{Gi:r,Qi:i}}))}function QS(e,t){const n=Ev(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function YS(e,t){const n=Ev(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Vs.getTargetData(e,t).next((i=>i?(r=i,r_.resolve(r)):n.Vs.allocateTargetId(e).next((i=>(r=new uI(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e}))}async function JS(e,t,n){const r=Ev(e),i=r.$i.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!c_(e))throw e;gv("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.$i=r.$i.remove(t),r.Bi.delete(i.target)}function XS(e,t,n){const r=Ev(e);let i=Bv.min(),s=$b();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=Ev(e),i=r.Bi.get(n);return void 0!==i?r_.resolve(r.$i.get(i)):r.Vs.getTargetData(t,n)}(r,e,Bw(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.Fi.getDocumentsMatchingQuery(e,t,n?i:Bv.min(),n?s:$b()))).next((e=>(ZS(r,zw(t),e),{documents:e,ji:s})))))}function ZS(e,t,n){let r=Bv.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Li.set(t,r)}class eT{constructor(){this.activeTargetIds=qb()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tT{constructor(){this.Fr=new eT,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,n){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new eT,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class nT{Br(e){}shutdown(){}}class rT{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){gv("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){gv("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const iT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class sT{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class oT extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.so=t+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,n,r,i){const s=this.oo(e,t);gv("RestConnection","Sending: ",s,n);const o={};return this.uo(o,r,i),this.co(e,s,o,n).then((e=>(gv("RestConnection","Received: ",e),e)),(t=>{throw vv("RestConnection",`${e} failed with error: `,t,"url: ",s,"request:",n),t}))}ao(e,t,n,r,i,s){return this.ro(e,t,n,r,i)}uo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+fv,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}oo(e,t){const n=iT[e];return`${this.so}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,n,r){return new Promise(((i,s)=>{const o=new lv;o.listenOnce(sv.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case iv.NO_ERROR:const t=o.getResponseJson();gv("Connection","XHR received:",JSON.stringify(t)),i(t);break;case iv.TIMEOUT:gv("Connection",'RPC "'+e+'" timed out'),s(new Sv(Iv.DEADLINE_EXCEEDED,"Request time out"));break;case iv.HTTP_ERROR:const n=o.getStatus();if(gv("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Iv).indexOf(t)>=0?t:Iv.UNKNOWN}(e.status);s(new Sv(t,e.message))}else s(new Sv(Iv.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Sv(Iv.UNAVAILABLE,"Connection failed."));break;default:wv()}}finally{gv("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(r);o.send(t,"POST",a,n,15)}))}ho(e,t,n){const r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=nv(),s=rv(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new cv({})),this.uo(o.initMessageHeaders,t,n),uu()||hu()||cu().indexOf("Electron/")>=0||du()||cu().indexOf("MSAppHost/")>=0||lu()||(o.httpHeadersOverwriteParam="$httpHeaders");const a=r.join("");gv("Connection","Creating WebChannel: "+a,o);const c=i.createWebChannel(a,o);let u=!1,l=!1;const h=new sT({jr:e=>{l?gv("Connection","Not sending because WebChannel is closed:",e):(u||(gv("Connection","Opening WebChannel transport."),c.open(),u=!0),gv("Connection","WebChannel sending:",e),c.send(e))},Wr:()=>c.close()}),d=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return d(c,uv.EventType.OPEN,(()=>{l||gv("Connection","WebChannel transport opened.")})),d(c,uv.EventType.CLOSE,(()=>{l||(l=!0,gv("Connection","WebChannel transport closed"),h.eo())})),d(c,uv.EventType.ERROR,(e=>{l||(l=!0,vv("Connection","WebChannel transport errored:",e),h.eo(new Sv(Iv.UNAVAILABLE,"The operation could not be completed")))})),d(c,uv.EventType.MESSAGE,(e=>{var t;if(!l){const n=e.data[0];bv(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){gv("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=Ab[e];if(void 0!==t)return Db(t)}(e),n=i.message;void 0===t&&(t=Iv.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),l=!0,h.eo(new Sv(t,n)),c.close()}else gv("Connection","WebChannel received:",n),h.no(n)}})),d(s,ov.STAT_EVENT,(e=>{e.stat===av.PROXY?gv("Connection","Detected buffering proxy"):e.stat===av.NOPROXY&&gv("Connection","Detected no buffering proxy")})),setTimeout((()=>{h.Zr()}),0),h}}function aT(){return"undefined"!=typeof window?window:null}function cT(){return"undefined"!=typeof document?document:null}function uT(e){return new nE(e,!0)}class lT{constructor(e,t,n=1e3,r=1.5,i=6e4){this.js=e,this.timerId=t,this.lo=n,this.fo=r,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),n=Math.max(0,Date.now()-this.yo),r=Math.max(0,t-n);r>0&&gv("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,r,(()=>(this.yo=Date.now(),e()))),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class hT{constructor(e,t,n,r,i,s,o,a){this.js=e,this.Ao=n,this.Ro=r,this.bo=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new lT(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,(()=>this.Mo())))}Oo(e){this.Fo(),this.stream.send(e)}async Mo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,t){this.Fo(),this.$o(),this.So.cancel(),this.Po++,4!==e?this.So.reset():t&&t.code===Iv.RESOURCE_EXHAUSTED?(yv(t.toString()),yv("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):t&&t.code===Iv.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(t)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Po===t&&this.Uo(e,n)}),(t=>{e((()=>{const e=new Sv(Iv.UNKNOWN,"Fetching auth token failed: "+t.message);return this.qo(e)}))}))}Uo(e,t){const n=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr((()=>{n((()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,(()=>(this.Co()&&(this.state=3),Promise.resolve()))),this.listener.zr())))})),this.stream.Jr((e=>{n((()=>this.qo(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}xo(){this.state=5,this.So.Io((async()=>{this.state=0,this.start()}))}qo(e){return gv("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget((()=>this.Po===e?t():(gv("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dT extends hT{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.wt=i}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:wv()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.dt?(bv(void 0===t||"string"==typeof t),k_.fromBase64String(t||"")):(bv(void 0===t||t instanceof Uint8Array),k_.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Iv.UNKNOWN:Db(e.code);return new Sv(t,e.message||"")}(o);n=new Qb(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=lE(e,r.document.name),s=oE(r.document.updateTime),o=new ow({mapValue:{fields:r.document.fields}}),a=cw.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Kb(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=lE(e,r.document),s=r.readTime?oE(r.readTime):Bv.min(),o=cw.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Kb([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=lE(e,r.document),s=r.removedTargetIds||[];n=new Kb([],s,i,null)}else{if(!("filter"in t))return wv();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,i=new kb(r),s=e.targetId;n=new Wb(s,i)}}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return Bv.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Bv.min():t.readTime?oE(t.readTime):Bv.min()}(e);return this.listener.Go(t,n)}Qo(e){const t={};t.database=fE(this.wt),t.addTarget=function(e,t){let n;const r=t.target;return n=fw(r)?{documents:_E(e,r)}:{query:wE(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=iE(e,t.resumeToken):t.snapshotVersion.compareTo(Bv.min())>0&&(n.readTime=rE(e,t.snapshotVersion.toTimestamp())),n}(this.wt,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return wv()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.wt,e);n&&(t.labels=n),this.Oo(t)}jo(e){const t={};t.database=fE(this.wt),t.removeTarget=e,this.Oo(t)}}class fT extends hT{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(bv(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function(e,t){return e&&e.length>0?(bv(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?oE(e.updateTime):oE(t);return n.isEqual(Bv.min())&&(n=oE(t)),new lb(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=oE(e.commitTime);return this.listener.Jo(n,t)}return bv(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=fE(this.wt),this.Oo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>yE(this.wt,e)))};this.Oo(t)}}class pT extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=n,this.wt=r,this.Zo=!1}tu(){if(this.Zo)throw new Sv(Iv.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,n){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,i])=>this.bo.ro(e,t,n,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Iv.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Sv(Iv.UNKNOWN,e.toString())}))}ao(e,t,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.bo.ao(e,t,n,i,s,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Iv.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Sv(Iv.UNKNOWN,e.toString())}))}terminate(){this.Zo=!0}}class mT{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve()))))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(yv(t),this.su=!1):gv("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class gT{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br((e=>{n.enqueueAndForget((async()=>{TT(this)&&(gv("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Ev(e);t.lu.add(4),await vT(t),t._u.set("Unknown"),t.lu.delete(4),await yT(t)}(this))}))})),this._u=new mT(n,r)}}async function yT(e){if(TT(e))for(const t of e.fu)await t(!0)}async function vT(e){for(const t of e.fu)await t(!1)}function _T(e,t){const n=Ev(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),ST(n)?IT(n):GT(n).Co()&&bT(n,t))}function wT(e,t){const n=Ev(e),r=GT(n);n.hu.delete(t),r.Co()&&ET(n,t),0===n.hu.size&&(r.Co()?r.ko():TT(n)&&n._u.set("Unknown"))}function bT(e,t){e.wu.Nt(t.targetId),GT(e).Qo(t)}function ET(e,t){e.wu.Nt(t),GT(e).jo(t)}function IT(e){e.wu=new Jb({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),te:t=>e.hu.get(t)||null}),GT(e).start(),e._u.iu()}function ST(e){return TT(e)&&!GT(e).Do()&&e.hu.size>0}function TT(e){return 0===Ev(e).lu.size}function kT(e){e.wu=void 0}async function AT(e){e.hu.forEach(((t,n)=>{bT(e,t)}))}async function xT(e,t){kT(e),ST(e)?(e._u.uu(t),IT(e)):e._u.set("Unknown")}async function CT(e,t,n){if(e._u.set("Online"),t instanceof Qb&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.hu.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.hu.delete(r),e.wu.removeTarget(r))}(e,t)}catch(n){gv("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await DT(e,n)}else if(t instanceof Kb?e.wu.Ut(t):t instanceof Wb?e.wu.zt(t):e.wu.Gt(t),!n.isEqual(Bv.min()))try{const t=await KS(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.wu.Yt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.hu.get(t);if(!n)return;e.hu.set(t,n.withResumeToken(k_.EMPTY_BYTE_STRING,n.snapshotVersion)),ET(e,t);const r=new uI(n.target,t,1,n.sequenceNumber);bT(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){gv("RemoteStore","Failed to raise snapshot:",t),await DT(e,t)}}async function DT(e,t,n){if(!c_(t))throw t;e.lu.add(1),await vT(e),e._u.set("Offline"),n||(n=()=>KS(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{gv("RemoteStore","Retrying IndexedDB access"),await n(),e.lu.delete(1),await yT(e)}))}function NT(e,t){return t().catch((n=>DT(e,n,t)))}async function OT(e){const t=Ev(e),n=qT(t);let r=t.au.length>0?t.au[t.au.length-1].batchId:-1;for(;RT(t);)try{const e=await QS(t.localStore,r);if(null===e){0===t.au.length&&n.ko();break}r=e.batchId,MT(t,e)}catch(e){await DT(t,e)}PT(t)&&LT(t)}function RT(e){return TT(e)&&e.au.length<10}function MT(e,t){e.au.push(t);const n=qT(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function PT(e){return TT(e)&&!qT(e).Do()&&e.au.length>0}function LT(e){qT(e).start()}async function UT(e){qT(e).Xo()}async function FT(e){const t=qT(e);for(const n of e.au)t.Ho(n.mutations)}async function BT(e,t,n){const r=e.au.shift(),i=aI.from(r,t,n);await NT(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await OT(e)}async function VT(e,t){t&&qT(e).zo&&await async function(e,t){if(Cb(n=t.code)&&n!==Iv.ABORTED){const n=e.au.shift();qT(e).No(),await NT(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await OT(e)}var n}(e,t),PT(e)&&LT(e)}async function jT(e,t){const n=Ev(e);n.asyncQueue.verifyOperationInProgress(),gv("RemoteStore","RemoteStore received new credentials");const r=TT(n);n.lu.add(3),await vT(n),r&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.lu.delete(3),await yT(n)}async function $T(e,t){const n=Ev(e);t?(n.lu.delete(2),await yT(n)):t||(n.lu.add(2),await vT(n),n._u.set("Unknown"))}function GT(e){return e.mu||(e.mu=function(e,t,n){const r=Ev(e);return r.tu(),new dT(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:AT.bind(null,e),Jr:xT.bind(null,e),Go:CT.bind(null,e)}),e.fu.push((async t=>{t?(e.mu.No(),ST(e)?IT(e):e._u.set("Unknown")):(await e.mu.stop(),kT(e))}))),e.mu}function qT(e){return e.gu||(e.gu=function(e,t,n){const r=Ev(e);return r.tu(),new fT(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:UT.bind(null,e),Jr:VT.bind(null,e),Yo:FT.bind(null,e),Jo:BT.bind(null,e)}),e.fu.push((async t=>{t?(e.gu.No(),await OT(e)):(await e.gu.stop(),e.au.length>0&&(gv("RemoteStore",`Stopping write stream with ${e.au.length} pending writes`),e.au=[]))}))),e.gu}class zT{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Tv,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new zT(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Sv(Iv.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function HT(e,t){if(yv("AsyncQueue",`${t}: ${e}`),c_(e))return new Sv(Iv.UNAVAILABLE,`${t}: ${e}`);throw e}class KT{constructor(e){this.comparator=e?(t,n)=>e(t,n)||qv.comparator(t.key,n.key):(e,t)=>qv.comparator(e.key,t.key),this.keyedMap=Pb(),this.sortedSet=new __(this.comparator)}static emptySet(e){return new KT(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof KT))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new KT;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class WT{constructor(){this.yu=new __(qv.comparator)}track(e){const t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):wv():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class QT{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new QT(e,t,KT.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class YT{constructor(){this.Iu=void 0,this.listeners=[]}}class JT{constructor(){this.queries=new Nb((e=>$w(e)),jw),this.onlineState="Unknown",this.Tu=new Set}}async function XT(e,t){const n=Ev(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new YT),i)try{s.Iu=await n.onListen(r)}catch(e){const n=HT(e,`Initialization of query '${Gw(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.Eu(n.onlineState),s.Iu&&t.Au(s.Iu)&&nk(n)}async function ZT(e,t){const n=Ev(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function ek(e,t){const n=Ev(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.Au(e)&&(r=!0);i.Iu=e}}r&&nk(n)}function tk(e,t,n){const r=Ev(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function nk(e){e.Tu.forEach((e=>{e.next()}))}class rk{constructor(e,t,n){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=n||{}}Au(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new QT(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return!(this.options.Du&&n||e.docs.isEmpty()&&"Offline"!==t)}vu(e){if(e.docChanges.length>0)return!0;const t=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Su(e){e=QT.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class ik{constructor(e){this.key=e}}class sk{constructor(e){this.key=e}}class ok{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=$b(),this.mutatedKeys=$b(),this.Lu=Hw(e),this.Uu=new KT(this.Lu)}get qu(){return this.Fu}Ku(e,t){const n=t?t.Gu:new WT,r=t?t.Uu:this.Uu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=qw(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.Qu(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.Lu(l,a)>0||c&&this.Lu(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Uu:s,Gu:n,Mi:o,mutatedKeys:i}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wv()}};return n(e)-n(t)}(e.type,t.type)||this.Lu(e.doc,t.doc))),this.ju(n);const s=t?this.Wu():[],o=0===this.Bu.size&&this.current?1:0,a=o!==this.$u;return this.$u=o,0!==i.length||a?{snapshot:new QT(this.query,e.Uu,r,i,e.mutatedKeys,0===o,a,!1),zu:s}:{zu:s}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new WT,mutatedKeys:this.mutatedKeys,Mi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach((e=>this.Fu=this.Fu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Fu=this.Fu.delete(e))),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=$b(),this.Uu.forEach((e=>{this.Hu(e.key)&&(this.Bu=this.Bu.add(e.key))}));const t=[];return e.forEach((e=>{this.Bu.has(e)||t.push(new sk(e))})),this.Bu.forEach((n=>{e.has(n)||t.push(new ik(n))})),t}Ju(e){this.Fu=e.ji,this.Bu=$b();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return QT.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class ak{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class ck{constructor(e){this.key=e,this.Xu=!1}}class uk{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Zu={},this.tc=new Nb((e=>$w(e)),jw),this.ec=new Map,this.nc=new Set,this.sc=new __(qv.comparator),this.ic=new Map,this.rc=new kS,this.oc={},this.uc=new Map,this.cc=nS.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}async function lk(e,t){const n=xk(e);let r,i;const s=n.tc.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Yu();else{const e=await YS(n.localStore,Bw(t));n.isPrimaryClient&&_T(n.remoteStore,e);const s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await hk(n,t,r,"current"===s)}return i}async function hk(e,t,n,r){e.hc=(t,n,r)=>async function(e,t,n,r){let i=t.view.Ku(n);i.Mi&&(i=await XS(e.localStore,t.query,!1).then((({documents:e})=>t.view.Ku(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return Ek(e,t.targetId,o.zu),o.snapshot}(e,t,n,r);const i=await XS(e.localStore,t,!0),s=new ok(t,i.ji),o=s.Ku(i.documents),a=Hb.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),c=s.applyChanges(o,e.isPrimaryClient,a);Ek(e,n,c.zu);const u=new ak(t,n,s);return e.tc.set(t,u),e.ec.has(n)?e.ec.get(n).push(t):e.ec.set(n,[t]),c.snapshot}async function dk(e,t){const n=Ev(e),r=n.tc.get(t),i=n.ec.get(r.targetId);if(i.length>1)return n.ec.set(r.targetId,i.filter((e=>!jw(e,t)))),void n.tc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await JS(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),wT(n.remoteStore,r.targetId),wk(n,r.targetId)})).catch(n_)):(wk(n,r.targetId),await JS(n.localStore,r.targetId,!0))}async function fk(e,t){const n=Ev(e);try{const e=await function(e,t){const n=Ev(e),r=t.snapshotVersion;let i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.Vs.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Vs.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(a)?u=u.withResumeToken(k_.EMPTY_BYTE_STRING,Bv.min()).withLastLimboFreeSnapshotVersion(Bv.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.Vs.updateTargetData(e,u))}));let a=Rb(),c=$b();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(WS(e,s,t.documentUpdates).next((e=>{a=e.Gi,c=e.Qi}))),!r.isEqual(Bv.min())){const t=n.Vs.getLastRemoteSnapshotVersion(e).next((t=>n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return r_.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.$i=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.ic.get(t);r&&(bv(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Xu=!0:e.modifiedDocuments.size>0?bv(r.Xu):e.removedDocuments.size>0&&(bv(r.Xu),r.Xu=!1))})),await Tk(n,e,t)}catch(e){await n_(e)}}function pk(e,t,n){const r=Ev(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.tc.forEach(((n,r)=>{const i=r.view.Eu(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Ev(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.Eu(t)&&(r=!0)})),r&&nk(n)}(r.eventManager,t),e.length&&r.Zu.Go(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function mk(e,t,n){const r=Ev(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.ic.get(t),s=i&&i.key;if(s){let e=new __(qv.comparator);e=e.insert(s,cw.newNoDocument(s,Bv.min()));const n=$b().add(s),i=new zb(Bv.min(),new Map,new E_(Pv),e,n);await fk(r,i),r.sc=r.sc.remove(s),r.ic.delete(t),Sk(r)}else await JS(r.localStore,t,!1).then((()=>wk(r,t,n))).catch(n_)}async function gk(e,t){const n=Ev(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Ev(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=r_.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);bv(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=$b();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);_k(n,r,null),vk(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Tk(n,e)}catch(e){await n_(e)}}async function yk(e,t,n){const r=Ev(e);try{const e=await function(e,t){const n=Ev(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(bv(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);_k(r,t,n),vk(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Tk(r,e)}catch(n){await n_(n)}}function vk(e,t){(e.uc.get(t)||[]).forEach((e=>{e.resolve()})),e.uc.delete(t)}function _k(e,t,n){const r=Ev(e);let i=r.oc[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function wk(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.ec.get(t))e.tc.delete(r),n&&e.Zu.lc(r,n);e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach((t=>{e.rc.containsKey(t)||bk(e,t)}))}function bk(e,t){e.nc.delete(t.path.canonicalString());const n=e.sc.get(t);null!==n&&(wT(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),Sk(e))}function Ek(e,t,n){for(const r of n)r instanceof ik?(e.rc.addReference(r.key,t),Ik(e,r)):r instanceof sk?(gv("SyncEngine","Document no longer in limbo: "+r.key),e.rc.removeReference(r.key,t),e.rc.containsKey(r.key)||bk(e,r.key)):wv()}function Ik(e,t){const n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(gv("SyncEngine","New document in limbo: "+n),e.nc.add(r),Sk(e))}function Sk(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){const t=e.nc.values().next().value;e.nc.delete(t);const n=new qv(jv.fromString(t)),r=e.cc.next();e.ic.set(r,new ck(n)),e.sc=e.sc.insert(n,r),_T(e.remoteStore,new uI(Bw(Rw(n.path)),r,2,m_.ot))}}async function Tk(e,t,n){const r=Ev(e),i=[],s=[],o=[];r.tc.isEmpty()||(r.tc.forEach(((e,a)=>{o.push(r.hc(a,t,n).then((e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);const t=$S.Vi(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.Zu.Go(i),await async function(e,t){const n=Ev(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>r_.forEach(t,(t=>r_.forEach(t.Pi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>r_.forEach(t.vi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!c_(e))throw e;gv("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.$i.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.$i=n.$i.insert(t,i)}}}(r.localStore,s))}async function kk(e,t){const n=Ev(e);if(!n.currentUser.isEqual(t)){gv("SyncEngine","User change. New user:",t.toKey());const e=await HS(n.localStore,t);n.currentUser=t,function(e){e.uc.forEach((e=>{e.forEach((e=>{e.reject(new Sv(Iv.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.uc.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Tk(n,e.Ki)}}function Ak(e,t){const n=Ev(e),r=n.ic.get(t);if(r&&r.Xu)return $b().add(r.key);{let e=$b();const r=n.ec.get(t);if(!r)return e;for(const t of r){const r=n.tc.get(t);e=e.unionWith(r.view.qu)}return e}}function xk(e){const t=Ev(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=fk.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ak.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=mk.bind(null,t),t.Zu.Go=ek.bind(null,t.eventManager),t.Zu.lc=tk.bind(null,t.eventManager),t}function Ck(e){const t=Ev(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gk.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=yk.bind(null,t),t}class Dk{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=uT(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,t){return null}gc(e,t){return null}wc(e){return zS(this.persistence,new GS,e.initialUser,this.wt)}_c(e){return new OS(MS.Os,this.wt)}dc(e){return new tT}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Nk extends Dk{constructor(e,t,n){super(),this.yc=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.yc.initialize(this,e),await Ck(this.yc.syncEngine),await OT(this.yc.remoteStore),await this.persistence.ci((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}wc(e){return zS(this.persistence,new GS,e.initialUser,this.wt)}mc(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new uS(n,e.asyncQueue,t)}gc(e,t){const n=new p_(t,this.persistence);return new f_(e.asyncQueue,n)}_c(e){const t=jS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?WI.withCacheSize(this.cacheSizeBytes):WI.DEFAULT;return new FS(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,aT(),cT(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new tT}}class Ok{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>pk(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=kk.bind(null,this.syncEngine),await $T(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new JT}createDatastore(e){const t=uT(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new oT(r));var r;return function(e,t,n,r){return new pT(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>pk(this.syncEngine,e,0),s=rT.V()?new rT:new nT,new gT(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new uk(e,t,n,r,i,s);return o&&(a.ac=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Ev(e);gv("RemoteStore","RemoteStore shutting down."),t.lu.add(5),await vT(t),t.du.shutdown(),t._u.set("Unknown")}(this.remoteStore)}}class Rk{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):yv("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class Mk{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=dv.UNAUTHENTICATED,this.clientId=Mv.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{gv("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(gv("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Sv(Iv.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Tv;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=HT(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Pk(e,t){e.asyncQueue.verifyOperationInProgress(),gv("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await HS(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}async function Lk(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Uk(e);gv("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>jT(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>jT(t.remoteStore,n))),e.onlineComponents=t}async function Uk(e){return e.offlineComponents||(gv("FirestoreClient","Using default OfflineComponentProvider"),await Pk(e,new Dk)),e.offlineComponents}async function Fk(e){return e.onlineComponents||(gv("FirestoreClient","Using default OnlineComponentProvider"),await Lk(e,new Ok)),e.onlineComponents}function Bk(e){return Fk(e).then((e=>e.syncEngine))}async function Vk(e){const t=await Fk(e),n=t.eventManager;return n.onListen=lk.bind(null,t.syncEngine),n.onUnlisten=dk.bind(null,t.syncEngine),n}function jk(e,t,n={}){const r=new Tv;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Rk({next:s=>{t.enqueueAndForget((()=>ZT(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Sv(Iv.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Sv(Iv.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new rk(Rw(n.path),s,{includeMetadataChanges:!0,Du:!0});return XT(e,o)}(await Vk(e),e.asyncQueue,t,n,r))),r.promise}function $k(e,t,n={}){const r=new Tv;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Rk({next:n=>{t.enqueueAndForget((()=>ZT(e,o))),n.fromCache&&"server"===r.source?i.reject(new Sv(Iv.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new rk(n,s,{includeMetadataChanges:!0,Du:!0});return XT(e,o)}(await Vk(e),e.asyncQueue,t,n,r))),r.promise}const Gk=new Map;function qk(e,t,n){if(!n)throw new Sv(Iv.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function zk(e){if(!qv.isDocumentKey(e))throw new Sv(Iv.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Hk(e){if(qv.isDocumentKey(e))throw new Sv(Iv.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Kk(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":wv()}function Wk(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Sv(Iv.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Kk(e);throw new Sv(Iv.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Qk(e,t){if(t<=0)throw new Sv(Iv.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class Yk{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Sv(Iv.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Sv(Iv.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new Sv(Iv.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jk{constructor(e,t,n){this._authCredentials=t,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yk({}),this._settingsFrozen=!1,e instanceof P_?this._databaseId=e:(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Sv(Iv.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new P_(e.options.projectId)}(e))}get app(){if(!this._app)throw new Sv(Iv.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Sv(Iv.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yk(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Av;switch(e.type){case"gapi":const t=e.client;return bv(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new Dv(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Sv(Iv.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Gk.get(e);t&&(gv("ComponentProvider","Removing Datastore"),Gk.delete(e),t.terminate())}(this),Promise.resolve()}}class Xk{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new eA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xk(this.firestore,e,this._key)}}class Zk{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Zk(this.firestore,e,this._query)}}class eA extends Zk{constructor(e,t,n){super(e,t,Rw(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xk(this.firestore,null,new qv(e))}withConverter(e){return new eA(this.firestore,e,this._path)}}function tA(e,t,...n){if(e=Tu(e),qk("collection","path",t),e instanceof Jk){const r=jv.fromString(t,...n);return Hk(r),new eA(e,null,r)}{if(!(e instanceof Xk||e instanceof eA))throw new Sv(Iv.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(jv.fromString(t,...n));return Hk(r),new eA(e.firestore,null,r)}}function nA(e,t,...n){if(e=Tu(e),1===arguments.length&&(t=Mv.I()),qk("doc","path",t),e instanceof Jk){const r=jv.fromString(t,...n);return zk(r),new Xk(e,null,new qv(r))}{if(!(e instanceof Xk||e instanceof eA))throw new Sv(Iv.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(jv.fromString(t,...n));return zk(r),new Xk(e.firestore,e instanceof eA?e.converter:null,new qv(r))}}class rA{constructor(){this.Mc=Promise.resolve(),this.Oc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new lT(this,"async_queue_retry"),this.Kc=()=>{const e=cT();e&&gv("AsyncQueue","Visibility state changed to "+e.visibilityState),this.So.Eo()};const e=cT();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=cT();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise((()=>{}));const t=new Tv;return this.Qc((()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Oc.push(e),this.jc())))}async jc(){if(0!==this.Oc.length){try{await this.Oc[0](),this.Oc.shift(),this.So.reset()}catch(e){if(!c_(e))throw e;gv("AsyncQueue","Operation failed with retryable error: "+e)}this.Oc.length>0&&this.So.Io((()=>this.jc()))}}Qc(e){const t=this.Mc.then((()=>(this.Lc=!0,e().catch((e=>{this.Bc=e,this.Lc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw yv("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Lc=!1,e))))));return this.Mc=t,t}enqueueAfterDelay(e,t,n){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const r=zT.createAndSchedule(this,e,t,n,(e=>this.Wc(e)));return this.$c.push(r),r}Gc(){this.Bc&&wv()}verifyOperationInProgress(){}async zc(){let e;do{e=this.Mc,await e}while(e!==this.Mc)}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then((()=>{this.$c.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()}))}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function iA(e){return function(e){if("object"!=typeof e||null===e)return!1;const t=e;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(e)}class sA extends Jk{constructor(e,t,n){super(e,t,n),this.type="firestore",this._queue=new rA,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||cA(this),this._firestoreClient.terminate()}}function oA(e=Ul()){return Rl(e,"firestore").getImmediate()}function aA(e){return e._firestoreClient||cA(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function cA(e){var t;const n=e._freezeSettings(),r=function(e,t,n,r){return new M_(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new Mk(e._authCredentials,e._appCheckCredentials,e._queue,r)}function uA(e,t,n){const r=new Tv;return e.asyncQueue.enqueue((async()=>{try{await Pk(e,n),await Lk(e,t),r.resolve()}catch(e){const t=e;if(!function(e){return"FirebaseError"===e.name?e.code===Iv.FAILED_PRECONDITION||e.code===Iv.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(t))throw t;vv("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.reject(t)}})).then((()=>r.promise))}function lA(e){if(e._initialized||e._terminated)throw new Sv(Iv.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class hA{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Sv(Iv.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gv(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class dA{constructor(e){this._byteString=e}static fromBase64String(e){try{return new dA(k_.fromBase64String(e))}catch(e){throw new Sv(Iv.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new dA(k_.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class fA{constructor(e){this._methodName=e}}class pA{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Sv(Iv.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Sv(Iv.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Pv(this._lat,e._lat)||Pv(this._long,e._long)}}const mA=/^__.*__$/;class gA{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new wb(e,this.data,this.fieldMask,t,this.fieldTransforms):new _b(e,this.data,t,this.fieldTransforms)}}class yA{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new wb(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function vA(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wv()}}class _A{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.wt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new _A(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}ia(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return PA(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(vA(this.Zc)&&mA.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class wA{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=n||uT(e)}aa(e,t,n,r=!1){return new _A({Zc:e,methodName:t,ca:n,path:Gv.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function bA(e){const t=e._freezeSettings(),n=uT(e._databaseId);return new wA(e._databaseId,!!t.ignoreUndefinedProperties,n)}function EA(e,t,n,r,i,s={}){const o=e.aa(s.merge||s.mergeFields?2:0,t,n,i);NA("Data must be an object, but it was:",o,r);const a=CA(r,o);let c,u;if(s.merge)c=new T_(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=OA(t,r,n);if(!o.contains(i))throw new Sv(Iv.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);LA(e,i)||e.push(i)}c=new T_(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new gA(new ow(a),c,u)}class IA extends fA{_toFieldTransform(e){if(2!==e.Zc)throw 1===e.Zc?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof IA}}class SA extends fA{_toFieldTransform(e){return new ub(e.path,new tb)}isEqual(e){return e instanceof SA}}function TA(e,t,n,r){const i=e.aa(1,t,n);NA("Data must be an object, but it was:",i,r);const s=[],o=ow.empty();y_(r,((e,r)=>{const a=MA(t,e,n);r=Tu(r);const c=i.ia(a);if(r instanceof IA)s.push(a);else{const e=xA(r,c);null!=e&&(s.push(a),o.set(a,e))}}));const a=new T_(s);return new yA(o,a,i.fieldTransforms)}function kA(e,t,n,r,i,s){const o=e.aa(1,t,n),a=[OA(t,r,n)],c=[i];if(s.length%2!=0)throw new Sv(Iv.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(OA(t,s[e])),c.push(s[e+1]);const u=[],l=ow.empty();for(let e=a.length-1;e>=0;--e)if(!LA(u,a[e])){const t=a[e];let n=c[e];n=Tu(n);const r=o.ia(t);if(n instanceof IA)u.push(t);else{const e=xA(n,r);null!=e&&(u.push(t),l.set(t,e))}}const h=new T_(u);return new yA(l,h,o.fieldTransforms)}function AA(e,t,n,r=!1){return xA(n,e.aa(r?4:3,t))}function xA(e,t){if(DA(e=Tu(e)))return NA("Unsupported field value:",t,e),CA(e,t);if(e instanceof fA)return function(e,t){if(!vA(t.Zc))throw t.oa(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.oa(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=xA(i,t.ra(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Tu(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Yw(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Fv.fromDate(e);return{timestampValue:rE(t.wt,n)}}if(e instanceof Fv){const n=new Fv(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:rE(t.wt,n)}}if(e instanceof pA)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof dA)return{bytesValue:iE(t.wt,e._byteString)};if(e instanceof Xk){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.oa(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:aE(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa(`Unsupported field value: ${Kk(e)}`)}(e,t)}function CA(e,t){const n={};return v_(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):y_(e,((e,r)=>{const i=xA(r,t.ea(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function DA(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Fv||e instanceof pA||e instanceof dA||e instanceof Xk||e instanceof fA)}function NA(e,t,n){if(!DA(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Kk(n);throw"an object"===r?t.oa(e+" a custom object"):t.oa(e+" "+r)}}function OA(e,t,n){if((t=Tu(t))instanceof hA)return t._internalPath;if("string"==typeof t)return MA(e,t);throw PA("Field path arguments must be of type string or ",e,!1,void 0,n)}const RA=new RegExp("[~\\*/\\[\\]]");function MA(e,t,n){if(t.search(RA)>=0)throw PA(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new hA(...t.split("."))._internalPath}catch(r){throw PA(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function PA(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Sv(Iv.INVALID_ARGUMENT,a+e+c)}function LA(e,t){return e.some((e=>e.isEqual(t)))}class UA{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Xk(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new FA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(BA("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class FA extends UA{data(){return super.data()}}function BA(e,t){return"string"==typeof t?MA(e,t):t instanceof hA?t._internalPath:t._delegate._internalPath}class VA{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jA extends UA{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new $A(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(BA("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class $A extends jA{data(e={}){return super.data(e)}}class GA{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new VA(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new $A(this._firestore,this._userDataWriter,n.key,n,new VA(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Sv(Iv.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>({type:"added",doc:new $A(e._firestore,e._userDataWriter,n.doc.key,n.doc,new VA(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++})))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new $A(e._firestore,e._userDataWriter,t.doc.key,t.doc,new VA(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:qA(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function qA(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wv()}}function zA(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Sv(Iv.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class HA{}function KA(e,...t){for(const n of t)e=n._apply(e);return e}class WA extends HA{constructor(e,t,n){super(),this.fa=e,this.da=t,this._a=n,this.type="where"}_apply(e){const t=bA(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Sv(Iv.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){ix(o,s);const t=[];for(const n of o)t.push(rx(r,e,n));a={arrayValue:{values:t}}}else a=rx(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||ix(o,s),a=AA(n,"where",o,"in"===s||"not-in"===s);const c=yw.create(i,s,a);return function(e,t){if(t.ht()){const n=Lw(e);if(null!==n&&!n.isEqual(t.field))throw new Sv(Iv.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const r=Pw(e);null!==r&&sx(e,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Sv(Iv.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Sv(Iv.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,c),c}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new Zk(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new Nw(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}function QA(e,t,n){const r=t,i=BA("where",e);return new WA(i,r,n)}class YA extends HA{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Sv(Iv.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Sv(Iv.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Aw(t,n);return function(e,t){if(null===Pw(e)){const n=Lw(e);null!==n&&sx(e,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new Zk(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Nw(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function JA(e,t="asc"){const n=t,r=BA("orderBy",e);return new YA(r,n)}class XA extends HA{constructor(e,t,n){super(),this.type=e,this.ma=t,this.ga=n}_apply(e){return new Zk(e.firestore,e.converter,Vw(e._query,this.ma,this.ga))}}function ZA(e){return Qk("limit",e),new XA("limit",e,"F")}class ex extends HA{constructor(e,t,n){super(),this.type=e,this.ya=t,this.pa=n}_apply(e){const t=nx(e,this.type,this.ya,this.pa);return new Zk(e.firestore,e.converter,function(e,t){return new Nw(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function tx(...e){return new ex("startAfter",e,!1)}function nx(e,t,n,r){if(n[0]=Tu(n[0]),n[0]instanceof UA)return function(e,t,n,r,i){if(!r)throw new Sv(Iv.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of Fw(e))if(n.field.isKeyField())s.push(W_(t,r.key));else{const e=r.data.field(n.field);if(N_(e))throw new Sv(Iv.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new Sv(Iv.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new kw(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=bA(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new Sv(Iv.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new Sv(Iv.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!Uw(e)&&-1!==c.indexOf("/"))throw new Sv(Iv.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(jv.fromString(c));if(!qv.isDocumentKey(n))throw new Sv(Iv.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new qv(n);a.push(W_(t,i))}else{const e=AA(n,r,c);a.push(e)}}return new kw(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function rx(e,t,n){if("string"==typeof(n=Tu(n))){if(""===n)throw new Sv(Iv.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Uw(t)&&-1!==n.indexOf("/"))throw new Sv(Iv.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(jv.fromString(n));if(!qv.isDocumentKey(r))throw new Sv(Iv.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return W_(e,new qv(r))}if(n instanceof Xk)return W_(e,n._key);throw new Sv(Iv.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Kk(n)}.`)}function ix(e,t){if(!Array.isArray(e)||0===e.length)throw new Sv(Iv.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new Sv(Iv.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function sx(e,t,n){if(!n.isEqual(t))throw new Sv(Iv.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class ox{convertValue(e,t="none"){switch(j_(e)){case 0:return null;case 1:return e.booleanValue;case 2:return C_(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(D_(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw wv()}}convertObject(e,t){const n={};return y_(e.fields,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new pA(C_(e.latitude),C_(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=O_(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(R_(e));default:return null}}convertTimestamp(e){const t=x_(e);return new Fv(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=jv.fromString(e);bv(DE(n));const r=new P_(n.get(1),n.get(3)),i=new qv(n.popFirst(5));return r.isEqual(t)||yv(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function ax(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}function cx(e){e=Wk(e,Xk);const t=Wk(e.firestore,sA);return jk(aA(t),e._key).then((n=>gx(t,e,n)))}class ux extends ox{constructor(e){super(),this.firestore=e}convertBytes(e){return new dA(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Xk(this.firestore,null,t)}}function lx(e){e=Wk(e,Zk);const t=Wk(e.firestore,sA),n=aA(t),r=new ux(t);return zA(e._query),$k(n,e._query).then((n=>new GA(t,r,e,n)))}function hx(e,t,n){e=Wk(e,Xk);const r=Wk(e.firestore,sA),i=ax(e.converter,t,n);return mx(r,[EA(bA(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,hb.none())])}function dx(e,t,n,...r){e=Wk(e,Xk);const i=Wk(e.firestore,sA),s=bA(i);let o;return o="string"==typeof(t=Tu(t))||t instanceof hA?kA(s,"updateDoc",e._key,t,n,r):TA(s,"updateDoc",e._key,t),mx(i,[o.toMutation(e._key,hb.exists(!0))])}function fx(e){return mx(Wk(e.firestore,sA),[new Sb(e._key,hb.none())])}function px(e,t){const n=Wk(e.firestore,sA),r=nA(e),i=ax(e.converter,t);return mx(n,[EA(bA(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,hb.exists(!1))]).then((()=>r))}function mx(e,t){return function(e,t){const n=new Tv;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Ck(e);try{const e=await function(e,t){const n=Ev(e),r=Fv.now(),i=t.reduce(((e,t)=>e.add(t.key)),$b());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Rb(),c=$b();return n.Ui.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=yb(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new wb(e.key,t,aw(t.value.mapValue),hb.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:Lb(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.oc[e.currentUser.toKey()];r||(r=new __(Pv)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(r,e.batchId,n),await Tk(r,e.changes),await OT(r.remoteStore)}catch(e){const t=HT(e,"Failed to persist write");n.reject(t)}}(await Bk(e),t,n))),n.promise}(aA(e),t)}function gx(e,t,n){const r=n.docs.get(t._key),i=new ux(e);return new jA(e,i,t._key,r,new VA(n.hasPendingWrites,n.fromCache),t.converter)}function yx(){return new SA("serverTimestamp")}!function(e,t=!0){!function(e){fv=e}(Ll),Ol(new ku("firestore",((e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=new sA(r,new xv(e.getProvider("auth-internal")),new Ov(e.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:t},n),i._setSettings(n),i}),"PUBLIC")),Fl(hv,"3.4.14",e),Fl(hv,"3.4.14","esm2017")}();function vx(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function _x(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map((e=>_x(e)));if("function"==typeof e||"object"==typeof e)return vx(e,(e=>_x(e)));throw new Error("Data cannot be encoded in JSON: "+e)}function wx(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((e=>wx(e))):"function"==typeof e||"object"==typeof e?vx(e,(e=>wx(e))):e}const bx="functions",Ex={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ix extends mu{constructor(e,t,n){super(`${bx}/${e}`,t||""),this.details=n}}class Sx{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((e=>this.auth=e),(()=>{})),this.messaging||t.get().then((e=>this.messaging=e),(()=>{})),this.appCheck||n.get().then((e=>this.appCheck=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken()}}}const Tx="us-central1";class kx{constructor(e,t,n,r,i=Tx,s){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new Sx(t,n,r),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(i);this.customDomain=e.origin,this.region=Tx}catch(e){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){return`${this.emulatorOrigin}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function Ax(e,t,n){return r=>function(e,t,n,r){const i=e._url(t);return Cx(e,i,n,r)}(e,t,r,n||{})}async function xx(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}async function Cx(e,t,n,r){const i={data:n=_x(n)},s={},o=await e.contextProvider.getContext();o.authToken&&(s.Authorization="Bearer "+o.authToken),o.messagingToken&&(s["Firebase-Instance-ID-Token"]=o.messagingToken),null!==o.appCheckToken&&(s["X-Firebase-AppCheck"]=o.appCheckToken);const a=function(e){let t=null;return{promise:new Promise(((n,r)=>{t=setTimeout((()=>{r(new Ix("deadline-exceeded","deadline-exceeded"))}),e)})),cancel:()=>{t&&clearTimeout(t)}}}(r.timeout||7e4),c=await Promise.race([xx(t,i,s,e.fetchImpl),a.promise,e.cancelAllRequests]);if(a.cancel(),!c)throw new Ix("cancelled","Firebase Functions instance was deleted.");const u=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"==typeof t){if(!Ex[t])return new Ix("internal","internal");r=Ex[t],i=t}const s=e.message;"string"==typeof s&&(i=s),n=e.details,void 0!==n&&(n=wx(n))}}catch(e){}return"ok"===r?null:new Ix(r,i,n)}(c.status,c.json);if(u)throw u;if(!c.json)throw new Ix("internal","Response is not valid JSON object.");let l=c.json.data;if(void 0===l&&(l=c.json.result),void 0===l)throw new Ix("internal","Response is missing data field.");return{data:wx(l)}}const Dx="@firebase/functions",Nx="0.8.4";function Ox(e=Ul(),t=Tx){return Rl(Tu(e),bx).getImmediate({identifier:t})}function Rx(e,t,n){return Ax(Tu(e),t,n)}!function(e,t){Ol(new ku(bx,((t,{instanceIdentifier:n})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("messaging-internal"),o=t.getProvider("app-check-internal");return new kx(r,i,s,o,n,e)}),"PUBLIC").setMultipleInstances(!0)),Fl(Dx,Nx,t),Fl(Dx,Nx,"esm2017")}(fetch.bind(self));var Mx=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},Px=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Lx="user_activities",Ux="activities",Fx="commands",Bx="products",Vx="customers",jx="stats",$x="all_stats",Gx="checkout_sessions",qx="subscriptions",zx="manual_reviews",Hx="questions",Kx="user_queries",Wx="saved_linkedin_profiles",Qx="profiles",Yx="personas",Jx="templates",Xx="lists",Zx="globals",eC="extension",tC="linkedin_home_page_content",nC="teams",rC="timestamp",iC="activityData",sC="generatedText",oC="activityType",aC="total_usage",cC="total_tokens_count",uC="current_month_stats",lC="personaName",hC="templateName",dC="templateContent",fC="__name__",pC="getLinkedInProfileSummary",mC=function(e,t={}){if("object"!=typeof t){t={name:t}}const n=Object.assign({name:Al,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw Ml.create("bad-app-name",{appName:String(r)});const i=Cl.get(r);if(i){if(vu(e,i.options)&&vu(n,i.config))return i;throw Ml.create("duplicate-app",{appName:r})}const s=new Cu(r);for(const e of Dl.values())s.addComponent(e);const o=new Pl(e,n,s);return Cl.set(r,o),o}({apiKey:"AIzaSyC0kOy4juGg4iMqSkDmh4vF9HKRVsPXvOA",authDomain:"gptchromeextension.firebaseapp.com",projectId:"gptchromeextension",storageBucket:"gptchromeextension.appspot.com",messagingSenderId:"776551117048",appId:"1:776551117048:web:b07c9ec9bf7fe7faa6cb0d",measurementId:"G-HPJLZFL679"}),gC=function(e=Ul()){const t=Rl(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){const n=Rl(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(vu(n.getOptions(),null!=t?t:{}))return e;th(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Wf,persistence:[Qd,Od,Md]})}(mC);let yC=oA(mC);(function(e,t){lA(e=Wk(e,sA));const n=aA(e),r=e._freezeSettings(),i=new Ok;return uA(n,i,new Nk(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))})(yC,{forceOwnership:!globalThis.localStorage}).then((()=>_c.log("Offline persistence enabled"))).catch((e=>{switch(e.code){case"failed-precondition":_c.log("Offline persistence already enabled in another tab");break;case"unimplemented":_c.log("Offline persistence not supported by browser");break;default:_c.error(e)}}));let vC=null,_C=null;(new fd).addScope("https://www.googleapis.com/auth/contacts.readonly");let wC=0;const bC=(e,t,n,r,i,s)=>new Promise(((o,a)=>{_c.log({email:e,password:t}),async function(e,t,n){const r=Xh(e),i=await gd(r,{returnSecureToken:!0,email:t,password:n}),s=await yd._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(s.user),s}(gC,e,t).then((t=>Mx(void 0,void 0,void 0,(function*(){const a={email:e,first_name:n,last_name:r,phone_number:i,linkedin_url:s};try{const e=t.user.uid;yield hx(nA(yC,`${Vx}/${e}`),a)}catch(e){_c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"signUpWithEmail"}}})}finally{_c.log("User account created & signed in!"),o(!0)}})))).catch((e=>{let t=e.message;"auth/email-already-in-use"===e.code?t="That email address is already in use!":"auth/invalid-email"===e.code&&(t="That email address is invalid!"),_c.log({error:e}),a(new Error(t))}))}));const EC=(e,t)=>Mx(void 0,void 0,void 0,(function*(){try{return yield function(e,t,n){return Sd(Tu(e),ud.credential(t,n))}(gC,e,t),{success:!0}}catch(e){_c.log("### firebase auth signin:::"),_c.log({error:e});let t=e.message;return"auth/user-not-found"===e.code?(_c.log("That email address is already in use!"),t="There is no user record corresponding to this. Please sign up or use different email."):"auth/invalid-email"===e.code?(_c.log("That email address is invalid!"),t="That email address is invalid! Please use different email."):"auth/wrong-password"===e.code&&(_c.log("Wrong password"),t="Wrong Password!"),{success:!1,message:t}}})),IC=e=>Mx(void 0,void 0,void 0,(function*(){try{const t=new cf("recaptcha-container",{},gC),n=yield async function(e,t,n){const r=Xh(e),i=await lf(r,t,Tu(n));return new uf(i,(e=>Sd(r,e)))}(gC,e,t);return n}catch(e){return _c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"sendVerificationCodeToPhone"}}}),e}})),SC=()=>gC.currentUser,TC=()=>new Promise(((e,t)=>{chrome.identity.getAuthToken({interactive:!1},(n=>Mx(void 0,void 0,void 0,(function*(){chrome.runtime.lastError?(yield gC.signOut(),wC=0,Ic(),e(!0)):chrome.identity.clearAllCachedAuthTokens((()=>Mx(void 0,void 0,void 0,(function*(){Ic();try{yield fetch(`https://accounts.google.com/o/oauth2/revoke?token=${n}`),yield gC.signOut(),wC=0,e(!0)}catch(e){_c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"signOut"}}}),t(!0)}}))))}))))})),kC=e=>new Promise(((t,n)=>Mx(void 0,void 0,void 0,(function*(){var n,r;const i=null===(n=gC.currentUser)||void 0===n?void 0:n.uid,s=null===(r=gC.currentUser)||void 0===r?void 0:r.email;i||t({error:"Not signed in. Please sign in again.",url:null});const o=function(e,...t){var n,r,i;e=Tu(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||iA(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(iA(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,u,l;if(e instanceof Xk)u=Wk(e.firestore,sA),l=Rw(e._key.path),c={next:n=>{t[o]&&t[o](gx(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=Wk(e,Zk);u=Wk(n.firestore,sA),l=n._query;const r=new ux(u);c={next:e=>{t[o]&&t[o](new GA(u,r,n,e))},error:t[o+1],complete:t[o+2]},zA(e._query)}return function(e,t,n,r){const i=new Rk(r),s=new rk(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>XT(await Vk(e),s))),()=>{i.Tc(),e.asyncQueue.enqueueAndForget((async()=>ZT(await Vk(e),s)))}}(aA(u),l,a,c)}(yield px(tA(yC,`${Vx}/${i}/${Gx}`),{price:e,success_url:"https://evyai.com/payment_successful",cancel_url:"https://app.evyai.com/subscription-pricing",metadata:{email:s}}),(e=>{a(e)})),a=e=>{const n=e.data();(null==n?void 0:n.error)&&(t({error:null==n?void 0:n.error.message,url:null}),o()),(null==n?void 0:n.url)&&(t({error:null,url:null==n?void 0:n.url}),o())}})))),AC=e=>Mx(void 0,void 0,void 0,(function*(){try{const t=nA(yC,`${nC}/${e}`),n=yield cx(t);return Object.assign({id:n.id},n.data())}catch(e){if(LC.captureException(e,{captureContext:{extra:{functionName:"getSubscriptionPlanPaymentUrl"}}}),e)throw new Error(e)}})),xC=e=>Mx(void 0,void 0,void 0,(function*(){if(!e)return{error:"Not signed in. Please sign in again.",status:Pc.FREE,usagePercentage:0,hasTeamsPlan:!1,allowedTeamMembers:0,subscription:Vc,interval:qc,isAdmin:!1,userPersonalSubscription:Vc,subscriptionData:null,statusDB:null,userPersonalStatusDB:null};try{let t=null,n=null,r=null,i=Vc,s=qc,o=!1,a=!1,c=0,u=Vc,l=null;let h=(yield lx(KA(tA(yC,`${Vx}/${e}/${qx}`)))).docs;h.reverse();let d=null,f=Pc.FREE,p=0;if(h.length>0){let e=!1;for(const t of h){const n=t.data();if(n.status===Hc||n.status===Kc||n.status===Qc){e=!0,d=t;break}n.status,e=!1,d=t}e?(f=Pc.PRO,i=jc,u=jc):(r=d.data(),f=Pc.FREE,i=Vc,u=Vc,r.status===Wc?(t=Wc,n=Wc):(t=r.status,n=r.status))}if(f===Pc.PRO&&d){const e=d.data();r=e||null,t=e.status,n=e.status,l=e.current_period_end.toDate();new Date>l&&(t=Wc),s="month"===e.items[0].plan.interval?qc:zc;const u=e.items[0].plan.product,h=e.items[0].plan.id,f=e.items[0].quantity;o=!0,u!==Lc||h!==Uc&&h!==Fc&&h!==Bc?(i=jc,a=!1):(a=!0,i=$c),f>1&&(c=f-1)}const m=yield cx(nA(yC,`${Vx}/${e}`));if(m.exists()){const r=yield cx(nA(yC,`${Vx}/${e}/${jx}/${$x}`));let c=m.data(),{current_minute_stats:l,current_day_stats:h,current_hour_stats:d,current_month_stats:g,total_usage:y}=c,v=Px(c,["current_minute_stats","current_day_stats","current_hour_stats","current_month_stats","total_usage"]);r.exists()&&(v=Object.assign(Object.assign({},v),r.data())),f===Pc.FREE?(i=Vc,u=Vc,t=Hc,n=Hc,s=qc,o=!1,v[aC]&&v[aC][cC]&&(p=Math.min(100,Math.ceil(100*v[aC][cC]/Yc)))):(i=a?$c:jc,u=a?$c:jc,o=!!a,t===Kc?v[aC]&&v[aC][cC]&&(p=Math.min(100,Math.ceil(100*v[aC][cC]/Yc))):t===Hc||t===Qc?v[uC]&&v[uC][cC]&&(p=Math.min(100,Math.ceil(100*v[uC][cC]/Jc))):v[aC]&&v[aC][cC]&&(p=Math.min(100,Math.ceil(100*v[aC][cC]/Yc))))}return t!==Hc&&t!==Kc&&t!==Qc&&(f=Pc.FREE,i=Vc,s=qc,o=!1),n!==Hc&&n!==Kc&&n!==Qc&&(a=!1,c=0,u=Vc),{error:null,status:f,usagePercentage:p,hasTeamsPlan:a,allowedTeamMembers:c,subscription:i,interval:s,isAdmin:o,userPersonalSubscription:u,subscriptionData:r,statusDB:t,userPersonalStatusDB:n}}catch(e){return LC.captureException(e,{captureContext:{extra:{functionName:"fetchSubscriptionStatusByUserId"}}}),{error:e,status:Pc.FREE,usagePercentage:0,hasTeamsPlan:!1,allowedTeamMembers:0,subscription:Vc,interval:qc,isAdmin:!1,userPersonalSubscription:Vc,subscriptionData:null,statusDB:null,userPersonalStatusDB:null}}}));function CC(e){return Object.assign(Object.assign({},e),{id:e.id,data:e.data(),metadata:{hasPendingWrites:e.metadata.hasPendingWrites,fromCache:e.metadata.fromCache}})}function DC(e,t){return Mx(this,void 0,void 0,(function*(){const n=nA(yC,`${Jx}/${e}/${Jx}`,t.id);return yield cx(n)}))}function NC(e,t){return Mx(this,void 0,void 0,(function*(){const n=nA(yC,`${Yx}/${e}/${Yx}`,t.id);return yield cx(n)}))}const OC=Nn().filter((e=>!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(e.name))),RC=new class extends Xn{constructor(e){const t={parentSpanIsAlwaysRootSpan:!0,...e};!function(e,t,n=[t],r="npm"){const s=e._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${t}`,packages:n.map((e=>({name:`${r}:@sentry/${e}`,version:i}))),version:i}),e._metadata=s}(t,"browser",["browser"],Yt.SENTRY_SDK_SOURCE||"npm"),super(t),t.sendClientReports&&Yt.document&&Yt.document.addEventListener("visibilitychange",(()=>{"hidden"===Yt.document.visibilityState&&this._flushOutcomes()}))}eventFromException(e,t){return function(e,t,n,r){const i=_n(e,t,n&&n.syntheticException||void 0,r);return z(i),i.level="error",n&&n.event_id&&(i.event_id=n.event_id),_t(i)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",r,i){const s=wn(e,t,r&&r.syntheticException||void 0,i);return s.level=n,r&&r.event_id&&(s.event_id=r.event_id),_t(s)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(ft&&l.warn("SDK not enabled, will not capture user feedback."));const t=function(e,{metadata:t,tunnel:n,dsn:r}){const i={event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!r&&{dsn:Rn(r)}},s=function(e){return[{type:"user_report"},e]}(e);return Ln(i,[s])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}}({dsn:"https://71b2bbbce7e20708344ffad3414b4e3f@o4507822458339328.ingest.us.sentry.io/4507850001154048",transport:function(e,t=rr("fetch")){let n=0,r=0;return function(e,t,n=or(e.bufferSize||64)){let r={};return{send:function(i){const s=[];if(Fn(i,((t,n)=>{const i=Gn(n);if(ar(r,i)){const r=ur(t,n);e.recordDroppedEvent("ratelimit_backoff",i,r)}else s.push(t)})),0===s.length)return _t({});const o=Ln(i[0],s),a=t=>{Fn(o,((n,r)=>{const i=ur(n,r);e.recordDroppedEvent(t,Gn(r),i)}))};return n.add((()=>t({body:Vn(o)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&K&&l.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=cr(r,e),e)),(e=>{throw a("network_error"),e})))).then((e=>e),(e=>{if(e instanceof Hn)return K&&l.error("Skipped sending event because buffer is full."),a("queue_overflow"),_t({});throw e}))},flush:e=>n.drain(e)}}(e,(function(i){const s=i.body.length;n+=s,r++;const o={body:i.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};if(!t)return ir("fetch"),wt("No fetch implementation available");try{return t(e.url,o).then((e=>(n-=s,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(e){return ir("fetch"),n-=s,r--,wt(e)}}))},stackParser:gr,enabled:!0,integrations:[...OC,(MC={maskAllText:!0,blockAllMedia:!0},new yc(MC))],replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1,beforeSend(e){var n,r,i;try{if("undefined"!=typeof window)return((e,n={})=>{Xc(void 0,void 0,void 0,(function*(){try{return t().runtime.sendMessage({action:e,data:n})}catch(e){return _c.error("send message to extension pages error : ",e),LC.captureException(e,{captureContext:{extra:{functionName:"sendMessageToExtensionPages"}}}),null}}))})(Sc.BUBBLE_ERROR_TO_BACKGROUND_SENTRY,e),null}catch(e){_c.error(e)}return _c.log(e),(null===(n=e.exception)||void 0===n?void 0:n.values)&&e.exception.values[0]&&e.extra&&"functionName"in e.extra&&(e.exception.values[0].value=e.extra.functionName+" - "+e.exception.values[0].value),e.environment="MISSING_ENV_VAR".MODE||"production",e.extra=Object.assign(Object.assign({},e.extra),{email:null===(r=gC.currentUser)||void 0===r?void 0:r.email,userId:null===(i=gC.currentUser)||void 0===i?void 0:i.uid,extensionVersion:chrome.runtime.getManifest().version}),_c.log("Sending to sentry",e),e}});var MC;const PC=new de;PC.setClient(RC),_c.log("Sentry loaded"),RC.init();const LC=PC,UC={willOpenPopupAfterCompletingPageLoading:!1,tabIdInWhichPopupShouldOpen:0};var FC=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};const BC=()=>{t().tabs.create({url:"https://www.linkedin.com/"}).then((e=>{UC.tabIdInWhichPopupShouldOpen=e.id,UC.willOpenPopupAfterCompletingPageLoading=!0})).catch((e=>{_c.log("### Couldn't create a new tab"),_c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"openPageInNewTabToOpenPopup"}}})}))},VC=e=>FC(void 0,void 0,void 0,(function*(){_c.log("$$$$$$$$$$$$$$$$ handleWebSignout"),void 0===e||!0===e?t().tabs.create({url:"http://app.evyai.com/logout"}).then((e=>{_c.log("New tab opened:",e),nu(Sc.IS_LOGGED_OUT,{loggedOut:!0})})).catch((e=>{_c.error("Error opening new tab:",e),LC.captureException(e,{captureContext:{extra:{functionName:"handleWebSignout"}}})})):void 0===e&&!1!==e||nu(Sc.IS_LOGGED_OUT,{loggedOut:!0})}));var jC=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};var $C=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};t()[eu].onClicked.addListener((e=>FC(void 0,void 0,void 0,(function*(){let t=null,n=!1;try{e&&e.id&&("complete"===e.status?(n=!0,t=yield tu(e.id,Sc.GET_CURRENT_URL)):(n=!1,t=null))}catch(e){t=null,LC.captureException(e,{captureContext:{extra:{functionName:"toolBarIconClick-catch1"}}})}if(n)try{(null==e?void 0:e.id)&&(null==t?void 0:t.includes(".linkedin.com"))?n?yield tu(e.id,Sc.TOGGLE_POPUP):(UC.tabIdInWhichPopupShouldOpen=e.id,UC.willOpenPopupAfterCompletingPageLoading=!0):BC()}catch(e){BC(),_c.error(e),LC.captureException(e,{captureContext:{extra:{functionName:"toolbarIconClick-catch2"}}})}})))),t().runtime.onMessage.addListener(((e,t)=>$C(void 0,void 0,void 0,(function*(){var n,r,i,s,o,a,c,u,l,h,d,f,p,m,g,y,v,_;_c.log(e,null===(n=gC.currentUser)||void 0===n?void 0:n.uid);try{switch(e.action){case Sc.BUBBLE_ERROR_TO_BACKGROUND_SENTRY:console.log(e.data),LC.captureEvent(e.data,{captureContext:{extra:{functionName:"MESSAGE_ACTION.BUBBLE_ERROR_TO_BACKGROUND_SENTRY"}}});break;case Sc.HIDE_POPUP:(null===(r=t.tab)||void 0===r?void 0:r.id)&&tu(t.tab.id,Sc.HIDE_POPUP);break;case Sc.SHOW_POPUP:(null===(i=t.tab)||void 0===i?void 0:i.id)&&tu(t.tab.id,Sc.SHOW_POPUP);break;case Sc.EMAIL_SIGN_UP:{const{data:t}=e;return bC(t.email,t.password,null!==(s=t.firstName)&&void 0!==s?s:"",null!==(o=t.lastName)&&void 0!==o?o:"",null!==(a=t.phoneNumber)&&void 0!==a?a:"",null!==(c=t.linkedInAccount)&&void 0!==c?c:"")}case Sc.GET_USER_SUBSCRIPTION_DATA:return Mx(void 0,void 0,void 0,(function*(){try{const e=SC();if(!e)return;const t=tA(yC,Vx),n=KA(tA(t,e.uid,qx)),r=yield lx(n),i=[];return r.forEach((e=>{i.push(e.data())})),i[i.length-1]}catch(e){_c.error("Error fetching data:",e),LC.captureException(e,{captureContext:{extra:{functionName:"getUserSubscriptionData"}}})}}));case Sc.UPDATE_USER_DETAILS:{const{data:t}=e;return m=null!==(u=t.userId)&&void 0!==u?u:"",g=null!==(l=t.firstName)&&void 0!==l?l:"",y=null!==(h=t.lastName)&&void 0!==h?h:"",v=null!==(d=t.phoneNumber)&&void 0!==d?d:"",_=null!==(f=t.linkedInAccount)&&void 0!==f?f:"",Mx(void 0,void 0,void 0,(function*(){try{const e=nA(oA(),`${Vx}/${m}`),t={first_name:g,last_name:y,phone_number:v,linkedin_url:_};return yield dx(e,t),!0}catch(e){return _c.error("Error updating user profile:",e),LC.captureException(e,{captureContext:{extra:{functionName:"userProfileUpdate"}}}),!1}}))}case Sc.GET_SINGLE_COLLECTION_DATA:{const{data:t}=e;return((e,t)=>Mx(void 0,void 0,void 0,(function*(){try{const n=nA(yC,`${t}/${e}`),r=yield cx(n);return r.exists()?r.data():{}}catch(e){return LC.captureException(e,{captureContext:{extra:{functionName:"fetchSingleData"}}}),{}}})))(t.id,t.collection)}case Sc.SIGN_IN_WITH_GOOGLE:return new Promise(((e,t)=>{chrome.identity.getAuthToken({interactive:!0},(n=>{!chrome.runtime.lastError&&n||(_c.error(`SSO ended with an error: ${JSON.stringify(chrome.runtime.lastError)}`),t(new Error(`SSO ended with an error: ${JSON.stringify(chrome.runtime.lastError)}`))),Sd(gC,fd.credential(null,n)).then((t=>{e(t)})).catch((e=>{_c.error(`SSO ended with an error: ${e}`),LC.captureException(e,{captureContext:{extra:{functionName:"signInWithGoogle"}}}),t(new Error(`SSO ended with an error: ${e}`))}))}))}));case Sc.EMAIL_LOGIN:{const{data:t}=e;return EC(t.email,t.password)}case Sc.SIGN_OUT:{const{data:t}=e;console.log("@@@@@@@@@@@@@@@@ sign out request_recieves ");const n=yield TC();return void 0!==t.webSignOut||!1===t.webSignOut?VC(!1):void 0!==t.webSignOut&&!0!==t.webSignOut||VC(!0),n}case Sc.GET_USER_AUTH_STATE:return SC();case Sc.RELOAD_CURRENT_USER_AUTH_STATE:return Mx(void 0,void 0,void 0,(function*(){var e;return null===(e=gC.currentUser)||void 0===e?void 0:e.reload()}));case Sc.SEND_VERIFICATION_EMAIL:(e=>{const t=(new Date).getTime();t-wC>=6e4&&(wC=t,xd(e))})(SC());break;case Sc.SEND_PASSWORD_RESET_EMAIL:{const{data:{email:t}}=e;return(e=>new Promise(((t,n)=>{Ad(gC,e).then((()=>{t(!0)})).catch((e=>{let t=e.message;"auth/user-not-found"===e.code?(_c.log("That email address is already in use!"),t="There is no user record corresponding to this. Please sign up or use different email."):"auth/invalid-email"===e.code&&(t="That email address is invalid!"),_c.log({error:e}),n(new Error(t))}))})))(t)}case Sc.SEND_VERIFICATION_CODE_TO_PHONE:{const{data:{phoneNumber:t}}=e;return IC(t)}case Sc.GET_FIREBASE_AUTH_INSTANCE:return gC;case Sc.GET_SUGGESTED_COMMENTS:{const{data:t}=e;return(e=>FC(void 0,void 0,void 0,(function*(){const t=e.uid;delete e.uid;try{const n=gC.currentUser;if(!n)return{success:!1,message:"current user error, user is not authenticated, please re-login to proceed"};const r=yield n.getIdToken();if(!r)return{success:!1,message:"Failed to generate auth token, please re-login any try again"};const i=yield fetch(Rc,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json; charset=utf-8",pragma:"no-cache","cache-control":"no-cache",authorization:`Bearer ${null==r?void 0:r.trim()}`},cache:"no-cache",redirect:"follow",body:JSON.stringify({data:e,userId:t,extension_version:chrome.runtime.getManifest().version})});return i.status>=200&&i.status<=204?yield i.json():{success:!1,message:"Some error occurred. Please try again later."}}catch(e){return _c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"fetchSuggestedComments"}}}),{success:!1,error:e,message:"Some error occurred. Please try again later."}}})))(t)}case Sc.GET_RECENT_ACTIVITIES:{const{data:{willStartAgain:t}}=e;return((e=3,t=!0)=>Mx(void 0,void 0,void 0,(function*(){var n;const r=null===(n=gC.currentUser)||void 0===n?void 0:n.uid;if(!r)return[];try{let n=null;t||!vC?(vC=null,n=KA(tA(yC,`${Lx}/${r}/${Ux}`),JA(rC,"desc"),ZA(e))):n=KA(tA(yC,`${Lx}/${r}/${Ux}`),JA(rC,"desc"),tx(vC),ZA(e));const i=yield lx(n);return i.docs.length>0&&(vC=i.docs[i.docs.length-1]),i.docs.map((e=>Object.assign({id:e.id},e.data())))}catch(e){return _c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"getRecentActivities"}}}),[]}})))(e.data.numberOfItemsToFetch?e.data.numberOfItemsToFetch:3,t)}case Sc.GET_SAVED_COMMANDS:{const{data:{willStartAgain:t,numberOfItemsToFetch:n}}=e;return((e=3,t=!0)=>Mx(void 0,void 0,void 0,(function*(){var n;const r=null===(n=gC.currentUser)||void 0===n?void 0:n.uid;if(!r)return[];try{let n=null;t||!_C?(_C=null,n=KA(tA(yC,`${Lx}/${r}/${Fx}`),JA(rC,"desc"),ZA(e))):n=KA(tA(yC,`${Lx}/${r}/${Fx}`),JA(rC,"desc"),tx(_C),ZA(e));const i=yield lx(n);return i.docs.length>0&&(_C=i.docs[i.docs.length-1]),i.docs.map((e=>Object.assign({id:e.id},e.data())))}catch(e){return _c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"getSavedCommands"}}}),[]}})))(n,t)}case Sc.SAVE_COMMAND:{const{data:{activityData:t,activityType:n,generatedText:r,id:i}}=e;return((e,t,n,r)=>Mx(void 0,void 0,void 0,(function*(){var i;try{const s={[rC]:yx(),[iC]:e,[sC]:n,[oC]:t},o=null===(i=gC.currentUser)||void 0===i?void 0:i.uid;return o?(yield hx(nA(yC,`${Lx}/${o}/${Fx}/${r}`),s),{docId:r,error:null}):{docId:"",error:"UsreId not found"}}catch(e){return _c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"addCommandData"}}}),{docId:"",error:e}}})))(t,n,r,i)}case Sc.IS_COMMAND_SAVED:{const{data:{summaryId:t}}=e;return(e=>Mx(void 0,void 0,void 0,(function*(){var t;const n=null===(t=gC.currentUser)||void 0===t?void 0:t.uid;if(!n)return!1;const r=nA(yC,`${Lx}/${n}/${Fx}/${e}`);return(yield cx(r)).exists()})))(t)}case Sc.REMOVE_SAVED_COMMAND:{const{data:{documentId:t}}=e;return(e=>Mx(void 0,void 0,void 0,(function*(){var t;try{const n=null===(t=gC.currentUser)||void 0===t?void 0:t.uid;return n?(yield fx(nA(yC,`${Lx}/${n}/${Fx}`,e)),{docId:e,error:null}):{docId:"",error:"UsreId not found"}}catch(e){return _c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"deleteCommandData"}}}),{docId:"",error:e}}})))(t)}case Sc.GET_SUBSCRIPTION_PLANS:return Mx(void 0,void 0,void 0,(function*(){var e;if(!(null===(e=gC.currentUser)||void 0===e?void 0:e.uid))return[];try{const e=yield lx(KA(tA(yC,`${Bx}`),QA("active","==",!0)));if(e.docs.length>0){const t=e.docs.at(0),n=null==t?void 0:t.id;return(yield lx(tA(yC,`${Bx}/${n}/prices`))).docs.map((e=>Object.assign({id:e.id},e.data())))}return[]}catch(e){return _c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"getSubscriptionPlans"}}}),[]}}));case Sc.GET_SUBSCRIPTION_PAYMENT_URL:{const{data:{priceId:t}}=e;return kC(t)}case Sc.OPEN_NEW_TAB:{const{data:{url:t}}=e;chrome.tabs.create({url:t});break}case Sc.GET_SUBSCRIPTION_STATUS:return Mx(void 0,void 0,void 0,(function*(){var e;const t=null===(e=gC.currentUser)||void 0===e?void 0:e.uid;if(!t)return{error:"Not signed in. Please sign in again.",status:Pc.FREE,usagePercentage:0,hasTeamsPlan:!1,allowedTeamMembers:0,subscription:Vc,interval:qc,isAdmin:!1,userPersonalSubscription:Vc,subscriptionData:null,statusDB:null,userPersonalStatusDB:null};try{let e=null,n=null,r=null,i=Vc,s=qc,o=!1,a=!1,c=0,u=[],l=[],h=!1,d=Vc,f=null,p=(yield lx(KA(tA(yC,`${Vx}/${t}/${qx}`)))).docs;p.reverse();let m=null,g=Pc.FREE,y=0;if(p.length>0){let t=!1;for(const e of p){const n=e.data();if(n.status===Hc||n.status===Kc||n.status===Qc){t=!0,m=e;break}n.status,t=!1,m=e}t?(g=Pc.PRO,i=jc,d=jc):(r=m.data(),g=Pc.FREE,i=Vc,d=Vc,r.status===Wc?(e=Wc,n=Wc):(e=r.status,n=r.status))}if(g===Pc.PRO&&m){const t=m.data();r=t||null,e=t.status,n=t.status,f=t.current_period_end.toDate(),new Date>f&&(e=Wc),s="month"===t.items[0].plan.interval?qc:zc;const u=t.items[0].plan.product,l=t.items[0].plan.id,h=t.items[0].quantity;o=!0,u!==Lc||l!==Uc&&l!==Fc&&l!==Bc?(i=jc,d=jc,a=!1):(a=!0,i=$c,d=$c),h>1&&(c=h-1)}const v=yield cx(nA(yC,`${Vx}/${t}`));if(v.exists()){const r=yield cx(nA(yC,`${Vx}/${t}/${jx}/${$x}`));let a=v.data(),{current_minute_stats:c,current_day_stats:f,current_hour_stats:p,current_month_stats:m,total_usage:_}=a,w=Px(a,["current_minute_stats","current_day_stats","current_hour_stats","current_month_stats","total_usage"]);if(r.exists()&&(w=Object.assign(Object.assign({},w),r.data())),g===Pc.PRO)if(e===Kc){if(w[aC]&&w[aC][cC]&&(y=Math.min(100,Math.ceil(100*w[aC][cC]/Yc))),w&&w.memberInTeams&&w.memberInTeams.length>0){const e=w.memberInTeams.map((e=>Mx(void 0,void 0,void 0,(function*(){const t=yield AC(e),n=yield xC(t.adminId);s=n.interval,u.push(t),l.push(n),_c.log("admin sub status")}))));yield Promise.all(e)}h=l.some((e=>!(!e.hasTeamsPlan||e.userPersonalStatusDB!==Hc||e.status!==Pc.PRO||(e.interval&&(s=e.interval),0)))),h&&(e=Hc)}else if(e===Hc||e===Qc)w[uC]&&w[uC][cC]&&(y=Math.min(100,Math.ceil(100*w[uC][cC]/Jc)));else if(e===Wc){if(w[aC]&&w[aC][cC]&&(y=Math.min(100,Math.ceil(100*w[aC][cC]/Yc))),w&&w.memberInTeams&&w.memberInTeams.length>0){const e=w.memberInTeams.map((e=>Mx(void 0,void 0,void 0,(function*(){const t=yield AC(e),n=yield xC(t.adminId);s=n.interval,u.push(t),l.push(n)}))));yield Promise.all(e)}h=l.some((e=>e.userPersonalStatusDB&&e.userPersonalStatusDB===Hc)),h&&(e=Hc)}else{if(w[aC]&&w[aC][cC]&&(y=Math.min(100,Math.ceil(100*w[aC][cC]/Yc))),w&&w.memberInTeams&&w.memberInTeams.length>0){const e=w.memberInTeams.map((e=>Mx(void 0,void 0,void 0,(function*(){const t=yield AC(e),n=yield xC(t.adminId);s=n.interval,u.push(t),l.push(n)}))));yield Promise.all(e)}h=l.some((e=>e.userPersonalStatusDB&&e.userPersonalStatusDB===Hc)),h&&(e=Hc)}else{if(d=Vc,w&&w.memberInTeams&&w.memberInTeams.length>0){const e=w.memberInTeams.map((e=>Mx(void 0,void 0,void 0,(function*(){const t=yield AC(e),n=yield xC(t.adminId);s=n.interval,u.push(t),l.push(n)}))));yield Promise.all(e)}h=l.some((e=>!(!e.hasTeamsPlan||e.userPersonalStatusDB!==Hc||e.status!==Pc.PRO||(e.interval&&(s=e.interval),0))));const t=l.some((e=>!(!e.hasTeamsPlan||e.userPersonalStatusDB!==Kc||e.status!==Pc.PRO||(e.interval&&(s=e.interval),0))));h?(g=Pc.PRO,i=Gc,e=Hc,n=Hc,o=!1,w[uC]&&w[uC][cC]&&(y=Math.min(100,Math.ceil(100*w[uC][cC]/Jc)))):!h&&t?(w[aC]&&w[aC][cC]&&(y=Math.min(100,Math.ceil(100*w[aC][cC]/Yc))),y>=100?(g=Pc.PRO,i=Gc,o=!1,e=Kc):(g=Pc.FREE,i=Vc,s=qc,o=!1)):(g=Pc.FREE,i=Vc,s=qc,o=!1,w[aC]&&w[aC][cC]&&(y=Math.min(100,Math.ceil(100*w[aC][cC]/Yc))))}}return e!==Hc&&e!==Kc&&e!==Qc&&(g=Pc.FREE,i=Vc,s=qc,o=!1),n!==Hc&&n!==Kc&&n!==Qc&&(a=!1,c=0,d=Vc),{error:null,status:g,usagePercentage:y,hasTeamsPlan:a,allowedTeamMembers:c,subscription:i,interval:s,isAdmin:o,userPersonalSubscription:d,subscriptionData:r,statusDB:e,userPersonalStatusDB:n}}catch(e){return _c.log("ERROR",e),LC.captureException(e,{captureContext:{extra:{functionName:"getSubscriptionStatus"}}}),{error:e,status:Pc.FREE,usagePercentage:0,hasTeamsPlan:!1,allowedTeamMembers:0,subscription:Vc,interval:qc,isAdmin:!1,userPersonalSubscription:Vc,subscriptionData:null,statusDB:null,userPersonalStatusDB:null}}}));case Sc.GET_MANAGE_SUBSCRIPTION_LINK:return Mx(void 0,void 0,void 0,(function*(){var e;try{const t=Rx(Ox(mC),"ext-firestore-stripe-payments-createPortalLink");return{error:null,url:(yield t({returnUrl:"https://evyai.com/",locale:"auto",token:yield null===(e=gC.currentUser)||void 0===e?void 0:e.getIdToken(),extension_version:chrome.runtime.getManifest().version})).data.url}}catch(e){return _c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"getCustomerSubscriptionPortalLink"}}}),{error:e,url:null}}}));case Sc.ADD_REVIEW:{const{data:{reviewText:t,rating:n}}=e;return((e,t)=>Mx(void 0,void 0,void 0,(function*(){try{const n=yield SC();if(!n)throw new Error("User not found!");const r=yield cx(nA(yC,`${Vx}/${n.uid}`));if(r.exists()){const i=r.data(),s=tA(yC,zx);yield px(s,{userId:n.uid,email:n.email,timeStamp:yx(),reviewText:e,rating:t,userName:(null==i?void 0:i.first_name)+" "+(null==i?void 0:i.last_name)||""})}return{isSuccess:!0}}catch(e){_c.error("Error while adding data:",e)}})))(t,n)}case Sc.ADD_QUESTIONS:{const{data:{question:t}}=e;return(e=>Mx(void 0,void 0,void 0,(function*(){try{const t=yield SC();if(!t)throw new Error("User not found!");const n=yield cx(nA(yC,`${Vx}/${t.uid}`));if(n.exists()){const r=n.data(),i=tA(yC,`${Hx}/${t.uid}/${Kx}`);yield px(i,{question:e,timestamp:yx(),email:t.email,userName:(null==r?void 0:r.first_name)+" "+(null==r?void 0:r.last_name)||""})}}catch(e){throw _c.log(e,"err!"),LC.captureException(e,{captureContext:{extra:{functionName:"addQuestionOrIssues"}}}),new Error(e)}})))(t)}case Sc.ADD_LINKEDIN_PROFILE:{const{data:t}=e;return(({userId:e,profileUrl:t,linkedInProfileName:n,profileHeadline:r,profilePictureUrl:i,profileUrlSN:s,raw_full_profile_info_data:o,raw_profile_contact_info_data:a,isProUser:c,status:u})=>Mx(void 0,void 0,void 0,(function*(){var l;try{const h=Rx(Ox(mC),"saveLinkedInProfileInDatabasev2"),d=yield h({userId:e,profileUrl:t,linkedInProfileName:n,profileHeadline:r,profilePictureUrl:i,profileUrlSN:s,raw_full_profile_info_data:o,raw_profile_contact_info_data:a,isProUser:c,status:u,token:yield null===(l=gC.currentUser)||void 0===l?void 0:l.getIdToken(),extension_version:chrome.runtime.getManifest().version});return _c.error({response:d},"addLinkedinProfile"),d}catch(e){return _c.log({error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"addLinkedInProfile"}}}),e}})))(t)}case Sc.IS_PROFILE_SAVED:{const{data:{uid:t,targetProfileUrl:n}}=e;return function(e,t){return Mx(this,void 0,void 0,(function*(){try{const n=KA(tA(yC,`saved_linkedin_profiles/${e}/profiles`),QA("profileUrl","==",t)),r=yield lx(n);if(r.empty)return null;{const e=r.docs[0];return Object.assign({id:e.id},e.data())}}catch(e){throw _c.error("Error checking if profile exists:",e),LC.captureException(e,{captureContext:{extra:{functionName:"checkIfProfileExists"}}}),e}}))}(t,n)}case Sc.GET_PERSPONA:{const{data:{user:t,previousLastDoc:n,page:r,existingPersonas:i,isLoading:s}}=e;return((e,t,n,r,i)=>Mx(void 0,void 0,void 0,(function*(){var s;let o;if(e){if(o=e.uid,!o)return[]}else if(o=null===(s=gC.currentUser)||void 0===s?void 0:s.uid,!o)return[];try{if(i)return{data:[],lastDoc:null,hasMoreDocs:!0};const e=xc;let s=null;t&&(s=yield NC(o,t));const a=KA(tA(yC,`${Yx}/${o}/${Yx}`),JA(lC,Ac.ASCENDING),JA(fC,Ac.ASCENDING),...n>1&&s?[tx(s)]:[],ZA(e+1)),c=(yield lx(a)).docs,u=c.length>e,l=CC(u?c[e-1]:c[c.length-1]),h=new Set,d=[];return n>1&&r.forEach((e=>{h.add(e.id)})),c.slice(0,u?e:c.length).map((e=>{h.has(e.id)||(h.add(e.id),d.push(Object.assign({id:e.id},e.data())))})),{data:d,lastDoc:l,hasMoreDocs:u}}catch(e){return _c.log("error while fetching personas",e),LC.captureException(e,{captureContext:{extra:{functionName:"getPersonas"}}}),{data:[],lastDoc:null,hasMoreDocs:!1}}})))(t,n,r,i,s)}case Sc.GET_SINGLE_PERSONA:{const{data:{user:t,personaId:n}}=e;return((e,t)=>Mx(void 0,void 0,void 0,(function*(){var n;let r;if(e){if(r=e.uid,!r)return null}else if(r=null===(n=gC.currentUser)||void 0===n?void 0:n.uid,!r)return null;try{const e=nA(tA(yC,`${Yx}/${r}/${Yx}`),t),n=yield cx(e);if(n.exists()){const e=n.id;return Object.assign({id:e},n.data())}return null}catch(e){return _c.log("error while fetching personas",e),LC.captureException(e,{captureContext:{extra:{functionName:"getSinglePersona"}}}),null}})))(t,n)}case Sc.SEARCH_PERSONA:{const{data:{user:t,previousLastDoc:n,page:r,search:i,isLoading:s,existingPersonas:o}}=e;return((e,t,n,r,i)=>Mx(void 0,void 0,void 0,(function*(){var s;let o;if(e){if(o=e.uid,!o)return[]}else if(o=null===(s=gC.currentUser)||void 0===s?void 0:s.uid,!o)return[];try{const e=1===n?Dc+1:Dc,s=r;let a=null;t&&(a=yield NC(o,t));let c=KA(tA(yC,`${Yx}/${o}/${Yx}`),QA(lC,">=",s),QA(lC,"<=",s+""),JA(lC,Ac.ASCENDING),JA(fC,Ac.ASCENDING),...n>1&&a?[tx(a)]:[],ZA(e+1));const u=(yield lx(c)).docs,l=u.length>e,h=l?u[e-1]:u[u.length-1],d=h?CC(h):null,f=new Set,p=[];return n>1&&i.forEach((e=>{f.add(e.id)})),u.slice(0,l?e:u.length).map((e=>{f.has(e.id)||(f.add(e.id),p.push(Object.assign({id:e.id},e.data())))})),{data:p,lastDoc:d,hasMoreDocs:l}}catch(e){return _c.log("error while searching personas",e),LC.captureException(e,{captureContext:{extra:{functionName:"searchPersonas"}}}),{data:[],lastDoc:null,hasMoreDocs:!1}}})))(t,n,r,i,o)}case Sc.GET_TEMPLATES:{const{data:{user:t,previousLastDoc:n,page:r,existingTemplates:i,isLoading:s}}=e;return((e,t,n,r,i)=>Mx(void 0,void 0,void 0,(function*(){var s;let o;if(e){if(o=e.uid,!o)return[]}else if(o=null===(s=gC.currentUser)||void 0===s?void 0:s.uid,!o)return[];try{if(i)return{data:[],lastDoc:null,hasMoreDocs:!0};const e=Cc;let s=null;t&&(s=yield DC(o,t));const a=KA(tA(yC,`${Jx}/${o}/${Jx}`),JA(rC,Ac.DESCENDING),JA(fC,Ac.DESCENDING),...n>1&&s?[tx(s)]:[],ZA(e+1)),c=(yield lx(a)).docs,u=c.length>e,l=CC(u?c[e-1]:c[c.length-1]),h=new Set,d=[];return n>1&&r.forEach((e=>{h.add(e.id)})),c.slice(0,u?e:c.length).map((e=>{h.has(e.id)||(h.add(e.id),d.push(Object.assign({id:e.id},e.data())))})),{data:d,lastDoc:l,hasMoreDocs:u}}catch(e){return _c.log("error while fetching templates",e),LC.captureException(e,{captureContext:{extra:{functionName:"getTemplates"}}}),{data:[],lastDoc:null,hasMoreDocs:!1}}})))(t,n,r,i,s)}case Sc.SEARCH_TEMPLATES:{const{data:{user:t,previousLastDocs:n,page:r,search:i,isLoading:s,existingTemplates:o}}=e;return((e,t,n,r,i)=>Mx(void 0,void 0,void 0,(function*(){var s;let o;if(e){if(o=e.uid,!o)return[]}else if(o=null===(s=gC.currentUser)||void 0===s?void 0:s.uid,!o)return[];try{const e=Nc,s=r;let a=null,c=null;t.lastNameDoc&&(a=yield DC(o,t.lastNameDoc)),t.lastContentDoc&&(c=yield DC(o,t.lastContentDoc));let u=KA(tA(yC,`${Jx}/${o}/${Jx}`),QA(hC,">=",s),QA(hC,"<=",s+""),JA(hC,Ac.ASCENDING),JA(fC,Ac.ASCENDING),...n>1&&a?[tx(a)]:[],ZA(e+1)),l=KA(tA(yC,`${Jx}/${o}/${Jx}`),QA(dC,">=",s),QA(dC,"<=",s+""),JA(dC,Ac.ASCENDING),JA(fC,Ac.ASCENDING),...n>1&&c?[tx(c)]:[],ZA(e+1));const h=yield lx(u),d=yield lx(l),f=h.docs,p=d.docs,m=f.length>e,g=p.length>e,y=m?f[e-1]:f[f.length-1],v=g?p[e-1]:p[p.length-1],_=y?CC(y):null,w=v?CC(v):null,b=new Set,E=[];return n>1&&i.forEach((e=>{b.add(e.id),E.push(e)})),f.slice(0,m?e:f.length).map((e=>{const t=e.data(),n=e.id;b.has(n)||(b.add(n),E.push(Object.assign(Object.assign({},t),{id:n})))})),p.slice(0,g?e:p.length).map((e=>{const t=e.data(),n=e.id;b.has(n)||(b.add(n),E.push(Object.assign(Object.assign({},t),{id:n})))})),{data:E,lastDocs:{lastNameDoc:_,lastContentDoc:w},hasMoreDocs:{hasMoreNameDocs:m,hasMoreContentDocs:g}}}catch(e){return _c.log("error while searching templates",e),LC.captureException(e,{captureContext:{extra:{functionName:"searchTemplates"}}}),{data:[],lastDocs:{lastNameDoc:null,lastContentDoc:null},hasMoreDocs:{hasMoreNameDocs:!1,hasMoreContentDocs:!1}}}})))(t,n,r,i,o)}case Sc.GET_BANNER_DETAILS:return Mx(void 0,void 0,void 0,(function*(){try{const e=nA(oA(),Zx,tC),t=yield cx(e);if(t.exists()&&t.data().content){const e=t.data().content.sort(((e,t)=>e.position-t.position));return e}return[]}catch(e){return _c.log("Error:",e),LC.captureException(e,{captureContext:{extra:{functionName:"getBannerDetails"}}}),[]}}));case Sc.GET_WEB_APP_AUTH_DETAILS:{const{data:{customToken:t}}=e;return function(e){return Mx(this,void 0,void 0,(function*(){try{yield Td(gC,e)}catch(e){_c.error("Error during sign-in:",e),LC.captureException(e,{captureContext:{extra:{functionName:"signInUserWithCustomToken"}}})}}))}(t)}case Sc.GET_WEB_APP_AUTH_SIGN_OUT:return nu(Sc.IS_LOGGED_OUT,{loggedOut:!0}),TC();case Sc.GET_LISTS:return function(){return Mx(this,void 0,void 0,(function*(){try{const e=SC();if(e){const t=KA(tA(yC,`/${Wx}/${e.uid}/${Xx}`),JA("modifiedDate","desc"));return(yield lx(t)).docs.map((e=>Object.assign(Object.assign({},e.data()),{id:e.id})))}}catch(e){_c.log("Error:",e)}}))}();case Sc.DELETE_LINKDIN_SAVE_PROFILE:return function(e){return Mx(this,void 0,void 0,(function*(){try{const t=SC();if(t){const n=KA(tA(yC,`/${Wx}/${t.uid}/${Qx}`),QA("profileUrl","==",e)),r=yield lx(n);if(!r.empty){const e=r.docs[0].id;yield fx(nA(yC,`/${Wx}/${t.uid}/${Qx}`,e)).then((e=>{}))}}}catch(e){throw _c.log(e,"error"),LC.captureException(e,{captureContext:{extra:{functionName:"deleteLinkedInProfile"}}}),e}}))}(e.data.profileUrl);case Sc.GET_SAVE_PROFILE_LISTS:return function(e){return Mx(this,void 0,void 0,(function*(){try{const t=SC();if(t){const n=KA(tA(yC,`/${Wx}/${t.uid}/${Qx}`),QA("profileUrl","==",e)),r=yield lx(n);return r.empty?[]:r.docs[0].data().lists||[]}}catch(e){return _c.log("Error:",e),LC.captureException(e,{captureContext:{extra:{functionName:"getProfileListsByUrl"}}}),[]}}))}(e.data.profileUrl);case Sc.UPDATE_PROFILE_LISTS:{const t=e.data.listId;return function(e,t){return Mx(this,void 0,void 0,(function*(){try{const n=SC();if(n){const r=KA(tA(yC,`/${Wx}/${n.uid}/${Qx}`),QA("profileUrl","==",t)),i=yield lx(r);if(!i.empty){const t=i.docs[0].data(),r=i.docs[0].id;let s=t.lists||[];s.includes(e)?s=s.filter((t=>t!==e)):s.push(e);const o=nA(yC,`/${Wx}/${n.uid}/${Qx}`,r);yield dx(o,{lists:s})}}}catch(e){_c.log("Error:",e),LC.captureException(e,{captureContext:{extra:{functionName:"updateProfileToLists"}}})}}))}(t,e.data.profileUrl)}case Sc.PROFILE_SUMMARY:return p=e.data,Mx(void 0,void 0,void 0,(function*(){var e;try{const t=Rx(Ox(mC),pC);return(yield t(Object.assign(Object.assign({},p),{token:yield null===(e=gC.currentUser)||void 0===e?void 0:e.getIdToken(),extension_version:chrome.runtime.getManifest().version}))).data}catch(e){return _c.error({error:e},"getProfileSummary"),LC.captureException(e,{captureContext:{extra:{functionName:"getProfileSummary"}}}),null}}));case Sc.EXISTING_PROFILE_SUMMARY:return(e=>Mx(void 0,void 0,void 0,(function*(){try{const t=SC();if(!t)throw new Error("User not found!");const n=nA(yC,`${Lx}/${t.uid}/${Ux}`,e.summaryId),r=yield cx(n);return r.exists()?{data:r.data()}:null}catch(e){return _c.error("Error getting document:",e),LC.captureException(e,{captureContext:{extra:{functionName:"getExistingProfileSummary"}}}),e}})))(e.data);case Sc.UPDATE_PROFILE_SUMMARY_ID:return function(e){return Mx(this,void 0,void 0,(function*(){try{const t=SC();if(!t)throw new Error("User not found!");const n=nA(yC,`/${Wx}/${t.uid}/${Qx}`,e.profileId);return yield dx(n,{summaryId:e.summaryId}),!0}catch(e){return _c.error("Error updating profile:",e),LC.captureException(e,{captureContext:{extra:{functionName:"updateProfileSummaryId"}}}),!1}}))}(e.data);case Sc.OLDER_VERSION_CHECK:return Mx(void 0,void 0,void 0,(function*(){const e=nA(oA(),Zx,eC),t=yield cx(e);return!(!t.exists()||!t.data())&&t.data().enable_update_banner}));case Sc.IS_LOGGED_OUT:{const{data:t}=e;return localStorage.setItem("loggedIn",String(t.loggedOut)),t.loggedOut}case Sc.HANDLE_BUTTON_INSERTION_EXCEPTION:{const{data:t}=e;return(e=>Mx(void 0,void 0,void 0,(function*(){var t;try{const n=Rx(Ox(mC),"handleButtonInsertionException");yield n(Object.assign(Object.assign({},e),{token:yield null===(t=gC.currentUser)||void 0===t?void 0:t.getIdToken(),extension_version:chrome.runtime.getManifest().version}))}catch(e){_c.log("button insertion exception callable function error",{error:e}),LC.captureException(e,{captureContext:{extra:{functionName:"handleButtonInsertionException"}}})}})))(t)}}}catch(e){console.error(e),LC.captureException(e,{captureContext:{extra:{functionName:"MESSAGE_ACTION.HANDLE_BUTTON_INSERTION_EXCEPTION"}}})}return!0})))),t().tabs.onUpdated.addListener(((e,t,n)=>jC(void 0,void 0,void 0,(function*(){if("complete"===t.status&&n.url&&UC.willOpenPopupAfterCompletingPageLoading&&e===UC.tabIdInWhichPopupShouldOpen){UC.willOpenPopupAfterCompletingPageLoading=!1,UC.tabIdInWhichPopupShouldOpen=0;try{tu(e,Sc.SHOW_POPUP)}catch(e){LC.captureException(e,{captureContext:{extra:{functionName:"tabUpdateHandler"}}})}}})))),t().runtime.onInstalled.addListener((e=>{if(_c.log("installed"),"install"===e.reason){const e="http://app.evyai.com/welcome?source=installation";t().tabs.create({url:e}).then((e=>{_c.log("New tab opened:",e)})).catch((e=>{_c.error("Error opening new tab:",e),LC.captureException(e,{captureContext:{extra:{functionName:"onInstalled"}}})})),t().tabs.query({url:"https://www.linkedin.com/*"}).then((e=>{for(let n of e)void 0!==n.id&&t().scripting.executeScript({target:{tabId:n.id},files:["js/contentScript.bundle.js","js/options.bundle.js","js/popup.bundle.js"]})}))}})),gC.onAuthStateChanged((e=>FC(void 0,void 0,void 0,(function*(){var t;e||(yield(t=Mc,wc(void 0,void 0,void 0,(function*(){try{return yield bc.remove(t),!0}catch(e){return _c.error(`Failed to remove ${t}: ${e}`),LC.captureException(e,{captureContext:{extra:{functionName:"removeItem"}}}),!1}})))),nu(Sc.USER_AUTH_STATE_CHANGED,{user:e})}))))})()})();